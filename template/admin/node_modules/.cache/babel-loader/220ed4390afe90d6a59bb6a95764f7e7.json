{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/babel-loader/lib/index.js!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/components/uploadVideo/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/components/uploadVideo/index.vue","mtime":1689324015172},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/babel.config.js","mtime":1689324015052},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/.babelrc","mtime":1689324015050},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCgppbXBvcnQgeyB1cGxvYWRCeVBpZWNlcyB9IGZyb20gJ0AvdXRpbHMvdXBsb2FkJzsgLy/lvJXlhaV1cGxvYWRCeVBpZWNlc+aWueazlQppbXBvcnQgeyBwcm9kdWN0R2V0VGVtcEtleXNBcGksIHVwbG9hZFR5cGUgYXMgX3VwbG9hZFR5cGUgfSBmcm9tICdAL2FwaS9wcm9kdWN0JzsKaW1wb3J0IFNldHRpbmcgZnJvbSAnQC9zZXR0aW5nJzsKaW1wb3J0IHsgZ2V0Q29va2llcyB9IGZyb20gJ0AvbGlicy91dGlsJzsKCi8vIGltcG9ydCAnLi4vLi4vLi4vcHVibGljL1VFZGl0b3IvZGlhbG9ncy9pbnRlcm5hbCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAndmlkZTExbycsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZpbGVVcmw6IFNldHRpbmcuYXBpQmFzZVVSTCArICcvZmlsZS91cGxvYWQnLAogICAgICB1cGxvYWQ6IHsKICAgICAgICB2aWRlb0luZzogZmFsc2UgLy8g5piv5ZCm5pi+56S66L+b5bqm5p2h77ybCiAgICAgIH0sCgogICAgICBwcm9ncmVzczogMCwKICAgICAgLy8g6L+b5bqm5p2h6buY6K6kMAogICAgICB2aWRlb0xpbms6ICcnLAogICAgICBmb3JtVmFsaWRhdGU6IHsKICAgICAgICB2aWRlb19saW5rOiAnJwogICAgICB9LAogICAgICB1cGxvYWRfdHlwZTogJycsCiAgICAgIHVwbG9hZERhdGE6IHt9LAogICAgICBoZWFkZXI6IHt9CiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMudXBsb2FkVHlwZSgpOwogICAgdGhpcy5nZXRUb2tlbigpOwogIH0sCiAgbWV0aG9kczogewogICAgLy8g5Yig6Zmk6KeG6aKR77ybCiAgICBkZWxWaWRlbzogZnVuY3Rpb24gZGVsVmlkZW8oKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgdGhhdC4kc2V0KHRoYXQuZm9ybVZhbGlkYXRlLCAndmlkZW9fbGluaycsICcnKTsKICAgIH0sCiAgICAvL+iOt+WPluinhumikeS4iuS8oOexu+WeiwogICAgdXBsb2FkVHlwZTogZnVuY3Rpb24gdXBsb2FkVHlwZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgX3VwbG9hZFR5cGUoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpcy51cGxvYWRfdHlwZSA9IHJlcy5kYXRhLnVwbG9hZF90eXBlOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDkuIrkvKDmiJDlip8KICAgIGhhbmRsZVN1Y2Nlc3M6IGZ1bmN0aW9uIGhhbmRsZVN1Y2Nlc3MocmVzLCBmaWxlLCBmaWxlTGlzdCkgewogICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUudmlkZW9fbGluayA9IHJlcy5kYXRhLnNyYzsKICAgICAgICB0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MocmVzLm1zZyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgfQogICAgfSwKICAgIHZpZGVvU2F2ZVRvVXJsOiBmdW5jdGlvbiB2aWRlb1NhdmVUb1VybChmaWxlKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB1cGxvYWRCeVBpZWNlcyh7CiAgICAgICAgZmlsZTogZmlsZSwKICAgICAgICAvLyDop4bpopHlrp7kvZMKICAgICAgICBwaWVjZVNpemU6IDMsCiAgICAgICAgLy8g5YiG54mH5aSn5bCPCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcyhkYXRhKSB7CiAgICAgICAgICBfdGhpczIuZm9ybVZhbGlkYXRlLnZpZGVvX2xpbmsgPSBkYXRhLmZpbGVfcGF0aDsKICAgICAgICAgIF90aGlzMi5wcm9ncmVzcyA9IDEwMDsKICAgICAgICB9LAogICAgICAgIGVycm9yOiBmdW5jdGlvbiBlcnJvcihlKSB7CiAgICAgICAgICBfdGhpczIuJE1lc3NhZ2UuZXJyb3IoZS5tc2cpOwogICAgICAgIH0sCiAgICAgICAgdXBsb2FkaW5nOiBmdW5jdGlvbiB1cGxvYWRpbmcoY2h1bmssIGFsbENodW5rKSB7CiAgICAgICAgICBfdGhpczIudmlkZW9JbmcgPSB0cnVlOwogICAgICAgICAgdmFyIHN0ID0gTWF0aC5mbG9vcihjaHVuayAvIGFsbENodW5rICogMTAwKTsKICAgICAgICAgIF90aGlzMi5wcm9ncmVzcyA9IHN0OwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBnZXRUb2tlbjogZnVuY3Rpb24gZ2V0VG9rZW4oKSB7CiAgICAgIHRoaXMuaGVhZGVyWydBdXRob3JpLXphdGlvbiddID0gJ0JlYXJlciAnICsgZ2V0Q29va2llcygndG9rZW4nKTsKICAgIH0sCiAgICBiZWZvcmVVcGxvYWQ6IGZ1bmN0aW9uIGJlZm9yZVVwbG9hZCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHRoaXMudXBsb2FkRGF0YSA9IHt9OwogICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgX3RoaXMzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXNvbHZlKHRydWUpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgcmV0dXJuIHByb21pc2U7CiAgICB9LAogICAgemhfdXBsb2FkRmlsZTogZnVuY3Rpb24gemhfdXBsb2FkRmlsZSgpIHsKICAgICAgaWYgKHRoaXMudmlkZW9MaW5rKSB7CiAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUudmlkZW9fbGluayA9IHRoaXMudmlkZW9MaW5rOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJlZnMucmVmaWQuY2xpY2soKTsKICAgICAgfQogICAgfSwKICAgIHpoX3VwbG9hZEZpbGVfY2hhbmdlOiBmdW5jdGlvbiB6aF91cGxvYWRGaWxlX2NoYW5nZShldmZpbGUpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICBpZiAoZXZmaWxlLnRhcmdldC5maWxlc1swXS50eXBlICE9PSAndmlkZW8vbXA0JykgewogICAgICAgIHJldHVybiB0aGF0LiRNZXNzYWdlLmVycm9yKCflj6rog73kuIrkvKBtcDTmlofku7YnKTsKICAgICAgfQogICAgICBwcm9kdWN0R2V0VGVtcEtleXNBcGkoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB0aGF0LiR2aWRlb0Nsb3VkLnZpZGVvVXBsb2FkKHsKICAgICAgICAgIHR5cGU6IHJlcy5kYXRhLnR5cGUsCiAgICAgICAgICBldmZpbGU6IGV2ZmlsZSwKICAgICAgICAgIHJlczogcmVzLAogICAgICAgICAgdXBsb2FkaW5nOiBmdW5jdGlvbiB1cGxvYWRpbmcoc3RhdHVzLCBwcm9ncmVzcykgewogICAgICAgICAgICB0aGF0LnVwbG9hZC52aWRlb0luZyA9IHN0YXR1czsKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIHRoYXQuZm9ybVZhbGlkYXRlLnZpZGVvX2xpbmsgPSByZXMudXJsOwogICAgICAgICAgdGhhdC4kTWVzc2FnZS5zdWNjZXNzKCfop4bpopHkuIrkvKDmiJDlip8nKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICB0aGF0LiRNZXNzYWdlLmVycm9yKHJlcyk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIHVwbG9hZHM6IGZ1bmN0aW9uIHVwbG9hZHMoKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2dldHZpZGVvJywgdGhpcy5mb3JtVmFsaWRhdGUudmlkZW9fbGluayk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["uploadByPieces","productGetTempKeysApi","uploadType","Setting","getCookies","name","data","fileUrl","apiBaseURL","upload","videoIng","progress","videoLink","formValidate","video_link","upload_type","uploadData","header","created","getToken","methods","delVideo","that","$set","_this","then","res","handleSuccess","file","fileList","status","src","$Message","success","msg","error","videoSaveToUrl","_this2","pieceSize","file_path","e","uploading","chunk","allChunk","st","Math","floor","beforeUpload","_this3","promise","Promise","resolve","$nextTick","zh_uploadFile","$refs","refid","click","zh_uploadFile_change","evfile","target","files","type","$videoCloud","videoUpload","url","catch","uploads","$emit"],"sources":["src/components/uploadVideo/index.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"mt20 ml20\">\n      <Input class=\"perW35\" v-model=\"videoLink\" placeholder=\"请输入视频链接\" />\n      <input type=\"file\" ref=\"refid\" style=\"display: none\" @change=\"zh_uploadFile_change\" />\n      <Button\n        v-if=\"upload_type !== '1' || videoLink\"\n        type=\"primary\"\n        icon=\"ios-cloud-upload-outline\"\n        class=\"ml10\"\n        @click=\"zh_uploadFile\"\n        >{{ videoLink ? '确认添加' : '上传视频' }}</Button\n      >\n      <Upload\n        v-if=\"upload_type === '1' && !videoLink\"\n        :show-upload-list=\"false\"\n        :action=\"fileUrl\"\n        class=\"ml10\"\n        :before-upload=\"videoSaveToUrl\"\n        :data=\"uploadData\"\n        :headers=\"header\"\n        :multiple=\"true\"\n        style=\"display: inline-block\"\n      >\n        <Button type=\"primary\" icon=\"ios-cloud-upload-outline\">上传视频</Button>\n      </Upload>\n      <Progress :percent=\"progress\" :stroke-width=\"5\" v-if=\"upload.videoIng\" />\n      <div class=\"iview-video-style\" v-if=\"formValidate.video_link\">\n        <video\n          style=\"width: 100%; height: 100% !important; border-radius: 10px\"\n          :src=\"formValidate.video_link\"\n          controls=\"controls\"\n        >\n          您的浏览器不支持 video 标签。\n        </video>\n        <div class=\"mark\"></div>\n        <Icon type=\"ios-trash-outline\" class=\"iconv\" @click=\"delVideo\" />\n      </div>\n    </div>\n    <div class=\"mt50 ml20\">\n      <Button type=\"primary\" @click=\"uploads\">确认</Button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { uploadByPieces } from '@/utils/upload'; //引入uploadByPieces方法\nimport { productGetTempKeysApi, uploadType } from '@/api/product';\nimport Setting from '@/setting';\nimport { getCookies } from '@/libs/util';\n\n// import '../../../public/UEditor/dialogs/internal';\nexport default {\n  name: 'vide11o',\n  data() {\n    return {\n      fileUrl: Setting.apiBaseURL + '/file/upload',\n      upload: {\n        videoIng: false, // 是否显示进度条；\n      },\n      progress: 0, // 进度条默认0\n      videoLink: '',\n      formValidate: {\n        video_link: '',\n      },\n      upload_type: '',\n      uploadData: {},\n      header: {},\n    };\n  },\n  created() {\n    this.uploadType();\n    this.getToken();\n  },\n  methods: {\n    // 删除视频；\n    delVideo() {\n      let that = this;\n      that.$set(that.formValidate, 'video_link', '');\n    },\n    //获取视频上传类型\n    uploadType() {\n      uploadType().then((res) => {\n        this.upload_type = res.data.upload_type;\n      });\n    },\n    // 上传成功\n    handleSuccess(res, file, fileList) {\n      if (res.status === 200) {\n        this.formValidate.video_link = res.data.src;\n        this.$Message.success(res.msg);\n      } else {\n        this.$Message.error(res.msg);\n      }\n    },\n    videoSaveToUrl(file) {\n      uploadByPieces({\n        file: file, // 视频实体\n        pieceSize: 3, // 分片大小\n        success: (data) => {\n          this.formValidate.video_link = data.file_path;\n          this.progress = 100;\n        },\n        error: (e) => {\n          this.$Message.error(e.msg);\n        },\n        uploading: (chunk, allChunk) => {\n          this.videoIng = true;\n          let st = Math.floor((chunk / allChunk) * 100);\n          this.progress = st;\n        },\n      });\n      return false;\n    },\n    getToken() {\n      this.header['Authori-zation'] = 'Bearer ' + getCookies('token');\n    },\n    beforeUpload() {\n      this.uploadData = {};\n      let promise = new Promise((resolve) => {\n        this.$nextTick(function () {\n          resolve(true);\n        });\n      });\n      return promise;\n    },\n    zh_uploadFile() {\n      if (this.videoLink) {\n        this.formValidate.video_link = this.videoLink;\n      } else {\n        this.$refs.refid.click();\n      }\n    },\n    zh_uploadFile_change(evfile) {\n      let that = this;\n      if (evfile.target.files[0].type !== 'video/mp4') {\n        return that.$Message.error('只能上传mp4文件');\n      }\n      productGetTempKeysApi().then((res) => {\n        that.$videoCloud\n          .videoUpload({\n            type: res.data.type,\n            evfile: evfile,\n            res: res,\n            uploading(status, progress) {\n              that.upload.videoIng = status;\n            },\n          })\n          .then((res) => {\n            that.formValidate.video_link = res.url;\n            that.$Message.success('视频上传成功');\n          })\n          .catch((res) => {\n            that.$Message.error(res);\n          });\n      });\n    },\n    uploads() {\n      this.$emit('getvideo', this.formValidate.video_link);\n    },\n  },\n};\n</script>\n\n<style scoped>\n.iview-video-style {\n  width: 40%;\n  height: 180px;\n  border-radius: 10px;\n  background-color: #707070;\n  margin-top: 10px;\n  position: relative;\n  overflow: hidden;\n}\n.iview-video-style .iconv {\n  color: #fff;\n  line-height: 180px;\n  width: 50px;\n  height: 50px;\n  display: inherit;\n  font-size: 26px;\n  position: absolute;\n  top: -74px;\n  left: 50%;\n  margin-left: -25px;\n}\n.iview-video-style .mark {\n  position: absolute;\n  width: 100%;\n  height: 30px;\n  top: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  text-align: center;\n}\n</style>\n"],"mappings":"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"}]}