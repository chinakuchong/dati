{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/product/productReply/index.vue?vue&type=style&index=0&id=0fc3d6bc&scoped=true&lang=stylus&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/product/productReply/index.vue","mtime":1689324015249},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/@vue/cli-service/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmNvbnRlbnRfZm9udCB7CiAgY29sb3I6ICMyYjg1ZTQ7Cn0KCi5zZWFyY2ggewogID4+PiAuaXZ1LWZvcm0taXRlbS1jb250ZW50IHsKICAgIG1hcmdpbi1sZWZ0OiAwICFpbXBvcnRhbnQ7CiAgfQp9CgouaXZ1LW10IC5CdXR0b24gLmJudCB7CiAgbWFyZ2luLXJpZ2h0OiA2cHg7Cn0KCi5pdnUtbXQgLml2dS10YWJsZS1yb3cgewogIGZvbnQtc2l6ZTogMTJweDsKICBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjY1KTsKfQoKLml2dS1tdCA+Pj4gLml2dS10YWJsZS1jZWxsIHsKICBwYWRkaW5nOiAxMHB4IDAgIWltcG9ydGFudDsKfQoKLnBpY3RydWUgewogIHdpZHRoOiAzNnB4OwogIGhlaWdodDogMzZweDsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgY3Vyc29yOiBwb2ludGVyOwp9CgoucGljdHJ1ZSBpbWcgewogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogMTAwJTsKICBkaXNwbGF5OiBibG9jazsKICBvYmplY3QtZml0OiBjb3ZlcjsKfQoKLml2dS1tdCAuaW1nUGljIC5pbmZvIHsKICB3aWR0aDogNjAlOwogIG1hcmdpbi1sZWZ0OiAxMHB4Owp9CgouaXZ1LW10IC5waWNMaXN0IC5waWN0cnVlIHsKICBoZWlnaHQ6IDM2cHg7CiAgbWFyZ2luOiA3cHggM3B4IDAgM3B4Owp9CgouaXZ1LW10IC5waWNMaXN0IC5waWN0cnVlIGltZyB7CiAgaGVpZ2h0OiAxMDAlOwogIGRpc3BsYXk6IGJsb2NrOwp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyVA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/product/productReply","sourcesContent":["<template>\n  <div class=\"article-manager\">\n    <div class=\"i-layout-page-header header-title\">\n      <div class=\"fl_header\">\n        <router-link :to=\"{ path: $routeProStr + '/product/product_list' }\" v-if=\"$route.params.id\"\n          ><Button icon=\"ios-arrow-back\" size=\"small\" class=\"mr20\">返回</Button></router-link\n        >\n        <span class=\"ivu-page-header-title mr20\">商品评论管理</span>\n      </div>\n    </div>\n    <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n      <Form ref=\"formValidate\" :model=\"formValidate\" :label-width=\"75\" label-position=\"left\" @submit.native.prevent>\n        <Row type=\"flex\" :gutter=\"24\">\n          <Col span=\"24\">\n            <FormItem label=\"评论时间：\">\n              <RadioGroup\n                v-model=\"formValidate.data\"\n                type=\"button\"\n                @on-change=\"selectChange(formValidate.data)\"\n                class=\"mr\"\n              >\n                <Radio :label=\"item.val\" v-for=\"(item, i) in fromList.fromTxt\" :key=\"i\">{{ item.text }}</Radio>\n              </RadioGroup>\n              <DatePicker\n                :editable=\"false\"\n                @on-change=\"onchangeTime\"\n                :value=\"timeVal\"\n                format=\"yyyy/MM/dd\"\n                type=\"daterange\"\n                placement=\"bottom-end\"\n                placeholder=\"请选择时间\"\n                style=\"width: 200px\"\n              ></DatePicker>\n            </FormItem>\n          </Col>\n          <Col v-bind=\"grid\">\n            <FormItem label=\"评价状态：\">\n              <Select v-model=\"formValidate.is_reply\" placeholder=\"请选择\" clearable @on-change=\"userSearchs\">\n                <Option value=\"1\">已回复</Option>\n                <Option value=\"0\">未回复</Option>\n              </Select>\n            </FormItem>\n          </Col>\n          <Col v-bind=\"grid\" v-if=\"!$route.params.id\">\n            <FormItem label=\"商品信息：\" label-for=\"store_name\">\n              <Input\n                size=\"default\"\n                enter-button\n                placeholder=\"请输入商品ID或者商品信息\"\n                clearable\n                v-model=\"formValidate.store_name\"\n              />\n            </FormItem>\n          </Col>\n          <Col v-bind=\"grid\">\n            <FormItem label=\"用户名称：\" label-for=\"account\">\n              <Input size=\"default\" enter-button placeholder=\"请输入\" clearable v-model=\"formValidate.account\" />\n            </FormItem>\n          </Col>\n          <Col :xl=\"3\" :lg=\"3\" :md=\"12\" :sm=\"12\" :xs=\"24\" class=\"search\">\n            <FormItem>\n              <Button type=\"primary\" icon=\"ios-search\" @click=\"userSearchs\">搜索</Button>\n            </FormItem>\n          </Col>\n        </Row>\n      </Form>\n      <!--            <div class=\"Button\">-->\n      <!--                <Button type=\"primary\" class=\"bnt\" icon=\"md-add\">添加评论</Button>-->\n      <!--            </div>-->\n      <Row type=\"flex\">\n        <Col v-bind=\"grid\">\n          <Button v-auth=\"['product-reply-save_fictitious_reply']\" type=\"primary\" icon=\"md-add\" @click=\"add\"\n            >添加自评</Button\n          >\n        </Col>\n      </Row>\n      <Table\n        ref=\"table\"\n        :columns=\"columns\"\n        :data=\"tableList\"\n        class=\"ivu-mt mt25\"\n        :loading=\"loading\"\n        @on-sort-change=\"sortMethod\"\n        no-data-text=\"暂无数据\"\n        no-filtered-data-text=\"暂无筛选结果\"\n      >\n        <template slot-scope=\"{ row }\" slot=\"info\">\n          <div class=\"imgPic acea-row row-middle\">\n            <div class=\"pictrue\" v-viewer><img v-lazy=\"row.image\" /></div>\n            <div class=\"info\">{{ row.store_name }}</div>\n          </div>\n        </template>\n        <template slot-scope=\"{ row }\" slot=\"content\">\n          <div class=\"mb5 content_font\">{{ row.comment }}</div>\n          <div v-viewer class=\"pictrue mr10\" v-for=\"(item, index) in row.pics || []\" :key=\"index\">\n            <img v-lazy=\"item\" :src=\"item\" />\n          </div>\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"action\">\n          <a @click=\"reply(row)\">回复</a>\n          <Divider type=\"vertical\" />\n          <a @click=\"del(row, '删除评论', index)\">删除</a>\n        </template>\n      </Table>\n      <div class=\"acea-row row-right page\">\n        <Page\n          :total=\"total\"\n          :current=\"formValidate.page\"\n          show-elevator\n          show-total\n          @on-change=\"pageChange\"\n          :page-size=\"formValidate.limit\"\n        />\n      </div>\n    </Card>\n    <Modal v-model=\"modals\" scrollable title=\"回复内容\" closable>\n      <Form ref=\"contents\" :model=\"contents\" :rules=\"ruleInline\" label-position=\"right\" @submit.native.prevent>\n        <FormItem prop=\"content\">\n          <Input v-model=\"contents.content\" type=\"textarea\" :rows=\"4\" placeholder=\"请输入回复内容\" />\n        </FormItem>\n      </Form>\n      <div slot=\"footer\">\n        <Button type=\"primary\" @click=\"oks\">确定</Button>\n        <Button @click=\"cancels\">取消</Button>\n      </div>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { replyListApi, setReplyApi, fictitiousReply } from '@/api/product';\nexport default {\n  name: 'product_productEvaluate',\n  data() {\n    return {\n      modals: false,\n      grid: {\n        xl: 7,\n        lg: 10,\n        md: 12,\n        sm: 12,\n        xs: 24,\n      },\n      formValidate: {\n        is_reply: '',\n        data: '',\n        store_name: '',\n        key: '',\n        order: '',\n        account: '',\n        product_id: this.$route.params.id === undefined ? 0 : this.$route.params.id,\n        page: 1,\n        limit: 15,\n      },\n      fromList: {\n        title: '选择时间',\n        custom: true,\n        fromTxt: [\n          { text: '全部', val: '' },\n          { text: '今天', val: 'today' },\n          { text: '昨天', val: 'yesterday' },\n          { text: '最近7天', val: 'lately7' },\n          { text: '最近30天', val: 'lately30' },\n          { text: '本月', val: 'month' },\n          { text: '本年', val: 'year' },\n        ],\n      },\n      value: '45',\n      tableList: [],\n      total: 0,\n      loading: false,\n      columns: [\n        {\n          title: '评论ID',\n          key: 'id',\n          width: 80,\n        },\n        {\n          title: '商品信息',\n          slot: 'info',\n          minWidth: 230,\n        },\n        {\n          title: '用户名称',\n          key: 'nickname',\n          minWidth: 150,\n        },\n        {\n          title: '评分',\n          key: 'score',\n          sortable: true,\n          minWidth: 90,\n        },\n        {\n          title: '评价内容',\n          slot: 'content',\n          minWidth: 210,\n        },\n        {\n          title: '回复内容',\n          key: 'merchant_reply_content',\n          minWidth: 250,\n        },\n        {\n          title: '评价时间',\n          key: 'add_time',\n          sortable: true,\n          minWidth: 150,\n        },\n        {\n          title: '操作',\n          slot: 'action',\n          fixed: 'right',\n          minWidth: 150,\n        },\n      ],\n      timeVal: [],\n      contents: {\n        content: '',\n      },\n      ruleInline: {\n        content: [{ required: true, message: '请输入回复内容', trigger: 'blur' }],\n      },\n      rows: {},\n    };\n  },\n  computed: {},\n  created() {\n    if (this.$route.query.is_reply == 0) this.formValidate.is_reply = this.$route.query.is_reply;\n    this.getList();\n  },\n  watch: {\n    '$route.params.id'(to, from) {\n      this.formValidate.product_id = 0;\n      this.getList();\n    },\n  },\n  methods: {\n    // 添加虚拟评论；\n    add() {\n      this.$modalForm(fictitiousReply(this.formValidate.product_id)).then(() => this.getList());\n    },\n    oks() {\n      this.modals = true;\n      this.$refs['contents'].validate((valid) => {\n        if (valid) {\n          setReplyApi(this.contents, this.rows.id)\n            .then(async (res) => {\n              this.$Message.success(res.msg);\n              this.modals = false;\n              this.$refs['contents'].resetFields();\n              this.getList();\n            })\n            .catch((res) => {\n              this.$Message.error(res.msg);\n            });\n        } else {\n          return false;\n        }\n      });\n    },\n    cancels() {\n      this.modals = false;\n      this.$refs['contents'].resetFields();\n    },\n    // 删除\n    del(row, tit, num) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `product/reply/${row.id}`,\n        method: 'DELETE',\n        ids: '',\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$Message.success(res.msg);\n          this.tableList.splice(num, 1);\n          this.total = this.total - 1;\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    // 回复\n    reply(row) {\n      this.modals = true;\n      this.rows = row;\n    },\n    // 具体日期\n    onchangeTime(e) {\n      this.timeVal = e;\n      this.formValidate.data = this.timeVal[0] ? this.timeVal.join('-') : '';\n      this.formValidate.page = 1;\n      this.getList();\n    },\n    sortMethod(a) {\n      if (a.order === 'normal') {\n        this.formValidate.key = '';\n        this.formValidate.order = '';\n      } else {\n        this.formValidate.key = a.key;\n        this.formValidate.order = a.order;\n      }\n      this.getList();\n    },\n    // 选择时间\n    selectChange(tab) {\n      this.formValidate.data = tab;\n      this.timeVal = [];\n      this.formValidate.page = 1;\n      this.getList();\n    },\n    // 列表\n    getList() {\n      this.loading = true;\n      this.formValidate.is_reply = this.formValidate.is_reply || '';\n      this.formValidate.store_name = this.formValidate.store_name || '';\n      replyListApi(this.formValidate)\n        .then(async (res) => {\n          let data = res.data;\n          this.tableList = data.list;\n          this.total = res.data.count;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    pageChange(index) {\n      this.formValidate.page = index;\n      this.getList();\n    },\n    // 表格搜索\n    userSearchs() {\n      this.formValidate.page = 1;\n      this.getList();\n    },\n    search() {},\n  },\n};\n</script>\n<style scoped lang=\"stylus\">\n.content_font {\n  color: #2b85e4;\n}\n\n.search {\n  >>> .ivu-form-item-content {\n    margin-left: 0 !important;\n  }\n}\n\n.ivu-mt .Button .bnt {\n  margin-right: 6px;\n}\n\n.ivu-mt .ivu-table-row {\n  font-size: 12px;\n  color: rgba(0, 0, 0, 0.65);\n}\n\n.ivu-mt >>> .ivu-table-cell {\n  padding: 10px 0 !important;\n}\n\n.pictrue {\n  width: 36px;\n  height: 36px;\n  display: inline-block;\n  cursor: pointer;\n}\n\n.pictrue img {\n  width: 100%;\n  height: 100%;\n  display: block;\n  object-fit: cover;\n}\n\n.ivu-mt .imgPic .info {\n  width: 60%;\n  margin-left: 10px;\n}\n\n.ivu-mt .picList .pictrue {\n  height: 36px;\n  margin: 7px 3px 0 3px;\n}\n\n.ivu-mt .picList .pictrue img {\n  height: 100%;\n  display: block;\n}\n</style>\n"]}]}