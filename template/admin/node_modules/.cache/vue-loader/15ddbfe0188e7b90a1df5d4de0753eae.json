{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/system/crontab/createModal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/system/crontab/createModal.vue","mtime":1689324015274},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcE11dGF0aW9ucyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyB0aW1lclRhc2ssIHRpbWVySW5mbywgc2F2ZVRpbWVyLCB1cGRhdGVUaW1lciB9IGZyb20gJ0AvYXBpL3N5c3RlbSc7CmV4cG9ydCBkZWZhdWx0IHsKICBmaWx0ZXJzOiB7CiAgICBmb3JtYXRXZWVrKHZhbHVlKSB7CiAgICAgIHJldHVybiBbJ+WRqOS4gCcsICflkajkuownLCAn5ZGo5LiJJywgJ+WRqOWbmycsICflkajkupQnLCAn5ZGo5YWtJywgJ+WRqOaXpSddW3ZhbHVlIC0gMV07CiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1vZGFsOiBmYWxzZSwKICAgICAgdHlwZUxpc3Q6IFsKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAn5q+P6ZqUTuenkicsCiAgICAgICAgICB2YWx1ZTogMSwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICfmr4/pmpRO5YiG6ZKfJywKICAgICAgICAgIHZhbHVlOiAyLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogJ+avj+malE7lsI/ml7YnLAogICAgICAgICAgdmFsdWU6IDMsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAn5q+P6ZqUTuWkqScsCiAgICAgICAgICB2YWx1ZTogNCwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICfmr4/lpKknLAogICAgICAgICAgdmFsdWU6IDUsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAn5q+P5pif5pyfJywKICAgICAgICAgIHZhbHVlOiA2LAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogJ+avj+aciCcsCiAgICAgICAgICB2YWx1ZTogNywKICAgICAgICB9LAogICAgICBdLAogICAgICB0YXNrOiB7fSwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGZvcm1WYWxpZGF0ZTogewogICAgICAgIG1hcms6ICcnLCAvL+mUrgogICAgICAgIGNvbnRlbnQ6ICcnLAogICAgICAgIGlzX29wZW46IDAsCiAgICAgICAgdHlwZTogNiwKICAgICAgICB3ZWVrOiAxLAogICAgICAgIGRheTogMSwKICAgICAgICBob3VyOiAxLAogICAgICAgIG1pbnV0ZTogMzAsCiAgICAgICAgc2Vjb25kOiAwLAogICAgICB9LAogICAgICB0cmlwOiAnJywKICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy50aW1lclRhc2soKTsKICB9LAogIHdhdGNoOiB7CiAgICBmb3JtVmFsaWRhdGU6IHsKICAgICAgaGFuZGxlcihuVmFsLCBvVmFsKSB7CiAgICAgICAgc3dpdGNoIChuVmFsLnR5cGUpIHsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgdGhpcy50cmlwID0gYOavj+malCR7blZhbC5zZWNvbmR956eS5omn6KGM5LiA5qyhYDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHRoaXMudHJpcCA9IGDmr4/pmpQke25WYWwubWludXRlfeWIhumSn+aJp+ihjOS4gOasoWA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICB0aGlzLnRyaXAgPSBg5q+P6ZqUJHtuVmFsLmhvdXJ95bCP5pe255qEJHtuVmFsLm1pbnV0ZX3liIbmiafooYzkuIDmrKFgOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgdGhpcy50cmlwID0gYOavj+malCR7blZhbC5kYXl95aSp55qEJHtuVmFsLmhvdXJ95pe2JHtuVmFsLm1pbnV0ZX3liIbmiafooYzkuIDmrKFgOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgdGhpcy50cmlwID0gYOavj+WkqSR7blZhbC5ob3VyfeaXtiR7blZhbC5taW51dGV95YiGJHtuVmFsLnNlY29uZH3np5LmiafooYzkuIDmrKFgOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgdGhpcy50cmlwID0gYOavj+S4quaYn+acnyR7blZhbC53ZWVrfeeahCR7blZhbC5ob3VyfeaXtiR7blZhbC5taW51dGV95YiGJHtuVmFsLnNlY29uZH3np5LmiafooYzkuIDmrKFgOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgdGhpcy50cmlwID0gYOavj+aciCR7blZhbC5kYXl95pel55qEJHtuVmFsLmhvdXJ95pe2JHtuVmFsLm1pbnV0ZX3liIYke25WYWwuc2Vjb25kfeenkuaJp+ihjOS4gOasoWA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaW1tZWRpYXRlOiB0cnVlLAogICAgICBkZWVwOiB0cnVlLAogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcE11dGF0aW9ucygnYWRtaW4vbGF5b3V0JywgWydzZXRDb3B5cmlnaHRTaG93J10pLAogICAgdGltZXJUYXNrKCkgewogICAgICB0aW1lclRhc2soKS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLnRhc2sgPSByZXMuZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgaW5pdERhdGEoc3RhdHVzKSB7CiAgICAgIGlmICghc3RhdHVzKSB7CiAgICAgICAgdGhpcy5mb3JtVmFsaWRhdGUgPSB7CiAgICAgICAgICBtYXJrOiAnJywKICAgICAgICAgIGNvbnRlbnQ6ICcnLAogICAgICAgICAgaXNfb3BlbjogMCwKICAgICAgICAgIHR5cGU6IDYsCiAgICAgICAgICB3ZWVrOiAxLAogICAgICAgICAgZGF5OiAxLAogICAgICAgICAgaG91cjogMSwKICAgICAgICAgIG1pbnV0ZTogMzAsCiAgICAgICAgICBzZWNvbmQ6IDAsCiAgICAgICAgfTsKICAgICAgICB0aGlzLm1vZGFsID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICB0aW1lckluZm8oaWQpIHsKICAgICAgdGltZXJJbmZvKGlkKS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLm1vZGFsID0gdHJ1ZTsKICAgICAgICB0aGlzLmZvcm1WYWxpZGF0ZSA9IHJlcy5kYXRhOwogICAgICAgIC8vIHRoaXMuZm9ybVZhbGlkYXRlLm5hbWUgPSBuYW1lOwogICAgICAgIC8vIHRoaXMuZm9ybVZhbGlkYXRlLm1hcmsgPSBtYXJrOwogICAgICAgIC8vIHRoaXMuZm9ybVZhbGlkYXRlLmNvbnRlbnQgPSBjb250ZW50OwogICAgICAgIC8vIHRoaXMuZm9ybVZhbGlkYXRlLmlzX29wZW4gPSBpc19vcGVuOwogICAgICAgIC8vIHRoaXMuZm9ybVZhbGlkYXRlLnR5cGUgPSB0eXBlOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDmj5DkuqQKICAgIGhhbmRsZVN1Ym1pdCgpIHsKICAgICAgaWYgKCF0aGlzLmZvcm1WYWxpZGF0ZS5tYXJrKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJE1lc3NhZ2UuZXJyb3IoewogICAgICAgICAgY29udGVudDogJ+ivt+mAieaLqeS7u+WKoeWQjeensCcsCiAgICAgICAgICBvbkNsb3NlOiAoKSA9PiB7CiAgICAgICAgICAgIC8vIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgfSwKICAgICAgICB9KTsKICAgICAgfQogICAgICB0aGlzLnNhdmVUaW1lcih0aGlzLmZvcm1WYWxpZGF0ZSk7CiAgICB9LAogICAgdGFza0NoYW5nZSh0YXNrKSB7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLm1hcmsgPSB0YXNrLnZhbHVlOwogICAgfSwKICAgIHNhdmVUaW1lcihkYXRhKSB7CiAgICAgIHNhdmVUaW1lcihkYXRhKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJE1lc3NhZ2Uuc3VjY2Vzcyh7CiAgICAgICAgICAgIGNvbnRlbnQ6IHJlcy5tc2csCiAgICAgICAgICAgIG9uQ2xvc2U6ICgpID0+IHsKICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzdWJtaXRBc2snKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH0pOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IoZXJyLm1zZyk7CiAgICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["createModal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"createModal.vue","sourceRoot":"src/pages/system/crontab","sourcesContent":["<template>\n  <div>\n    <Modal\n      v-model=\"modal\"\n      :title=\"formValidate.id ? '编辑定时任务' : '添加定时任务'\"\n      width=\"900\"\n      @on-ok=\"handleSubmit\"\n      @on-cancel=\"modal = true\"\n      @on-visible-change=\"initData\"\n    >\n      <Form ref=\"formValidate\" :model=\"formValidate\" :label-width=\"97\" label-colon>\n        <FormItem label=\"任务名称\" required>\n          <Row :gutter=\"16\">\n            <Col span=\"20\">\n              <Select v-model=\"formValidate.mark\" label-in-value @on-change=\"taskChange\">\n                <Option v-for=\"(value, name) in task\" :key=\"name\" :value=\"name\">{{ value }}</Option>\n              </Select>\n            </Col>\n          </Row>\n        </FormItem>\n        <FormItem label=\"执行周期\" required>\n          <Row :gutter=\"14\">\n            <Col span=\"4\">\n              <Select v-model=\"formValidate.type\">\n                <Option v-for=\"item in typeList\" :key=\"item.value\" :value=\"item.value\">{{ item.name }}</Option>\n              </Select>\n            </Col>\n            <Col v-if=\"formValidate.type == 6\" span=\"4\">\n              <Select v-model=\"formValidate.week\">\n                <Option v-for=\"item in 7\" :key=\"item\" :value=\"item\">{{ item | formatWeek }}</Option>\n              </Select>\n            </Col>\n            <Col v-if=\"[4, 7].includes(formValidate.type)\" span=\"4\">\n              <div class=\"input-number-wrapper\">\n                <InputNumber\n                  v-model=\"formValidate.day\"\n                  :max=\"formValidate.type === 4 ? 10000 : 31\"\n                  :min=\"1\"\n                ></InputNumber>\n                <span class=\"suffix\">日</span>\n              </div>\n            </Col>\n            <Col v-if=\"[3, 4, 5, 6, 7].includes(formValidate.type)\" span=\"4\">\n              <div class=\"input-number-wrapper\">\n                <InputNumber v-model=\"formValidate.hour\" :max=\"23\" :min=\"0\"></InputNumber>\n                <span class=\"suffix\">时</span>\n              </div>\n            </Col>\n            <Col span=\"4\" v-if=\"[2, 3, 4, 5, 6, 7].includes(formValidate.type)\">\n              <div class=\"input-number-wrapper\">\n                <InputNumber\n                  v-model=\"formValidate.minute\"\n                  :max=\"formValidate.type === 2 ? 36000 : 59\"\n                  :min=\"0\"\n                ></InputNumber>\n                <span class=\"suffix\">分</span>\n              </div>\n            </Col>\n            <Col span=\"4\" v-if=\"[1, 5, 6, 7].includes(formValidate.type)\">\n              <div class=\"input-number-wrapper\">\n                <InputNumber\n                  v-model=\"formValidate.second\"\n                  :max=\"formValidate.type === 1 ? 36000 : 59\"\n                  :min=\"0\"\n                ></InputNumber>\n                <span class=\"suffix\">秒</span>\n              </div>\n            </Col>\n          </Row>\n          <Row :gutter=\"12\">\n            <div class=\"trip\">{{ trip }}</div>\n          </Row>\n        </FormItem>\n        <FormItem label=\"任务说明\">\n          <Row :gutter=\"10\">\n            <Col span=\"20\">\n              <Input\n                v-model=\"formValidate.content\"\n                type=\"textarea\"\n                :autosize=\"{ minRows: 5, maxRows: 5 }\"\n                placeholder=\"请输入任务说明\"\n              ></Input>\n            </Col>\n          </Row>\n        </FormItem>\n        <FormItem label=\"是否开启\">\n          <Row :gutter=\"10\">\n            <Col span=\"12\">\n              <i-switch v-model=\"formValidate.is_open\" :true-value=\"1\" :false-value=\"0\" size=\"large\">\n                <span slot=\"open\">开启</span>\n                <span slot=\"close\">关闭</span>\n              </i-switch>\n            </Col>\n          </Row>\n        </FormItem>\n      </Form>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport { mapMutations } from 'vuex';\nimport { timerTask, timerInfo, saveTimer, updateTimer } from '@/api/system';\nexport default {\n  filters: {\n    formatWeek(value) {\n      return ['周一', '周二', '周三', '周四', '周五', '周六', '周日'][value - 1];\n    },\n  },\n  data() {\n    return {\n      modal: false,\n      typeList: [\n        {\n          name: '每隔N秒',\n          value: 1,\n        },\n        {\n          name: '每隔N分钟',\n          value: 2,\n        },\n        {\n          name: '每隔N小时',\n          value: 3,\n        },\n        {\n          name: '每隔N天',\n          value: 4,\n        },\n        {\n          name: '每天',\n          value: 5,\n        },\n        {\n          name: '每星期',\n          value: 6,\n        },\n        {\n          name: '每月',\n          value: 7,\n        },\n      ],\n      task: {},\n      loading: false,\n      formValidate: {\n        mark: '', //键\n        content: '',\n        is_open: 0,\n        type: 6,\n        week: 1,\n        day: 1,\n        hour: 1,\n        minute: 30,\n        second: 0,\n      },\n      trip: '',\n    };\n  },\n  created() {\n    this.timerTask();\n  },\n  watch: {\n    formValidate: {\n      handler(nVal, oVal) {\n        switch (nVal.type) {\n          case 1:\n            this.trip = `每隔${nVal.second}秒执行一次`;\n            break;\n          case 2:\n            this.trip = `每隔${nVal.minute}分钟执行一次`;\n            break;\n          case 3:\n            this.trip = `每隔${nVal.hour}小时的${nVal.minute}分执行一次`;\n            break;\n          case 4:\n            this.trip = `每隔${nVal.day}天的${nVal.hour}时${nVal.minute}分执行一次`;\n            break;\n          case 5:\n            this.trip = `每天${nVal.hour}时${nVal.minute}分${nVal.second}秒执行一次`;\n            break;\n          case 6:\n            this.trip = `每个星期${nVal.week}的${nVal.hour}时${nVal.minute}分${nVal.second}秒执行一次`;\n            break;\n          case 7:\n            this.trip = `每月${nVal.day}日的${nVal.hour}时${nVal.minute}分${nVal.second}秒执行一次`;\n            break;\n        }\n      },\n      immediate: true,\n      deep: true,\n    },\n  },\n  methods: {\n    ...mapMutations('admin/layout', ['setCopyrightShow']),\n    timerTask() {\n      timerTask().then((res) => {\n        this.task = res.data;\n      });\n    },\n    initData(status) {\n      if (!status) {\n        this.formValidate = {\n          mark: '',\n          content: '',\n          is_open: 0,\n          type: 6,\n          week: 1,\n          day: 1,\n          hour: 1,\n          minute: 30,\n          second: 0,\n        };\n        this.modal = false;\n      }\n    },\n    timerInfo(id) {\n      timerInfo(id).then((res) => {\n        this.modal = true;\n        this.formValidate = res.data;\n        // this.formValidate.name = name;\n        // this.formValidate.mark = mark;\n        // this.formValidate.content = content;\n        // this.formValidate.is_open = is_open;\n        // this.formValidate.type = type;\n      });\n    },\n    // 提交\n    handleSubmit() {\n      if (!this.formValidate.mark) {\n        return this.$Message.error({\n          content: '请选择任务名称',\n          onClose: () => {\n            // this.loading = false;\n          },\n        });\n      }\n      this.saveTimer(this.formValidate);\n    },\n    taskChange(task) {\n      this.formValidate.mark = task.value;\n    },\n    saveTimer(data) {\n      saveTimer(data)\n        .then((res) => {\n          this.$Message.success({\n            content: res.msg,\n            onClose: () => {\n              this.$emit('submitAsk');\n            },\n          });\n        })\n        .catch((err) => {\n          this.$Message.error(err.msg);\n        });\n    },\n  },\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.form-card {\n  margin-bottom: 74px;\n\n  >>> .ivu-card-body {\n    padding: 30px 0;\n  }\n}\n\n.btn-card {\n  position: fixed;\n  right: 0;\n  bottom: 0;\n  left: 200px;\n  z-index: 2;\n  text-align: center;\n}\n\n.input-number-wrapper {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  vertical-align: middle;\n  line-height: normal;\n\n  .ivu-input-number {\n    width: 100%;\n    padding-right: 35px;\n  }\n\n  >>> .ivu-input-number-handler-wrap {\n    right: 35px;\n  }\n\n  .suffix {\n    position: absolute;\n    top: 0;\n    right: 0;\n    z-index: 1;\n    width: 35px;\n    height: 100%;\n    text-align: center;\n    font-size: 12px;\n    line-height: 33px;\n    color: #333333;\n  }\n}\n\n.trip {\n  padding-left: 15px;\n  color: #aaa;\n}\n</style>\n"]}]}