{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/user/list/index.vue?vue&type=style&index=0&id=54fabd91&scoped=true&lang=stylus&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/user/list/index.vue","mtime":1689324015287},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/@vue/cli-service/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLnBpY0JveCB7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIGN1cnNvcjogcG9pbnRlcjsKCiAgLnVwTG9hZCB7CiAgICB3aWR0aDogNThweDsKICAgIGhlaWdodDogNThweDsKICAgIGxpbmUtaGVpZ2h0OiA1OHB4OwogICAgYm9yZGVyOiAxcHggZG90dGVkIHJnYmEoMCwgMCwgMCwgMC4xKTsKICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wMik7CiAgfQoKICAucGljdHJ1ZSB7CiAgICB3aWR0aDogNjBweDsKICAgIGhlaWdodDogNjBweDsKICAgIGJvcmRlcjogMXB4IGRvdHRlZCByZ2JhKDAsIDAsIDAsIDAuMSk7CiAgICBtYXJnaW4tcmlnaHQ6IDEwcHg7CgogICAgaW1nIHsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGhlaWdodDogMTAwJTsKICAgIH0KICB9Cn0KCi51c2VyRnJvbSB7CiAgPj4+IC5pdnUtZm9ybS1pdGVtLWNvbnRlbnQgewogICAgbWFyZ2luLWxlZnQ6IDBweCAhaW1wb3J0YW50OwogIH0KfQoKLnVzZXJBbGVydCB7CiAgbWFyZ2luLXRvcDogMjBweDsKfQoKLnVzZXJJIHsKICBjb2xvcjogIzE4OTBGRjsKICBmb250LXN0eWxlOiBub3JtYWw7Cn0KCmltZyB7CiAgaGVpZ2h0OiAzNnB4OwogIGRpc3BsYXk6IGJsb2NrOwp9CgoudGFiQm94X2ltZyB7CiAgd2lkdGg6IDM2cHg7CiAgaGVpZ2h0OiAzNnB4OwogIGJvcmRlci1yYWRpdXM6IDRweDsKICBjdXJzb3I6IHBvaW50ZXI7CgogIGltZyB7CiAgICB3aWR0aDogMTAwJTsKICAgIGhlaWdodDogMTAwJTsKICB9Cn0KCi50YWJCb3hfdGl0IHsKICB3aWR0aDogNjAlOwogIGZvbnQtc2l6ZTogMTJweCAhaW1wb3J0YW50OwogIG1hcmdpbjogMCAycHggMCAxMHB4OwogIGxldHRlci1zcGFjaW5nOiAxcHg7CiAgcGFkZGluZzogNXB4IDA7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKfQoKLm1vZGVsQm94IHsKICA+Pj4gLml2dS1tb2RhbC1ib2R5IHsKICAgIHBhZGRpbmc6IDAgMTZweCAxNnB4IDE2cHggIWltcG9ydGFudDsKICB9Cn0KCi52aXBOYW1lIHsKICBjb2xvcjogI2RhYjE3NjsKfQoKLmxpc3Rib3ggewogID4+Pi5pdnUtZGl2aWRlci1ob3Jpem9udGFsIHsKICAgIG1hcmdpbjogMCAhaW1wb3J0YW50OwogIH0KfQoKLmxhYmVsSW5wdXQgewogIGJvcmRlcjogMXB4IHNvbGlkICNkY2RlZTI7CiAgcGFkZGluZzogMCA2cHg7CiAgYm9yZGVyLXJhZGl1czogNXB4OwogIG1pbi1oZWlnaHQ6IDMwcHg7CiAgY3Vyc29yOiBwb2ludGVyOwoKICAuc3BhbiB7CiAgICBjb2xvcjogI2M1YzhjZTsKICB9CgogIC5pdnUtaWNvbi1pb3MtYXJyb3ctZG93biB7CiAgICBmb250LXNpemU6IDE0cHg7CiAgICBjb2xvcjogIzgwODY5NTsKICB9Cn0KCi5kZW1vLWRyYXdlci1mb290ZXIgewogIHdpZHRoOiAxMDAlOwogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBib3R0b206IDA7CiAgbGVmdDogMDsKICBib3JkZXItdG9wOiAxcHggc29saWQgI2U4ZThlODsKICBwYWRkaW5nOiAxMHB4IDE2cHg7CiAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgYmFja2dyb3VuZDogI2ZmZjsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyuCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/user/list","sourcesContent":["<template>\n  <div>\n    <Card :bordered=\"false\" dis-hover class=\"ivu-mt listbox\">\n      <Tabs @on-click=\"onClickTab\" class=\"mb30\">\n        <TabPane :label=\"item.name\" :name=\"item.type\" v-for=\"(item, index) in headeNum\" :key=\"index\" />\n      </Tabs>\n      <Form\n        ref=\"userFrom\"\n        :model=\"userFrom\"\n        :label-width=\"labelWidth\"\n        :label-position=\"labelPosition\"\n        @submit.native.prevent\n      >\n        <Row :gutter=\"16\">\n          <Col v-bind=\"grid\">\n            <FormItem label=\"用户搜索：\" label-for=\"nickname\">\n              <Input v-model=\"userFrom.nickname\" placeholder=\"请输入用户\" element-id=\"nickname\" clearable>\n                <Select v-model=\"field_key\" slot=\"prepend\" style=\"width: 80px\">\n                  <Option value=\"all\">全部</Option>\n                  <Option value=\"uid\">UID</Option>\n                  <Option value=\"phone\">手机号</Option>\n                  <Option value=\"nickname\">用户昵称</Option>\n                </Select>\n              </Input>\n            </FormItem>\n          </Col>\n          <Col span=\"12\" class=\"ivu-text-left userFrom\" v-if=\"!collapse\">\n            <FormItem>\n              <Button type=\"primary\" icon=\"ios-search\" label=\"default\" class=\"mr15\" @click=\"userSearchs\">搜索</Button>\n              <Button class=\"ResetSearch\" @click=\"reset('userFrom')\">重置</Button>\n              <a class=\"ivu-ml-8 font14 ml10\" @click=\"collapse = !collapse\">\n                <template v-if=\"!collapse\"> 展开 <Icon type=\"ios-arrow-down\" /> </template>\n                <template v-else> 收起 <Icon type=\"ios-arrow-up\" /> </template>\n              </a>\n            </FormItem>\n          </Col>\n          <template v-if=\"collapse\">\n            <Col span=\"18\">\n              <Col v-bind=\"grid\">\n                <FormItem label=\"用户标签：\" label-for=\"label_id\">\n                  <div class=\"labelInput acea-row row-between-wrapper\" @click=\"openSelectLabel\">\n                    <div style=\"width: 90%\">\n                      <div v-if=\"selectDataLabel.length\">\n                        <Tag\n                          :closable=\"false\"\n                          v-for=\"(item, index) in selectDataLabel\"\n                          @on-close=\"closeLabel(item)\"\n                          :key=\"index\"\n                          >{{ item.label_name }}</Tag\n                        >\n                      </div>\n                      <span class=\"span\" v-else>选择用户关联标签</span>\n                    </div>\n                    <div class=\"ivu-icon ivu-icon-ios-arrow-down\"></div>\n                  </div>\n                </FormItem>\n              </Col>\n              <Col v-bind=\"grid\">\n                <FormItem label=\"下单次数：\" label-for=\"pay_count\">\n                  <Select v-model=\"pay_count\" placeholder=\"请选择下单次数\" element-id=\"pay_count\" clearable>\n                    <Option value=\"all\">全部</Option>\n                    <Option value=\"-1\">0次</Option>\n                    <Option value=\"0\">1次以上</Option>\n                    <Option value=\"1\">2次以上</Option>\n                    <Option value=\"2\">3次以上</Option>\n                    <Option value=\"3\">4次以上</Option>\n                    <Option value=\"4\">5次以上</Option>\n                  </Select>\n                </FormItem>\n              </Col>\n            </Col>\n            <Col span=\"18\">\n              <Col v-bind=\"grid\">\n                <FormItem label=\"用户分组：\" label-for=\"group_id\">\n                  <Select v-model=\"group_id\" placeholder=\"请选择用户分组\" element-id=\"group_id\" clearable>\n                    <Option value=\"all\">全部</Option>\n                    <Option :value=\"item.id\" v-for=\"(item, index) in groupList\" :key=\"index\">{{\n                      item.group_name\n                    }}</Option>\n                  </Select>\n                </FormItem>\n              </Col>\n              <Col v-bind=\"grid\">\n                <FormItem label=\"用户等级：\" label-for=\"level\">\n                  <Select v-model=\"level\" placeholder=\"请选择用户等级\" element-id=\"level\" clearable>\n                    <Option value=\"all\">全部</Option>\n                    <Option :value=\"item.id\" v-for=\"(item, index) in levelList\" :key=\"index\">{{ item.name }}</Option>\n                  </Select>\n                </FormItem>\n              </Col>\n            </Col>\n            <Col span=\"18\">\n              <!-- <Col v-bind=\"grid\">\n                <FormItem label=\"性别：\" label-for=\"sex\">\n                  <RadioGroup v-model=\"userFrom.sex\" type=\"button\">\n                    <Radio label=\"\">\n                      <span>全部</span>\n                    </Radio>\n                    <Radio label=\"1\">\n                      <span>男</span>\n                    </Radio>\n                    <Radio label=\"2\">\n                      <span>女</span>\n                    </Radio>\n                    <Radio label=\"0\">\n                      <span>保密</span>\n                    </Radio>\n                  </RadioGroup>\n                </FormItem>\n              </Col> -->\n              <Col v-bind=\"grid\">\n                <FormItem label=\"身份：\" label-for=\"is_promoter\">\n                  <RadioGroup v-model=\"userFrom.is_promoter\" type=\"button\">\n                    <Radio label=\"\">\n                      <span>全部</span>\n                    </Radio>\n                    <Radio label=\"1\">\n                      <span>推广员</span>\n                    </Radio>\n                    <Radio label=\"0\">\n                      <span>普通用户</span>\n                    </Radio>\n                  </RadioGroup>\n                </FormItem>\n              </Col>\n              <Col v-bind=\"grid\">\n                <FormItem label=\"付费会员：\" label-for=\"isMember\">\n                  <!-- <Select\n                    v-model=\"userFrom.isMember\"\n                    placeholder=\"请选择付费会员\"\n                    element-id=\"isMember\"\n                    clearable\n                    @on-change=\"changeMember\"\n                  >\n                    <Option :value=\"1\">是</Option>\n                    <Option :value=\"0\">否</Option>\n                  </Select> -->\n                  <RadioGroup v-model=\"userFrom.isMember\" type=\"button\">\n                    <Radio label=\"\">\n                      <span>全部</span>\n                    </Radio>\n                    <Radio label=\"1\">\n                      <span>是</span>\n                    </Radio>\n                    <Radio label=\"0\">\n                      <span>否</span>\n                    </Radio>\n                  </RadioGroup>\n                </FormItem>\n              </Col>\n            </Col>\n            <Col span=\"18\">\n              <Col v-bind=\"grid\">\n                <FormItem label=\"访问情况：\" label-for=\"user_time_type\">\n                  <Select v-model=\"user_time_type\" placeholder=\"请选择访问情况\" element-id=\"user_time_type\" clearable>\n                    <Option value=\"\">全部</Option>\n                    <Option value=\"visitno\">时间段未访问</Option>\n                    <Option value=\"visit\">时间段访问过</Option>\n                    <Option value=\"add_time\">首次访问</Option>\n                  </Select>\n                </FormItem>\n              </Col>\n              <Col v-bind=\"grid\" v-if=\"user_time_type\">\n                <FormItem label=\"访问时间：\" label-for=\"user_time\">\n                  <!--<DatePicker clearable @on-change=\"onchangeTime\" v-model=\"timeVal\" :value=\"timeVal\"  format=\"yyyy/MM/dd\" type=\"daterange\" placement=\"bottom-end\" placeholder=\"选择时间\" v-width=\"'100%'\"></DatePicker>-->\n                  <DatePicker\n                    :editable=\"false\"\n                    @on-change=\"onchangeTime\"\n                    :value=\"timeVal\"\n                    format=\"yyyy/MM/dd\"\n                    type=\"datetimerange\"\n                    placement=\"bottom-start\"\n                    placeholder=\"请选择访问时间\"\n                    style=\"width: 300px\"\n                    class=\"mr20\"\n                    :options=\"options\"\n                  ></DatePicker>\n                </FormItem>\n              </Col>\n            </Col>\n            <Col span=\"18\">\n              <Col v-bind=\"grid\">\n                <FormItem label=\"地区：\" label-for=\"country\">\n                  <Select\n                    v-model=\"userFrom.country\"\n                    placeholder=\"请选择国家\"\n                    element-id=\"country\"\n                    clearable\n                    @on-change=\"changeCountry\"\n                  >\n                    <Option value=\"domestic\">中国</Option>\n                    <Option value=\"abroad\">外国</Option>\n                  </Select>\n                </FormItem>\n              </Col>\n              <Col v-bind=\"grid\" v-if=\"userFrom.country === 'domestic'\">\n                <FormItem label=\"省份：\">\n                  <Cascader :data=\"addresData\" :value=\"address\" v-model=\"address\" @on-change=\"handleChange\"></Cascader>\n                </FormItem>\n              </Col>\n            </Col>\n          </template>\n        </Row>\n        <Row v-if=\"collapse\">\n          <Col span=\"13\" class=\"ivu-text-right userFrom\">\n            <FormItem>\n              <Button type=\"primary\" icon=\"ios-search\" label=\"default\" class=\"mr15\" @click=\"userSearchs\">搜索</Button>\n              <Button class=\"ResetSearch\" @click=\"reset('userFrom')\">重置</Button>\n              <a class=\"ivu-ml-8 font14 ml10\" @click=\"collapse = !collapse\">\n                <template v-if=\"!collapse\"> 展开 <Icon type=\"ios-arrow-down\" /> </template>\n                <template v-else> 收起 <Icon type=\"ios-arrow-up\" /> </template>\n              </a>\n            </FormItem>\n          </Col>\n        </Row>\n      </Form>\n      <Divider dashed />\n      <Row type=\"flex\" justify=\"space-between\" class=\"mt20\">\n        <Col span=\"24\">\n          <Button v-auth=\"['admin-user-save']\" type=\"primary\" class=\"mr10\" @click=\"edit({ uid: 0 })\">添加用户</Button>\n          <Button v-auth=\"['admin-user-coupon']\" class=\"mr10\" @click=\"onSend\">发送优惠券</Button>\n          <Button\n            v-auth=\"['admin-wechat-news']\"\n            class=\"greens mr10\"\n            size=\"default\"\n            @click=\"onSendPic\"\n            v-if=\"userFrom.user_type === 'wechat'\"\n          >\n            <Icon type=\"md-list\"></Icon>\n            发送图文消息\n          </Button>\n          <Button v-auth=\"['admin-user-group_set']\" class=\"mr10\" @click=\"setGroup\">批量设置分组</Button>\n          <Button v-auth=\"['admin-user-set_label']\" class=\"mr10\" @click=\"setLabel\">批量设置标签</Button>\n          <Button class=\"mr10\" icon=\"ios-share-outline\" @click=\"exportList\">导出</Button>\n\n          <!-- <Button v-auth=\"['admin-user-synchro']\" class=\"mr20\" @click=\"synchro\">同步公众号用户</Button> -->\n        </Col>\n        <Col span=\"24\" class=\"userAlert\" v-if=\"selectionList.length\">\n          <Alert show-icon>\n            已选择<i class=\"userI\"> {{ selectionList.length }} </i>项</Alert\n          >\n        </Col>\n      </Row>\n      <Table\n        :columns=\"columns\"\n        :data=\"userLists\"\n        class=\"mt10\"\n        ref=\"table\"\n        highlight-row\n        :loading=\"loading\"\n        no-userFrom-text=\"暂无数据\"\n        no-filtered-userFrom-text=\"暂无筛选结果\"\n        @on-sort-change=\"sortChanged\"\n        @on-select=\"handleSelectRow\"\n        @on-select-cancel=\"handleCancelRow\"\n        @on-select-all=\"handleSelectAll\"\n        @on-select-all-cancel=\"handleSelectAll\"\n      >\n        <template slot-scope=\"{ row, index }\" slot=\"avatars\">\n          <div class=\"tabBox_img\" v-viewer>\n            <img v-lazy=\"row.avatar\" />\n          </div>\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"nickname\">\n          <div class=\"acea-row\">\n            <Icon type=\"md-male\" v-show=\"row.sex === '男'\" color=\"#2db7f5\" size=\"15\" class=\"mr5\" />\n            <Icon type=\"md-female\" v-show=\"row.sex === '女'\" color=\"#ed4014\" size=\"15\" class=\"mr5\" />\n            <div v-text=\"row.nickname\"></div>\n          </div>\n          <div v-if=\"row.is_del == 1\" style=\"color: red\">用户已注销</div>\n          <!-- <div v-show=\"row.vip_name\" class=\"vipName\">{{row.vip_name}}</div> -->\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"isMember\">\n          <div>{{ row.isMember ? '是' : '否' }}</div>\n        </template>\n        <!--                <template slot-scope=\"{ row, index }\" slot=\"status\">-->\n        <!--                    <i-switch v-model=\"row.status\" :value=\"row.status\" :true-value=\"1\" :false-value=\"0\" @on-change=\"onchangeIsShow(row)\" size=\"large\">-->\n        <!--                        <span slot=\"open\">显示</span>-->\n        <!--                        <span slot=\"close\">隐藏</span>-->\n        <!--                    </i-switch>-->\n        <!--                </template>-->\n        <template slot-scope=\"{ row, index }\" slot=\"action\">\n          <template v-if=\"row.is_del != 1\">\n            <a @click=\"userDetail(row)\">详情</a>\n\n            <Divider type=\"vertical\" />\n            <Dropdown @on-click=\"changeMenu(row, $event, index)\" :transfer=\"true\">\n              <a href=\"javascript:void(0)\">\n                更多\n                <Icon type=\"ios-arrow-down\"></Icon>\n              </a>\n              <DropdownMenu slot=\"list\">\n                <!-- <DropdownItem name=\"1\">编辑</DropdownItem> -->\n                <DropdownItem name=\"2\">积分余额</DropdownItem>\n                <DropdownItem name=\"3\">赠送会员</DropdownItem>\n                <!--                                <DropdownItem name=\"4\" v-if=\"row.vip_name\">清除等级</DropdownItem>-->\n                <DropdownItem name=\"5\">设置分组</DropdownItem>\n                <DropdownItem name=\"6\">设置标签</DropdownItem>\n                <DropdownItem name=\"7\">修改上级推广人</DropdownItem>\n                <DropdownItem name=\"8\" v-if=\"row.spread_uid\">清除上级推广人</DropdownItem>\n              </DropdownMenu>\n            </Dropdown>\n          </template>\n          <template v-else>\n            <div v-if=\"row.is_del == 1\" style=\"color: red\">已注销</div>\n          </template>\n        </template>\n      </Table>\n\n      <div class=\"acea-row row-right page\">\n        <Page\n          :total=\"total\"\n          :current=\"userFrom.page\"\n          show-elevator\n          show-total\n          @on-change=\"pageChange\"\n          :page-size=\"userFrom.limit\"\n        />\n      </div>\n    </Card>\n    <!-- 编辑表单 积分余额-->\n    <edit-from ref=\"edits\" :FromData=\"FromData\" @submitFail=\"submitFail\"></edit-from>\n    <!-- 发送优惠券-->\n    <send-from ref=\"sends\" :userIds=\"ids.toString()\"></send-from>\n    <!-- 会员详情-->\n    <user-details ref=\"userDetails\"></user-details>\n    <!--发送图文消息 -->\n    <Modal v-model=\"modal13\" scrollable title=\"发送消息\" width=\"1200\" height=\"800\" footer-hide class=\"modelBox\">\n      <news-category\n        v-if=\"modal13\"\n        :isShowSend=\"isShowSend\"\n        :userIds=\"ids.toString()\"\n        :scrollerHeight=\"scrollerHeight\"\n        :contentTop=\"contentTop\"\n        :contentWidth=\"contentWidth\"\n        :maxCols=\"maxCols\"\n      ></news-category>\n    </Modal>\n    <!--修改推广人-->\n    <Modal v-model=\"promoterShow\" scrollable title=\"修改推广人\" class=\"order_box\" :closable=\"false\">\n      <Form ref=\"formInline\" :model=\"formInline\" :label-width=\"100\" @submit.native.prevent>\n        <FormItem v-if=\"formInline\" label=\"选择推广人：\" prop=\"image\">\n          <div class=\"picBox\" @click=\"customer\">\n            <div class=\"pictrue\" v-if=\"formInline.image\">\n              <img v-lazy=\"formInline.image\" />\n            </div>\n            <div class=\"upLoad acea-row row-center-wrapper\" v-else>\n              <Icon type=\"md-person\" size=\"26\" />\n            </div>\n          </div>\n        </FormItem>\n      </Form>\n      <div slot=\"footer\">\n        <Button type=\"primary\" @click=\"putSend('formInline')\">提交</Button>\n        <Button @click=\"cancel('formInline')\">取消</Button>\n      </div>\n    </Modal>\n    <Modal v-model=\"customerShow\" scrollable title=\"请选择商城用户\" :closable=\"false\" width=\"50%\">\n      <customerInfo v-if=\"customerShow\" @imageObject=\"imageObject\"></customerInfo>\n    </Modal>\n    <Modal v-model=\"labelShow\" scrollable title=\"请选择用户标签\" :closable=\"false\" width=\"500\" :footer-hide=\"true\">\n      <userLabel\n        v-if=\"labelShow\"\n        :uid=\"labelActive.uid\"\n        :only_get=\"!labelActive.uid\"\n        @close=\"labelClose\"\n        @activeData=\"activeData\"\n        @onceGetList=\"onceGetList\"\n      ></userLabel>\n    </Modal>\n    <Drawer :closable=\"false\" width=\"700\" v-model=\"modals\" title=\"用户信息填写\">\n      <userEdit ref=\"userEdit\" v-if=\"modals\" :userData=\"userData\"></userEdit>\n      <div class=\"demo-drawer-footer\">\n        <Button style=\"margin-right: 8px\" @click=\"modals = false\">取消</Button>\n        <Button type=\"primary\" @click=\"setUser\">提交</Button>\n      </div>\n    </Drawer>\n    <!-- 用户标签 -->\n    <Modal\n      v-model=\"selectLabelShow\"\n      scrollable\n      title=\"请选择用户标签\"\n      :closable=\"false\"\n      width=\"500\"\n      :footer-hide=\"true\"\n      :mask-closable=\"false\"\n    >\n      <userLabel\n        v-if=\"selectLabelShow\"\n        :uid=\"0\"\n        ref=\"userLabel\"\n        :only_get=\"true\"\n        @activeData=\"activeSelectData\"\n        @close=\"labelClose\"\n      ></userLabel>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport userLabel from '@/components/userLabel';\nimport { mapState } from 'vuex';\nimport expandRow from './tableExpand.vue';\nimport userEdit from './handle/userEdit.vue';\nimport {\n  userList,\n  getUserData,\n  isShowApi,\n  editOtherApi,\n  giveLevelApi,\n  userSetGroup,\n  userGroupApi,\n  levelListApi,\n  userSetLabelApi,\n  userLabelApi,\n  userSynchro,\n  getUserSaveForm,\n  giveLevelTimeApi,\n  getUserInfo,\n  setUser,\n  editUser,\n  saveSetLabel,\n} from '@/api/user';\nimport { agentSpreadApi } from '@/api/agent';\nimport { exportUserList } from '@/api/export';\nimport editFrom from '../../../components/from/from';\nimport sendFrom from '@/components/sendCoupons/index';\nimport userDetails from './handle/userDetails';\nimport newsCategory from '@/components/newsCategory/index';\n// import city from '@/utils/city';\nimport customerInfo from '@/components/customerInfo';\nimport { cityList } from '@/api/app';\n\nexport default {\n  name: 'user_list',\n  components: {\n    expandRow,\n    editFrom,\n    sendFrom,\n    userDetails,\n    newsCategory,\n    customerInfo,\n    userLabel,\n    userEdit,\n  },\n  data() {\n    return {\n      dataLabel: [],\n      selectDataLabel: [],\n      userData: {},\n      modals: false,\n      selectLabelShow: false,\n      labelShow: false,\n      customerShow: false,\n      promoterShow: false,\n      labelActive: {\n        uid: 0,\n      },\n      formInline: {\n        uid: 0,\n        spread_uid: 0,\n        image: '',\n      },\n      options: {\n        shortcuts: [\n          {\n            text: '今天',\n            value() {\n              const end = new Date();\n              const start = new Date();\n              start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate()));\n              return [start, end];\n            },\n          },\n          {\n            text: '昨天',\n            value() {\n              const end = new Date();\n              const start = new Date();\n              start.setTime(\n                start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() - 1)),\n              );\n              end.setTime(\n                end.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() - 1)),\n              );\n              return [start, end];\n            },\n          },\n          {\n            text: '最近7天',\n            value() {\n              const end = new Date();\n              const start = new Date();\n              start.setTime(\n                start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() - 6)),\n              );\n              return [start, end];\n            },\n          },\n          {\n            text: '最近30天',\n            value() {\n              const end = new Date();\n              const start = new Date();\n              start.setTime(\n                start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() - 29)),\n              );\n              return [start, end];\n            },\n          },\n          {\n            text: '本月',\n            value() {\n              const end = new Date();\n              const start = new Date();\n              start.setTime(start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), 1)));\n              return [start, end];\n            },\n          },\n          {\n            text: '本年',\n            value() {\n              const end = new Date();\n              const start = new Date();\n              start.setTime(start.setTime(new Date(new Date().getFullYear(), 0, 1)));\n              return [start, end];\n            },\n          },\n        ],\n      },\n      collapse: false,\n      headeNum: [\n        { type: '', name: '全部' },\n        { type: 'wechat', name: '微信公众号' },\n        { type: 'routine', name: '微信小程序' },\n        { type: 'h5', name: 'H5' },\n        { type: 'pc', name: 'PC' },\n        { type: 'app', name: 'APP' },\n      ],\n      address: [],\n      addresData: [],\n      isShowSend: true,\n      modal13: false,\n      maxCols: 4,\n      scrollerHeight: '600',\n      contentTop: '130',\n      contentWidth: '98%',\n      grid: {\n        xl: 8,\n        lg: 12,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      grid2: {\n        xl: 18,\n        lg: 16,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      loading: false,\n      total: 0,\n      userFrom: {\n        label_id: '',\n        user_type: '',\n        status: '',\n        sex: '',\n        is_promoter: '',\n        country: '',\n        isMember: '',\n        pay_count: '',\n        user_time_type: '',\n        user_time: '',\n        nickname: '',\n        province: '',\n        city: '',\n        page: 1,\n        limit: 15,\n        level: '',\n        group_id: '',\n        field_key: '',\n      },\n      field_key: '',\n      level: '',\n      group_id: '',\n      label_id: '',\n      user_time_type: '',\n      pay_count: '',\n      columns: [\n        {\n          type: 'expand',\n          width: 40,\n          render: (h, params) => {\n            return h(expandRow, {\n              props: {\n                row: params.row,\n              },\n            });\n          },\n        },\n        {\n          type: 'selection',\n          width: 60,\n          align: 'center',\n        },\n        {\n          title: '用户ID',\n          key: 'uid',\n          width: 80,\n        },\n        {\n          title: '头像',\n          slot: 'avatars',\n          minWidth: 60,\n        },\n        {\n          title: '姓名',\n          slot: 'nickname',\n          minWidth: 150,\n        },\n        {\n          title: '付费会员',\n          slot: 'isMember',\n          minWidth: 90,\n        },\n        {\n          title: '用户等级',\n          key: 'level',\n          minWidth: 90,\n        },\n        {\n          title: '分组',\n          key: 'group_id',\n          minWidth: 100,\n        },\n        {\n          title: '手机号',\n          key: 'phone',\n          minWidth: 100,\n        },\n        {\n          title: '用户类型',\n          key: 'user_type',\n          minWidth: 100,\n        },\n        {\n          title: '余额',\n          key: 'now_money',\n          sortable: 'custom',\n          minWidth: 100,\n        },\n        // {\n        //     title: '状态',\n        //     slot: 'status',\n        //     minWidth: 100\n        // },\n        {\n          title: '操作',\n          slot: 'action',\n          fixed: 'right',\n          minWidth: 120,\n        },\n      ],\n      userLists: [],\n      FromData: null,\n      selectionList: [],\n      user_ids: '',\n      selectedData: [],\n      timeVal: [],\n      groupList: [],\n      levelList: [],\n      labelFrom: {\n        page: 1,\n        limit: '',\n      },\n      labelLists: [],\n      selectedIds: new Set(), //选中合并项的id\n      ids: [],\n    };\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : 100;\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  created() {\n    this.getList();\n    this.getCityList();\n  },\n  mounted() {\n    this.userGroup();\n    this.levelLists();\n    // this.groupLists();\n  },\n  methods: {\n    getCityList() {\n      cityList().then((res) => {\n        this.addresData = res.data;\n      });\n    },\n    setUser() {\n      let data = this.$refs.userEdit.formItem;\n      let ids = [];\n      this.$refs.userEdit.dataLabel.map((i) => {\n        ids.push(i.id);\n      });\n      data.label_id = ids;\n      // if (!data.real_name) return this.$Message.warning(\"请输入真实姓名\");\n      // if (!data.phone) return this.$Message.warning(\"请输入手机号\");\n      // if (!data.pwd) return this.$Message.warning(\"请输入密码\");\n      // if (!data.true_pwd) return this.$Message.warning(\"请输入确认密码\");\n      if (data.uid) {\n        editUser(data)\n          .then((res) => {\n            this.modals = false;\n            this.$Message.success(res.msg);\n            this.getList();\n          })\n          .catch((err) => {\n            this.$Message.error(err.msg);\n          });\n      } else {\n        setUser(data)\n          .then((res) => {\n            this.modals = false;\n            this.$Message.success(res.msg);\n            this.getList();\n          })\n          .catch((err) => {\n            this.$Message.error(err.msg);\n          });\n      }\n    },\n    onceGetList() {\n      this.labelActive.uid = 0;\n      this.getList();\n    },\n    // 标签弹窗关闭\n    labelClose() {\n      this.labelActive.uid = 0;\n      this.labelShow = false;\n      this.selectLabelShow = false;\n    },\n    // 提交\n    putSend(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          if (!this.formInline.spread_uid) {\n            return this.$Message.error('请上传用户');\n          }\n          agentSpreadApi(this.formInline)\n            .then((res) => {\n              this.promoterShow = false;\n              this.$Message.success(res.msg);\n              this.getList();\n              this.$refs[name].resetFields();\n            })\n            .catch((res) => {\n              this.$Message.error(res.msg);\n            });\n        }\n      });\n    },\n\n    save() {\n      this.modals = true;\n\n      // this.$modalForm(getUserSaveForm())\n      //   .then(() => {\n      //     this.userFrom.page = 1;\n      //     this.getList();\n      //   })\n      //   .catch((res) => {\n      //     this.$Message.error(res.msg);\n      //   });\n    },\n    synchro() {\n      userSynchro()\n        .then((res) => {\n          this.$Message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    // 分组列表\n    groupLists() {\n      this.loading = true;\n      userLabelApi(this.labelFrom)\n        .then(async (res) => {\n          let data = res.data;\n          this.labelLists = data.list;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    onClickTab(type) {\n      this.userFrom.page = 1;\n      this.userFrom.user_type = type;\n      this.getList();\n    },\n    userGroup() {\n      let data = {\n        page: 1,\n        limit: '',\n      };\n      userGroupApi(data).then((res) => {\n        this.groupList = res.data.list;\n      });\n    },\n    levelLists() {\n      let data = {\n        page: 1,\n        limit: '',\n        title: '',\n        is_show: 1,\n      };\n      levelListApi(data).then((res) => {\n        this.levelList = res.data.list;\n      });\n    },\n    // 批量设置分组；\n    setGroup() {\n      if (this.ids.length === 0) {\n        this.$Message.warning('请选择要设置分组的用户');\n      } else {\n        let uids = { uids: this.ids };\n        this.$modalForm(userSetGroup(uids)).then(() => this.getList());\n      }\n    },\n    // 批量设置标签；\n    setLabel() {\n      if (this.ids.length === 0) {\n        this.$Message.warning('请选择要设置标签的用户');\n      } else {\n        let uids = { uids: this.ids };\n        this.labelActive.uid = 0;\n        this.labelShow = true;\n        // this.$modalForm(userSetLabelApi(uids)).then(() =>\n        //   this.$refs.sends.getList()\n        // );\n      }\n    },\n    activeSelectData(data) {\n      // let labels = [];\n      // if (!data.length) return;\n      // data.map((i) => {\n      //   labels.push(i.id);\n      // });\n      this.selectLabelShow = false;\n      this.selectDataLabel = data || [];\n    },\n    // 批量设置标签\n    activeData(data) {\n      let labels = [];\n      if (!data.length) return;\n      data.map((i) => {\n        labels.push(i.id);\n      });\n      saveSetLabel({\n        uids: this.ids.join(','),\n        label_id: labels,\n      }).then((res) => {\n        this.labelShow = false;\n        this.selectedIds = new Set();\n        this.getList();\n        this.$Message.success(res.msg);\n      });\n    },\n    //是否为付费会员；\n    changeMember() {\n      this.userFrom.page = 1;\n      this.getList();\n    },\n    // 选择国家\n    changeCountry() {\n      if (this.userFrom.country === 'abroad' || !this.userFrom.country) {\n        this.selectedData = [];\n        this.userFrom.province = '';\n        this.userFrom.city = '';\n        this.address = [];\n      }\n    },\n    // 选择地址\n    handleChange(value, selectedData) {\n      this.selectedData = selectedData.map((o) => o.label);\n      this.userFrom.province = this.selectedData[0];\n      this.userFrom.city = this.selectedData[1];\n    },\n    // 具体日期\n    onchangeTime(e) {\n      this.timeVal = e;\n      this.userFrom.user_time = this.timeVal.join('-');\n    },\n    userDetail(row) {\n      this.$refs.userDetails.modals = true;\n      this.$refs.userDetails.getDetails(row.uid);\n    },\n    // 操作\n    changeMenu(row, name, index) {\n      let uid = [];\n      uid.push(row.uid);\n      let uids = { uids: uid };\n      switch (name) {\n        case '1':\n          this.edit(row);\n          break;\n        case '2':\n          this.getOtherFrom(row.uid);\n          break;\n        case '3':\n          this.giveLevelTime(row.uid);\n          break;\n        case '4':\n          this.del(row, '清除 【 ' + this.tenText(row.nickname) + ' 】的会员等级', index, 'user');\n          break;\n        case '5':\n          this.$modalForm(userSetGroup(uids)).then(() => this.getList());\n          break;\n        case '6':\n          this.openLabel(row);\n          break;\n        case '7':\n          this.editS(row);\n          break;\n        default:\n          this.del(row, '解除【 ' + this.tenText(row.nickname) + ' 】的上级推广人', index, 'tuiguang');\n      }\n    },\n    tenText(str) {\n      if (str.length > 10) {\n        //如果字符长度超过10，后面的字符就变成...可自行调整长度和代替字符\n        str = str.substr(0, 10) + '...'; //截取从第一个字符开始，往后取10个字符，剩余的用...代替\n      }\n      return str;\n    },\n    openLabel(row) {\n      this.labelShow = true;\n      this.labelActive.uid = row.uid;\n    },\n    openSelectLabel() {\n      this.selectLabelShow = true;\n    },\n    editS(row) {\n      this.promoterShow = true;\n      this.formInline.uid = row.uid;\n    },\n    customer() {\n      this.customerShow = true;\n    },\n    imageObject(e) {\n      this.customerShow = false;\n      this.formInline.spread_uid = e.uid;\n      this.formInline.image = e.image;\n    },\n    cancel(name) {\n      this.promoterShow = false;\n      this.$refs[name].resetFields();\n    },\n    // 赠送会员等级\n    giveLevel(id) {\n      this.$modalForm(giveLevelApi(id)).then(() => this.getList(1));\n\n      // giveLevelApi(id)\n      //   .then(async (res) => {\n      //     if (res.data.status === false) {\n      //       return this.$authLapse(res.data);\n      //     }\n\n      //     this.FromData = res.data;\n      //     this.$refs.edits.modals = true;\n      //   })\n      //   .catch((res) => {\n      //     this.$Message.error(res.msg);\n      //   });\n    },\n    // 赠送会员等级\n    giveLevelTime(id) {\n      this.$modalForm(giveLevelTimeApi(id)).then(() => this.getList(1));\n\n      // giveLevelTimeApi(id)\n      //   .then(async (res) => {\n      //     if (res.data.status === false) {\n      //       return this.$authLapse(res.data);\n      //     }\n      //     this.FromData = res.data;\n      //     this.$refs.edits.modals = true;\n      //   })\n      //   .catch((res) => {\n      //     this.$Message.error(res.msg);\n      //   });\n    },\n    // 删除\n    del(row, tit, num, name) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: name === 'user' ? `user/del_level/${row.uid}` : `agent/stair/delete_spread/${row.uid}`,\n        method: name === 'user' ? 'DELETE' : 'PUT',\n        ids: '',\n        width: 600,\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$Message.success(res.msg);\n          this.getList();\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    // 清除会员删除成功\n    submitModel() {\n      this.getList();\n    },\n    // 会员列表\n    getList() {\n      if (this.selectDataLabel.length) {\n        let activeIds = [];\n        this.selectDataLabel.forEach((item) => {\n          activeIds.push(item.id);\n        });\n        this.userFrom.label_id = activeIds.join(',');\n      }\n      this.userFrom.user_type = this.userFrom.user_type || '';\n      this.userFrom.status = this.userFrom.status || '';\n      this.userFrom.sex = this.userFrom.sex || '';\n      this.userFrom.is_promoter = this.userFrom.is_promoter || '';\n      this.userFrom.country = this.userFrom.country || '';\n      this.userFrom.pay_count = this.pay_count === 'all' ? '' : this.pay_count;\n      this.userFrom.user_time_type = this.user_time_type === 'all' ? '' : this.user_time_type;\n      this.userFrom.field_key = this.field_key === 'all' ? '' : this.field_key;\n      this.userFrom.level = this.level === 'all' ? '' : this.level;\n      this.userFrom.group_id = this.group_id === 'all' ? '' : this.group_id;\n      this.loading = true;\n      userList(this.userFrom)\n        .then(async (res) => {\n          let data = res.data;\n          this.userLists = data.list;\n          this.total = data.count;\n          this.loading = false;\n          this.$nextTick(() => {\n            this.setChecked();\n          });\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    // 用户导出\n    async exportList() {\n      if (this.selectDataLabel.length) {\n        let activeIds = [];\n        this.selectDataLabel.forEach((item) => {\n          activeIds.push(item.id);\n        });\n        this.userFrom.label_id = activeIds.join(',');\n      }\n      if (this.ids.length) {\n        this.userFrom.ids = this.ids;\n      }\n      this.userFrom.user_type = this.userFrom.user_type || '';\n      this.userFrom.status = this.userFrom.status || '';\n      this.userFrom.sex = this.userFrom.sex || '';\n      this.userFrom.is_promoter = this.userFrom.is_promoter || '';\n      this.userFrom.country = this.userFrom.country || '';\n      this.userFrom.pay_count = this.pay_count === 'all' ? '' : this.pay_count;\n      this.userFrom.user_time_type = this.user_time_type === 'all' ? '' : this.user_time_type;\n      this.userFrom.field_key = this.field_key === 'all' ? '' : this.field_key;\n      this.userFrom.level = this.level === 'all' ? '' : this.level;\n      this.userFrom.group_id = this.group_id === 'all' ? '' : this.group_id;\n      let [th, filekey, data, fileName] = [[], [], [], ''];\n      //   let fileName = \"\";\n      let excelData = JSON.parse(JSON.stringify(this.userFrom));\n      excelData.page = 1;\n      for (let i = 0; i < excelData.page + 1; i++) {\n        let lebData = await this.getExcelData(excelData);\n        if (!fileName) fileName = lebData.filename;\n        if (!filekey.length) {\n          filekey = lebData.fileKey;\n        }\n        if (!th.length) th = lebData.header;\n        if (lebData.export.length) {\n          data = data.concat(lebData.export);\n          excelData.page++;\n        } else {\n          this.$exportExcel(th, filekey, fileName, data);\n          return;\n        }\n      }\n    },\n    getExcelData(excelData) {\n      return new Promise((resolve, reject) => {\n        exportUserList(excelData).then((res) => {\n          resolve(res.data);\n        });\n      });\n    },\n    pageChange(index) {\n      this.selectionList = [];\n      this.userFrom.page = index;\n      this.getList();\n    },\n    // 搜索\n    userSearchs() {\n      this.userFrom.page = 1;\n      this.getList();\n    },\n    // 重置\n    reset(name) {\n      this.userFrom = {\n        user_type: this.userFrom.user_type,\n        status: '',\n        sex: '',\n        is_promoter: '',\n        country: '',\n        pay_count: '',\n        user_time_type: '',\n        user_time: '',\n        nickname: '',\n        field_key: '',\n        level: '',\n        group_id: '',\n        label_id: '',\n        page: 1, // 当前页\n        limit: 20, // 每页显示条数\n      };\n      this.field_key = '';\n      this.level = '';\n      this.group_id = '';\n      this.dataLabel = [];\n      this.selectDataLabel = [];\n      this.user_time_type = '';\n      this.pay_count = '';\n      this.timeVal = [];\n      this.selectedIds = new Set();\n      this.getList();\n    },\n    // 获取编辑表单数据\n    getUserFrom(id) {\n      getUserInfo(id)\n        .then(async (res) => {\n          this.modals = true;\n          this.userData = res.data;\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    // 获取积分余额表单\n    getOtherFrom(id) {\n      this.$modalForm(editOtherApi(id)).then(() => this.getList(1));\n    },\n    // 修改状态\n    onchangeIsShow(row) {\n      let data = {\n        id: row.uid,\n        status: row.status,\n      };\n      isShowApi(data)\n        .then(async (res) => {\n          this.$Message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    // 点击发送优惠券\n    onSend() {\n      if (this.ids.length === 0) {\n        this.$Message.warning('请选择要发送优惠券的用户');\n      } else {\n        this.$refs.sends.modals = true;\n        this.$refs.sends.getList();\n      }\n    },\n    // 发送图文消息\n    onSendPic() {\n      if (this.ids.length === 0) {\n        this.$Message.warning('请选择要发送图文消息的用户');\n      } else {\n        this.modal13 = true;\n      }\n    },\n    // 编辑\n    edit(row) {\n      this.getUserFrom(row.uid);\n    },\n    // 修改成功\n    submitFail() {\n      // this.getList();\n    },\n    // 排序\n    sortChanged(e) {\n      this.userFrom[e.key] = e.order;\n      this.getList();\n    },\n    //全选和取消全选时触发\n    handleSelectAll(selection) {\n      if (selection.length === 0) {\n        //获取table的数据；\n        let data = this.$refs.table.data;\n        data.forEach((item) => {\n          if (this.selectedIds.has(item.uid)) {\n            this.selectedIds.delete(item.uid);\n          }\n        });\n      } else {\n        selection.forEach((item) => {\n          this.selectedIds.add(item.uid);\n        });\n      }\n      this.$nextTick(() => {\n        //确保dom加载完毕\n        this.setChecked();\n      });\n    },\n    //  选中某一行\n    handleSelectRow(selection, row) {\n      this.selectedIds.add(row.uid);\n      this.$nextTick(() => {\n        //确保dom加载完毕\n        this.setChecked();\n      });\n    },\n    //  取消某一行\n    handleCancelRow(selection, row) {\n      this.selectedIds.delete(row.uid);\n      this.$nextTick(() => {\n        //确保dom加载完毕\n        this.setChecked();\n      });\n    },\n    setChecked() {\n      //将new Set()转化为数组\n      this.ids = [...this.selectedIds];\n      // 找到绑定的table的ref对应的dom，找到table的objData对象，objData保存的是当前页的数据\n      let objData = this.$refs.table.objData;\n      for (let index in objData) {\n        if (this.selectedIds.has(objData[index].uid)) {\n          objData[index]._isChecked = true;\n        }\n      }\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"stylus\">\n.picBox {\n  display: inline-block;\n  cursor: pointer;\n\n  .upLoad {\n    width: 58px;\n    height: 58px;\n    line-height: 58px;\n    border: 1px dotted rgba(0, 0, 0, 0.1);\n    border-radius: 4px;\n    background: rgba(0, 0, 0, 0.02);\n  }\n\n  .pictrue {\n    width: 60px;\n    height: 60px;\n    border: 1px dotted rgba(0, 0, 0, 0.1);\n    margin-right: 10px;\n\n    img {\n      width: 100%;\n      height: 100%;\n    }\n  }\n}\n\n.userFrom {\n  >>> .ivu-form-item-content {\n    margin-left: 0px !important;\n  }\n}\n\n.userAlert {\n  margin-top: 20px;\n}\n\n.userI {\n  color: #1890FF;\n  font-style: normal;\n}\n\nimg {\n  height: 36px;\n  display: block;\n}\n\n.tabBox_img {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  img {\n    width: 100%;\n    height: 100%;\n  }\n}\n\n.tabBox_tit {\n  width: 60%;\n  font-size: 12px !important;\n  margin: 0 2px 0 10px;\n  letter-spacing: 1px;\n  padding: 5px 0;\n  box-sizing: border-box;\n}\n\n.modelBox {\n  >>> .ivu-modal-body {\n    padding: 0 16px 16px 16px !important;\n  }\n}\n\n.vipName {\n  color: #dab176;\n}\n\n.listbox {\n  >>>.ivu-divider-horizontal {\n    margin: 0 !important;\n  }\n}\n\n.labelInput {\n  border: 1px solid #dcdee2;\n  padding: 0 6px;\n  border-radius: 5px;\n  min-height: 30px;\n  cursor: pointer;\n\n  .span {\n    color: #c5c8ce;\n  }\n\n  .ivu-icon-ios-arrow-down {\n    font-size: 14px;\n    color: #808695;\n  }\n}\n\n.demo-drawer-footer {\n  width: 100%;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  border-top: 1px solid #e8e8e8;\n  padding: 10px 16px;\n  text-align: right;\n  background: #fff;\n}\n</style>\n"]}]}