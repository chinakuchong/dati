{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/marketing/lottery/recordingList.vue?vue&type=style&index=0&id=f7d26428&scoped=true&lang=stylus&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/marketing/lottery/recordingList.vue","mtime":1689324015224},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/@vue/cli-service/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoudGFiQm94X2ltZyB7CiAgd2lkdGg6IDM2cHg7CiAgaGVpZ2h0OiAzNnB4OwogIGJvcmRlci1yYWRpdXM6IDRweDsKICBjdXJzb3I6IHBvaW50ZXI7CgogIGltZyB7CiAgICB3aWR0aDogMTAwJTsKICAgIGhlaWdodDogMTAwJTsKICB9Cn0KCi5wcml6ZSB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwp9CgoucHJpemUgaW1nIHsKICB3aWR0aDogMzZweDsKICBoZWlnaHQ6IDM2cHg7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIGN1cnNvcjogcG9pbnRlcjsKICBtYXJnaW4tcmlnaHQ6IDVweDsKfQoKLnRyaXBzIHsKICBjb2xvcjogI2NjYzsKfQo="},{"version":3,"sources":["recordingList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6ZA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"recordingList.vue","sourceRoot":"src/pages/marketing/lottery","sourcesContent":["<template>\n  <div>\n    <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n      <Form\n        ref=\"tableFrom\"\n        :model=\"tableFrom\"\n        :label-width=\"labelWidth\"\n        :label-position=\"labelPosition\"\n        @submit.native.prevent\n      >\n        <Row type=\"flex\" :gutter=\"24\">\n          <Col>\n            <FormItem label=\"活动类型：\" clearable>\n              <RadioGroup v-model=\"tableFrom.factor\" type=\"button\" @on-change=\"selectChangeFactor()\" class=\"mr\">\n                <Radio :label=\"1\">积分抽取</Radio>\n                <Radio :label=\"3\">订单支付</Radio>\n                <Radio :label=\"4\">订单评价</Radio>\n              </RadioGroup>\n            </FormItem>\n          </Col>\n          <Col span=\"24\">\n            <FormItem label=\"时间选择：\">\n              <RadioGroup v-model=\"tableFrom.data\" type=\"button\" @on-change=\"selectChange(tableFrom.data)\" class=\"mr\">\n                <Radio :label=\"item.val\" v-for=\"(item, i) in fromList.fromTxt\" :key=\"i\">{{ item.text }}</Radio>\n              </RadioGroup>\n              <DatePicker\n                :editable=\"false\"\n                @on-change=\"onchangeTime\"\n                :value=\"timeVal\"\n                format=\"yyyy/MM/dd\"\n                type=\"daterange\"\n                placement=\"bottom-end\"\n                placeholder=\"自定义时间\"\n                style=\"width: 200px\"\n              ></DatePicker>\n            </FormItem>\n          </Col>\n          <Col span=\"24\">\n            <FormItem label=\"奖品类型：\">\n              <RadioGroup v-model=\"tableFrom.type\" type=\"button\" @on-change=\"selectType()\" class=\"mr\">\n                <Radio :label=\"item.val\" v-for=\"(item, i) in typeList\" :key=\"i\">{{ item.text }}</Radio>\n              </RadioGroup>\n            </FormItem>\n          </Col>\n          <!-- <Col v-bind=\"grid\">\n            <FormItem label=\"领取状态：\" clearable>\n              <Select\n                v-model=\"tableFrom.is_receive\"\n                placeholder=\"请选择\"\n                clearable\n                @on-change=\"userSearchs\"\n              >\n                <Option value=\"0\">待发货</Option>\n                <Option value=\"1\">已发货</Option>\n              </Select>\n            </FormItem>\n          </Col>\n          <Col v-bind=\"grid\">\n            <FormItem label=\"处理状态：\" clearable>\n              <Select\n                v-model=\"tableFrom.is_deliver\"\n                placeholder=\"请选择\"\n                clearable\n                @on-change=\"userSearchs\"\n              >\n                <Option value=\"0\">未处理</Option>\n                <Option value=\"1\">已处理</Option>\n              </Select>\n            </FormItem>\n          </Col> -->\n          <Col v-bind=\"grid\">\n            <FormItem label=\"搜索用户：\" label-for=\"store_name\">\n              <Input\n                search\n                enter-button\n                placeholder=\"请输入用户信息\"\n                v-model=\"tableFrom.keyword\"\n                @on-search=\"userSearchs\"\n              />\n            </FormItem>\n          </Col>\n        </Row>\n      </Form>\n      <Table\n        :columns=\"columns1\"\n        :data=\"tableList\"\n        :loading=\"loading\"\n        highlight-row\n        no-userFrom-text=\"暂无数据\"\n        no-filtered-userFrom-text=\"暂无筛选结果\"\n      >\n        <template slot-scope=\"{ row, index }\" slot=\"is_fail\">\n          <Icon type=\"md-checkmark\" v-if=\"row.is_fail === 1\" color=\"#0092DC\" size=\"14\" />\n          <Icon type=\"md-close\" v-else color=\"#ed5565\" size=\"14\" />\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"user\">\n          <span>{{ row.user.nickname }} </span>\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"mark\">\n          <span>{{ row.deliver_info.mark }}</span>\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"receive_info\">\n          <div v-if=\"row.receive_info.name\">\n            <div>姓名：{{ row.receive_info.name }}</div>\n            <div>电话：{{ row.receive_info.phone }}</div>\n            <div>地址：{{ row.receive_info.address }}</div>\n            <div v-if=\"row.receive_info.mark\">备注：{{ row.receive_info.mark }}</div>\n          </div>\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"prize\">\n          <div class=\"prize\">\n            <img :src=\"row.prize.image\" alt=\"\" />\n            <span>{{ row.prize.name }}</span>\n          </div>\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"action\">\n          <a @click=\"deliver(row, 1)\" v-if=\"row.type == 6 && row.is_deliver === 0\">发货</a>\n          <a v-else-if=\"row.type == 6 && row.is_deliver === 1\" @click=\"isDeliver(row)\">配送信息</a>\n          <Divider type=\"vertical\" v-if=\"row.type == 6\" />\n          <a @click=\"deliver(row, 2)\">备注</a>\n        </template>\n      </Table>\n      <div class=\"acea-row row-right page\">\n        <Page\n          :total=\"total\"\n          :current=\"tableFrom.page\"\n          show-elevator\n          show-total\n          @on-change=\"pageChange\"\n          :page-size=\"tableFrom.limit\"\n        />\n      </div>\n    </Card>\n    <!-- 发货-->\n    <Modal\n      v-model=\"shipModel\"\n      width=\"40%\"\n      scrollable\n      closable\n      footer-hide\n      :title=\"!modelTitle ? (modelType === 1 ? '发货' : '备注') : modelTitle\"\n      :mask-closable=\"false\"\n      :z-index=\"1\"\n    >\n      <Form\n        v-model=\"shipModel\"\n        :ref=\"modelType === 1 ? 'shipForm' : 'markForm'\"\n        :model=\"modelType === 1 ? shipForm : markForm\"\n        :rules=\"modelType === 1 ? ruleShip : ruleMark\"\n        :label-width=\"80\"\n      >\n        <FormItem v-if=\"modelType === 1\" label=\"快递公司\" prop=\"deliver_name\">\n          <Select v-model=\"shipForm.deliver_name\">\n            <Option v-for=\"item in locationList\" :value=\"item.value\" :key=\"item.id\">{{ item.value }}</Option>\n          </Select>\n        </FormItem>\n        <FormItem v-if=\"modelType === 1\" label=\"快递单号\" prop=\"deliver_number\">\n          <Input v-model=\"shipForm.deliver_number\" placeholder=\"请输入快递单号\"></Input>\n          <div class=\"trips\" v-if=\"shipForm.deliver_name == '顺丰速运'\">\n            <p>顺丰请输入单号 :收件人或寄件人手机号后四位</p>\n            <p>例如：SF000000000000:3941</p>\n          </div>\n        </FormItem>\n        <FormItem v-if=\"modelType === 2\" label=\"备注\">\n          <Input v-model=\"markForm.mark\" placeholder=\"请输入备注\"></Input>\n        </FormItem>\n        <FormItem>\n          <Button type=\"primary\" @click=\"ok(modelType === 1 ? 'shipForm' : 'markForm')\">提交</Button>\n          <Button @click=\"cancel('formValidate')\" style=\"margin-left: 8px\">关闭</Button>\n        </FormItem></Form\n      >\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { lotteryRecordList, lotteryRecordDeliver } from '@/api/lottery';\nimport { formatDate } from '@/utils/validate';\nimport { getExpressData } from '@/api/order';\nimport { ruleShip, ruleMark } from './formRule/ruleShip';\nexport default {\n  name: 'lotteryRecordList',\n  filters: {\n    formatDate(time) {\n      if (time !== 0) {\n        let date = new Date(time * 1000);\n        return formatDate(date, 'yyyy-MM-dd hh:mm');\n      }\n    },\n  },\n  data() {\n    return {\n      shipModel: false,\n      loading: false,\n      locationList: [],\n      shipForm: {\n        id: '',\n        deliver_name: '',\n        deliver_number: null,\n      },\n      markForm: {\n        id: '',\n        mark: '',\n      },\n      ruleShip: ruleShip,\n      ruleMark: ruleMark,\n      fromList: {\n        title: '选择时间',\n        fromTxt: [\n          { text: '全部', val: '' },\n          { text: '今天', val: 'today' },\n          { text: '昨天', val: 'yesterday' },\n          { text: '最近7天', val: 'lately7' },\n          { text: '最近30天', val: 'lately30' },\n          { text: '本月', val: 'month' },\n          { text: '本年', val: 'year' },\n        ],\n      },\n      typeList: [\n        { text: '全部', val: '' },\n        { text: '未中奖', val: '1' },\n        { text: '积分', val: '2' },\n        { text: '余额', val: '3' },\n        { text: '红包', val: '4' },\n        { text: '优惠券', val: '5' },\n        { text: '商品', val: '6' },\n      ],\n      columns1: [\n        {\n          title: 'ID',\n          key: 'id',\n          width: 80,\n        },\n        {\n          title: '用户信息',\n          slot: 'user',\n          minWidth: 90,\n        },\n        {\n          title: '奖品信息',\n          slot: 'prize',\n          minWidth: 130,\n        },\n        {\n          title: '抽奖时间',\n          key: 'add_time',\n          minWidth: 100,\n        },\n        {\n          title: '收货信息',\n          slot: 'receive_info',\n          minWidth: 100,\n        },\n        {\n          title: '备注',\n          slot: 'mark',\n          minWidth: 100,\n        },\n        {\n          title: '操作',\n          slot: 'action',\n          fixed: 'right',\n          minWidth: 130,\n        },\n      ],\n      tableList: [],\n      grid: {\n        xl: 7,\n        lg: 10,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      tableFrom: {\n        keyword: '',\n        date: [],\n        page: 1,\n        limit: 15,\n        factor: 1,\n      },\n      total: 0,\n      timeVal: [],\n      modelType: 1,\n      lottery_id: '',\n      modelTitle: '',\n    };\n  },\n  computed: {\n    ...mapState('admin/layout', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : 80;\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'left';\n    },\n  },\n  created() {\n    this.tableFrom.lottery_id = this.$route.query.id;\n    this.lottery_id = this.$route.query.id;\n    this.getList();\n    this.getExpressData();\n  },\n  methods: {\n    deliver(row, type) {\n      this.markForm.id = row.id;\n      this.shipForm.id = row.id;\n      this.shipForm.deliver_name = '';\n      this.shipForm.deliver_number = '';\n      this.markForm.mark = row.deliver_info.mark;\n      this.modelType = type;\n      this.shipModel = true;\n    },\n    isDeliver(row) {\n      this.markForm.id = row.id;\n      this.shipForm.id = row.id;\n      this.modelType = 1;\n      this.modelTitle = '配送信息';\n      this.shipModel = true;\n      this.shipForm.deliver_name = row.deliver_info.deliver_name;\n      this.shipForm.deliver_number = row.deliver_info.deliver_number;\n    },\n    ok(name) {\n      this.$refs[name].validate((valid) => {\n        lotteryRecordDeliver(this.modelType == 1 ? this.shipForm : this.markForm)\n          .then((res) => {\n            this.$Message.success('操作成功');\n            this.shipModel = false;\n            this.getList();\n            this.shipForm = {\n              id: '',\n              deliver_name: '',\n              deliver_number: null,\n            };\n            this.modelTitle = '';\n            this.markForm = {\n              id: '',\n              mark: '',\n            };\n          })\n          .catch((err) => {\n            this.$Message.error(err.msg);\n          });\n      });\n    },\n    cancel() {\n      this.modelType = 1;\n      this.modelTitle = '';\n      this.shipModel = false;\n    },\n    // 物流公司列表\n    getExpressData() {\n      getExpressData()\n        .then(async (res) => {\n          this.locationList = res.data;\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    // 具体日期\n    onchangeTime(e) {\n      this.timeVal = e;\n      this.tableFrom.data = this.timeVal[0] ? this.timeVal.join('-') : '';\n      this.tableFrom.page = 1;\n      this.getList();\n    },\n    // 选择时间\n    selectChange(tab) {\n      this.tableFrom.page = 1;\n      this.tableFrom.date = tab;\n      this.timeVal = [];\n      this.getList();\n    },\n    selectType(type) {\n      this.tableFrom.page = 1;\n      this.timeVal = [];\n      this.getList();\n    },\n    selectChangeFactor() {\n      this.tableFrom.page = 1;\n      this.timeVal = [];\n      this.getList();\n    },\n    // 列表\n    getList() {\n      this.loading = true;\n      lotteryRecordList(this.tableFrom)\n        .then(async (res) => {\n          let data = res.data;\n          this.tableList = data.list;\n          this.total = res.data.count;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    pageChange(index) {\n      this.tableFrom.page = index;\n      this.getList();\n    },\n    // 表格搜索\n    userSearchs() {\n      this.tableFrom.page = 1;\n      this.getList();\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"stylus\">\n.tabBox_img {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  img {\n    width: 100%;\n    height: 100%;\n  }\n}\n\n.prize {\n  display: flex;\n  align-items: center;\n}\n\n.prize img {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  cursor: pointer;\n  margin-right: 5px;\n}\n\n.trips {\n  color: #ccc;\n}\n</style>\n"]}]}