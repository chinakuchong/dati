{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/components/cropperImg/index.vue?vue&type=style&index=0&id=197b9909&scoped=true&lang=scss&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/components/cropperImg/index.vue","mtime":1689324015141},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/@vue/cli-service/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmJ0biB7CiAgb3V0bGluZTogbm9uZTsKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgbGluZS1oZWlnaHQ6IDE7CiAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICBjdXJzb3I6IHBvaW50ZXI7CiAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOwogIHRleHQtYWxpZ246IGNlbnRlcjsKICAtd2Via2l0LWJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICBvdXRsaW5lOiAwOwogIC13ZWJraXQtdHJhbnNpdGlvbjogMC4xczsKICB0cmFuc2l0aW9uOiAwLjFzOwogIGZvbnQtd2VpZ2h0OiA1MDA7CiAgcGFkZGluZzogOHB4IDE1cHg7CiAgZm9udC1zaXplOiAxMnB4OwogIGJvcmRlci1yYWRpdXM6IDNweDsKICBjb2xvcjogI2ZmZjsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjNDA5ZWZmOwogIGJvcmRlci1jb2xvcjogIzQwOWVmZjsKICBtYXJnaW4tcmlnaHQ6IDEwcHg7Cn0KLmNyb3BwZXItY29udGVudCB7CiAgZGlzcGxheTogZmxleDsKICBkaXNwbGF5OiAtd2Via2l0LWZsZXg7CiAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsKICAuY3JvcHBlci1ib3ggewogICAgZmxleDogMTsKICAgIHdpZHRoOiAxMDAlOwogICAgLmNyb3BwZXIgewogICAgICB3aWR0aDogYXV0bzsKICAgICAgaGVpZ2h0OiAzMDBweDsKICAgIH0KICB9CgogIC5zaG93LXByZXZpZXcgewogICAgZmxleDogMTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIC5wcmV2aWV3IHsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgaGVpZ2h0OiAyMDBweDsKICAgICAgd2lkdGg6IDIwMHB4OwogICAgICBiYWNrZ3JvdW5kOiAjY2NjY2NjOwogICAgICB0cmFuc2Zvcm06IHNjYWxlKDAuOCk7CiAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgIH0KICB9Cn0KLmZvb3Rlci1idG4gewogIG1hcmdpbi10b3A6IDMwcHg7CiAgZGlzcGxheTogZmxleDsKICBkaXNwbGF5OiAtd2Via2l0LWZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7CiAgLnNjb3BlLWJ0biB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZGlzcGxheTogLXdlYmtpdC1mbGV4OwogICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgcGFkZGluZy1yaWdodDogMTBweDsKICB9CiAgLnVwbG9hZC1idG4gewogICAgZmxleDogMTsKICAgIC13ZWJraXQtZmxleDogMTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBkaXNwbGF5OiAtd2Via2l0LWZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/cropperImg","sourcesContent":["<template>\n  <div class=\"cropper-content\">\n    <div class=\"cropper-box\">\n      <div class=\"cropper\">\n        <vue-cropper\n          ref=\"cropper\"\n          :img=\"option.img\"\n          :outputSize=\"option.outputSize\"\n          :outputType=\"option.outputType\"\n          :info=\"option.info\"\n          :canScale=\"option.canScale\"\n          :autoCrop=\"option.autoCrop\"\n          :autoCropWidth=\"option.autoCropWidth\"\n          :autoCropHeight=\"option.autoCropHeight\"\n          :fixed=\"option.fixed\"\n          :fixedNumber=\"option.fixedNumber\"\n          :full=\"option.full\"\n          :fixedBox=\"option.fixedBox\"\n          :canMove=\"option.canMove\"\n          :canMoveBox=\"option.canMoveBox\"\n          :original=\"option.original\"\n          :centerBox=\"option.centerBox\"\n          :height=\"option.height\"\n          :infoTrue=\"option.infoTrue\"\n          :maxImgSize=\"option.maxImgSize\"\n          :enlarge=\"option.enlarge\"\n          :mode=\"option.mode\"\n          @realTime=\"realTime\"\n          @imgLoad=\"imgLoad\"\n        >\n        </vue-cropper>\n      </div>\n      <!--底部操作工具按钮-->\n      <div class=\"footer-btn\">\n        <div class=\"scope-btn\">\n          <input\n            type=\"file\"\n            id=\"uploads\"\n            style=\"position: absolute; clip: rect(0 0 0 0)\"\n            accept=\"image/png, image/jpeg, image/gif, image/jpg\"\n            @change=\"selectImg($event)\"\n          />\n          <el-button size=\"mini\" type=\"danger\" plain icon=\"el-icon-zoom-in\" @click=\"changeScale(1)\">放大</el-button>\n          <el-button size=\"mini\" type=\"danger\" plain icon=\"el-icon-zoom-out\" @click=\"changeScale(-1)\">缩小</el-button>\n          <el-button size=\"mini\" type=\"danger\" plain @click=\"rotateLeft\">↺ 左旋转</el-button>\n          <el-button size=\"mini\" type=\"danger\" plain @click=\"rotateRight\">↻ 右旋转</el-button>\n        </div>\n      </div>\n    </div>\n    <!--预览效果图-->\n    <div class=\"show-preview\">\n      <div class=\"preview\">\n        <img :src=\"previews.url\" :style=\"previews.img\" />\n      </div>\n      <div class=\"upload-btn\">\n        <label class=\"btn\" for=\"uploads\">选择图片</label>\n        <el-button size=\"mini\" type=\"success\" @click=\"uploadImg()\">确认上传</el-button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { VueCropper } from 'vue-cropper';\n// import { updateAvatar } from ''; //这里为文件上传的接口换成自己的文件\nimport { fileUpload } from '@/api/setting';\nexport default {\n  name: 'CropperImage',\n  components: {\n    VueCropper,\n  },\n  data() {\n    return {\n      name: '',\n      resImg: '',\n      previews: {},\n      option: {\n        img: '', //裁剪图片的地址\n        outputSize: 1, //裁剪生成图片的质量(可选0.1 - 1)\n        outputType: 'png', //裁剪生成图片的格式（jpeg || png || webp）\n        info: true, //图片大小信息\n        canScale: true, //图片是否允许滚轮缩放\n        autoCrop: true, //是否默认生成截图框\n        autoCropWidth: 200, //默认生成截图框宽度\n        autoCropHeight: 200, //默认生成截图框高度\n        fixed: true, //是否开启截图框宽高固定比例\n        fixedNumber: [1, 1], //截图框的宽高比例\n        full: false, //false按原比例裁切图片，不失真\n        fixedBox: false, //固定截图框大小，不允许改变\n        canMove: true, //上传图片是否可以移动\n        canMoveBox: true, //截图框能否拖动\n        original: false, //上传图片按照原始比例渲染\n        centerBox: true, //截图框是否被限制在图片里面\n        height: false, //是否按照设备的dpr 输出等比例图片\n        infoTrue: false, //true为展示真实输出图片宽高，false展示看到的截图框宽高\n        maxImgSize: 3000, //限制图片最大宽度和高度\n        enlarge: 1, //图片根据截图框输出比例倍数\n        mode: '300px 300px', //图片默认渲染方式\n      },\n    };\n  },\n  methods: {\n    //初始化函数\n    imgLoad(msg) {\n      console.log('工具初始化函数=====' + msg);\n    },\n    //图片缩放\n    changeScale(num) {\n      num = num || 1;\n      this.$refs.cropper.changeScale(num);\n    },\n    //向左旋转\n    rotateLeft() {\n      this.$refs.cropper.rotateLeft();\n    },\n    //向右旋转\n    rotateRight() {\n      this.$refs.cropper.rotateRight();\n    },\n    // //实时预览函数\n    realTime(data) {\n      let that = this;\n      that.previews = data;\n      this.$refs.cropper.getCropBlob((data) => {\n        this.blobToDataURI(data, function (res) {\n          that.previewImg = res;\n        });\n      });\n    },\n    blobToDataURI(blob, callback) {\n      var reader = new FileReader();\n      reader.readAsDataURL(blob);\n      reader.onload = function (e) {\n        callback(e.target.result);\n      };\n    },\n    //选择图片\n    selectImg(e) {\n      let file = e.target.files[0];\n      if (!/\\.(jpg|jpeg|png|JPG|PNG)$/.test(e.target.value)) {\n        this.$message({\n          message: '图片类型要求：jpeg、jpg、png',\n          type: 'error',\n        });\n        return false;\n      }\n      //转化为blob\n      let reader = new FileReader();\n      reader.onload = (e) => {\n        let data;\n        if (typeof e.target.result === 'object') {\n          data = window.URL.createObjectURL(new Blob([e.target.result]));\n        } else {\n          data = e.target.result;\n        }\n        this.option.img = data;\n      };\n      //转化为base64\n      reader.readAsDataURL(file);\n    },\n\n    base64ImgtoFile(dataurl, filename = 'file') {\n      //将base64格式分割：['data:image/png;base64','XXXX']\n      const arr = dataurl.split(',');\n      // .*？ 表示匹配任意字符到下一个符合条件的字符 刚好匹配到：\n      // image/png\n      const mime = arr[0].match(/:(.*?);/)[1]; //image/png\n      //[image,png] 获取图片类型后缀\n      const suffix = mime.split('/')[1]; //png\n      const bstr = atob(arr[1]); //atob() 方法用于解码使用 base-64 编码的字符串\n      let n = bstr.length;\n      const u8arr = new Uint8Array(n);\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n      return new File([u8arr], `${filename}.${suffix}`, {\n        type: mime,\n      });\n    },\n\n    uploadFile(file) {\n      const formData = new FormData();\n      formData.append('file', file);\n      fileUpload(formData).then((res) => {\n        if (res.status == 200) {\n          this.$emit('uploadImgSuccess', res.data);\n        } else {\n          this.$message({\n            message: '上传失败',\n            type: 'error',\n            duration: 1000,\n          });\n        }\n      });\n    },\n    //上传图片\n    uploadImg() {\n      this.$refs.cropper.getCropData((data) => {\n        this.resImg = this.base64ImgtoFile(data);\n        this.uploadFile(this.resImg);\n      });\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.btn {\n  outline: none;\n  display: inline-block;\n  line-height: 1;\n  white-space: nowrap;\n  cursor: pointer;\n  -webkit-appearance: none;\n  text-align: center;\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  outline: 0;\n  -webkit-transition: 0.1s;\n  transition: 0.1s;\n  font-weight: 500;\n  padding: 8px 15px;\n  font-size: 12px;\n  border-radius: 3px;\n  color: #fff;\n  background-color: #409eff;\n  border-color: #409eff;\n  margin-right: 10px;\n}\n.cropper-content {\n  display: flex;\n  display: -webkit-flex;\n  justify-content: flex-end;\n  .cropper-box {\n    flex: 1;\n    width: 100%;\n    .cropper {\n      width: auto;\n      height: 300px;\n    }\n  }\n\n  .show-preview {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: center;\n    .preview {\n      overflow: hidden;\n      height: 200px;\n      width: 200px;\n      background: #cccccc;\n      transform: scale(0.8);\n      border-radius: 50%;\n    }\n  }\n}\n.footer-btn {\n  margin-top: 30px;\n  display: flex;\n  display: -webkit-flex;\n  justify-content: space-around;\n  .scope-btn {\n    display: flex;\n    display: -webkit-flex;\n    justify-content: space-between;\n    padding-right: 10px;\n  }\n  .upload-btn {\n    flex: 1;\n    -webkit-flex: 1;\n    display: flex;\n    display: -webkit-flex;\n    justify-content: center;\n  }\n}\n</style>\n"]}]}