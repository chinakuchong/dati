{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/product/productAttr/addAttr.vue?vue&type=style&index=0&id=bde54da2&scoped=true&lang=stylus&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/product/productAttr/addAttr.vue","mtime":1689324015247},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/@vue/cli-service/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5ydWxlc0JveCB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGZsZXgtd3JhcDogd3JhcDsKfQoKLmF0dHJGcm9tIHsKICA+Pj4gLml2dS1mb3JtLWl0ZW0gewogICAgbWFyZ2luLWJvdHRvbTogMHB4ICFpbXBvcnRhbnQ7CiAgfQp9Cg=="},{"version":3,"sources":["addAttr.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkOA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"addAttr.vue","sourceRoot":"src/pages/product/productAttr","sourcesContent":["<template>\n  <Modal scrollable v-model=\"modal\" @on-cancel=\"onCancel\" title=\"商品规格\" width=\"950\">\n    <Form\n      ref=\"formDynamic\"\n      :model=\"formDynamic\"\n      :rules=\"rules\"\n      class=\"attrFrom\"\n      :label-width=\"110\"\n      label-position=\"right\"\n      @submit.native.prevent\n    >\n      <Row :gutter=\"24\">\n        <Col span=\"24\">\n          <Col span=\"8\" class=\"mb15\">\n            <FormItem label=\"规格模板名称：\" prop=\"rule_name\">\n              <Input placeholder=\"请输入标题名称\" :maxlength=\"20\" v-model.trim=\"formDynamic.rule_name\" />\n            </FormItem>\n          </Col>\n        </Col>\n        <Col span=\"23\" class=\"noForm\" v-for=\"(item, index) in formDynamic.spec\" :key=\"index\">\n          <FormItem>\n            <div class=\"acea-row row-middle\">\n              <span class=\"mr5\">{{ item.value }}</span\n              ><Icon type=\"ios-close-circle\" @click=\"handleRemove(index)\" />\n            </div>\n            <div class=\"rulesBox\">\n              <Tag\n                type=\"dot\"\n                class=\"\"\n                closable\n                color=\"primary\"\n                v-for=\"(j, indexn) in item.detail\"\n                :key=\"indexn\"\n                :name=\"j\"\n                @on-close=\"handleRemove2(item.detail, indexn)\"\n                >{{ j }}</Tag\n              >\n              <Input\n                search\n                enter-button=\"添加\"\n                placeholder=\"请输入属性名称\"\n                v-model.trim=\"item.detail.attrsVal\"\n                @on-search=\"createAttr(item.detail.attrsVal, index)\"\n                style=\"width: 200px\"\n              />\n            </div>\n          </FormItem>\n        </Col>\n        <Col span=\"24\" v-if=\"isBtn\" class=\"mt10\">\n          <Col span=\"8\" class=\"mr15\">\n            <FormItem label=\"规格名称：\">\n              <Input placeholder=\"请输入规格\" v-model=\"attrsName\" />\n            </FormItem>\n          </Col>\n          <Col span=\"8\" class=\"mr20\">\n            <FormItem label=\"规格值：\">\n              <Input v-model=\"attrsVal\" placeholder=\"请输入规格值\" />\n            </FormItem>\n          </Col>\n          <Col span=\"2\">\n            <Button type=\"primary\" @click=\"createAttrName\">确定</Button>\n          </Col>\n          <Col span=\"2\">\n            <Button @click=\"offAttrName\">取消</Button>\n          </Col>\n        </Col>\n        <Spin size=\"large\" fix v-if=\"spinShow\"></Spin>\n      </Row>\n      <Button type=\"primary\" icon=\"md-add\" @click=\"addBtn\" v-if=\"!isBtn\" class=\"ml95 mt10\">添加新规格</Button>\n    </Form>\n    <div slot=\"footer\">\n      <Button type=\"primary\" :loading=\"modal_loading\" @click=\"handleSubmit('formDynamic')\">确定</Button>\n    </div>\n  </Modal>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { ruleAddApi, ruleInfoApi } from '@/api/product';\nexport default {\n  name: 'addAttr',\n  data() {\n    return {\n      spinShow: false,\n      modal_loading: false,\n      grid: {\n        xl: 3,\n        lg: 3,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      modal: false,\n      index: 1,\n      rules: {\n        rule_name: [{ required: true, message: '请输入规格名称', trigger: 'blur' }],\n      },\n      formDynamic: {\n        rule_name: '',\n        spec: [],\n      },\n      attrsName: '',\n      attrsVal: '',\n      formDynamicNameData: [],\n      isBtn: false,\n      formDynamicName: [],\n      results: [],\n      result: [],\n      ids: 0,\n    };\n  },\n  computed: {},\n  methods: {\n    onCancel() {\n      this.ids = 0;\n      this.clear();\n    },\n    // 添加按钮\n    addBtn() {\n      this.isBtn = true;\n    },\n    // 详情\n    getIofo(row) {\n      this.spinShow = true;\n      this.ids = row.id;\n      ruleInfoApi(row.id)\n        .then((res) => {\n          this.formDynamic = res.data.info;\n          this.spinShow = false;\n        })\n        .catch((res) => {\n          this.spinShow = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    // 提交\n    handleSubmit(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          if (this.formDynamic.spec.length === 0) {\n            return this.$Message.warning('请至少添加一条商品规格！');\n          }\n          this.modal_loading = true;\n          setTimeout(() => {\n            ruleAddApi(this.formDynamic, this.ids)\n              .then((res) => {\n                this.$Message.success(res.msg);\n                setTimeout(() => {\n                  this.modal = false;\n                  this.modal_loading = false;\n                }, 500);\n                setTimeout(() => {\n                  this.$emit('getList');\n                  this.clear();\n                }, 600);\n              })\n              .catch((res) => {\n                this.modal_loading = false;\n                this.$Message.error(res.msg);\n              });\n          }, 1200);\n        } else {\n          return false;\n        }\n      });\n    },\n    clear() {\n      this.$refs['formDynamic'].resetFields();\n      this.formDynamic.spec = [];\n      this.isBtn = false;\n      this.attrsName = '';\n      this.attrsVal = '';\n      this.ids = 0;\n    },\n    // 取消\n    offAttrName() {\n      this.isBtn = false;\n    },\n    // 删除\n    handleRemove(index) {\n      this.formDynamic.spec.splice(index, 1);\n    },\n    // 删除属性\n    handleRemove2(item, index) {\n      item.splice(index, 1);\n    },\n    // 添加规则名称\n    createAttrName() {\n      if (this.attrsName && this.attrsVal) {\n        let data = {\n          value: this.attrsName,\n          detail: [this.attrsVal],\n        };\n        this.formDynamic.spec.push(data);\n        var hash = {};\n        this.formDynamic.spec = this.formDynamic.spec.reduce(function (item, next) {\n          /* eslint-disable */\n          hash[next.value] ? '' : (hash[next.value] = true && item.push(next));\n          return item;\n        }, []);\n        this.attrsName = '';\n        this.attrsVal = '';\n        this.isBtn = false;\n      } else {\n        this.$Message.warning('请添加规格名称或规格值');\n      }\n    },\n    // 添加属性\n    createAttr(num, idx) {\n      if (num) {\n        this.formDynamic.spec[idx].detail.push(num);\n        var hash = {};\n        this.formDynamic.spec[idx].detail = this.formDynamic.spec[idx].detail.reduce(function (item, next) {\n          /* eslint-disable */\n          hash[next] ? '' : (hash[next] = true && item.push(next));\n          return item;\n        }, []);\n      } else {\n        this.$Message.warning('请添加属性');\n      }\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"stylus\">\n.rulesBox {\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n}\n\n.attrFrom {\n  >>> .ivu-form-item {\n    margin-bottom: 0px !important;\n  }\n}\n</style>\n"]}]}