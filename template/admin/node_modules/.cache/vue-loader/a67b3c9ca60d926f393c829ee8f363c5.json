{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/setting/notification/notificationEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/setting/notification/notificationEdit.vue","mtime":1689324015257},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldE5vdGlmaWNhdGlvbkluZm8sIGdldE5vdGlmaWNhdGlvblNhdmUgfSBmcm9tICdAL2FwaS9ub3RpZmljYXRpb24uanMnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRhYnM6IFsKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJ+ezu+e7n+mAmuefpScsCiAgICAgICAgICBzbG90OiAnaXNfc3lzdGVtJywKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAn55+t5L+h6YCa55+lJywKICAgICAgICAgIHNsb3Q6ICdpc19zbXMnLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICflvq7kv6HmqKHmnb/mtojmga8nLAogICAgICAgICAgc2xvdDogJ2lzX3dlY2hhdCcsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJ+W+ruS/oeWwj+eoi+W6j+aPkOmGkicsCiAgICAgICAgICBzbG90OiAnaXNfcm91dGluZScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJ+S8geS4muW+ruS/oScsCiAgICAgICAgICBzbG90OiAnaXNfZW50X3dlY2hhdCcsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgdGFic0xpc3Q6IFtdLAogICAgICBmb3JtRGF0YToge30sCiAgICAgIGlkOiAwLAogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICBydWxlVmFsaWRhdGU6IHsKICAgICAgICBuYW1lOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl6YCa55+l5Zy65pmvJywKICAgICAgICAgICAgdHJpZ2dlcjogJ2JsdXInLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICAgIHRpdGxlOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl6YCa55+l5Zy65pmvJywKICAgICAgICAgICAgdHJpZ2dlcjogJ2JsdXInLAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICAgIGNvbnRlbnQ6IFsKICAgICAgICAgIHsKICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXpgJrnn6XlhoXlrrknLAogICAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgIH0sCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuaWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5pZDsKICAgIHRoaXMuY2hhbmdlVGFicygnaXNfc3lzdGVtJyk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBjaGFuZ2VUYWJzKG5hbWUpIHsKICAgICAgdGhpcy5nZXREYXRhKHRoaXMuaWQsIG5hbWUpOwogICAgfSwKICAgIGdldERhdGEoaWQsIG5hbWUpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgdGhpcy5mb3JtRGF0YSA9IHt9OwogICAgICBnZXROb3RpZmljYXRpb25JbmZvKGlkLCBuYW1lKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIGlmICghdGhpcy50YWJzTGlzdC5sZW5ndGgpIHsKICAgICAgICAgICAgdGhpcy50YWJzLm1hcCgodikgPT4gewogICAgICAgICAgICAgIGlmIChyZXMuZGF0YVt2LnNsb3RdKSB7CiAgICAgICAgICAgICAgICB0aGlzLnRhYnNMaXN0LnB1c2godik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuZm9ybURhdGEgPSByZXMuZGF0YTsKICAgICAgICAgIHRoaXMuZm9ybURhdGEudHlwZSA9IG5hbWU7CiAgICAgICAgICB0aGlzLmZvcm1EYXRhLmlkID0gaWQ7CiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKGVyci5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZVN1Ym1pdChuYW1lKSB7CiAgICAgIGdldE5vdGlmaWNhdGlvblNhdmUodGhpcy5mb3JtRGF0YSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MoJ+iuvue9ruaIkOWKnycpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IoZXJyKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVSZXNldChuYW1lKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2Nsb3NlJyk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["notificationEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"notificationEdit.vue","sourceRoot":"src/pages/setting/notification","sourcesContent":["<template>\n  <div class=\"edit\">\n    <!-- <div class=\"i-layout-page-header\">\n      <router-link :to=\"{ path: '/admin/setting/notification/index' }\"\n        ><Button icon=\"ios-arrow-back\" size=\"small\" class=\"mr20\"\n          >返回</Button\n        ></router-link\n      >\n      <span class=\"ivu-page-header-title\">{{ $route.meta.title }}</span>\n    </div> -->\n    <div class=\"i-layout-page-header header_top\">\n      <div class=\"i-layout-page-header fl_header\">\n        <router-link :to=\"{ path: $routeProStr + '/setting/notification/index' }\"\n          ><Button icon=\"ios-arrow-back\" size=\"small\" type=\"text\">返回</Button></router-link\n        >\n        <Divider type=\"vertical\" />\n        <span class=\"ivu-page-header-title mr20\" style=\"padding: 0\" v-text=\"$route.meta.title\"></span>\n      </div>\n    </div>\n    <div class=\"tabs\">\n      <Row :gutter=\"32\">\n        <Col span=\"32\" class=\"demo-tabs-style1\" style=\"padding: 16px\">\n          <Tabs @on-click=\"changeTabs\">\n            <TabPane v-for=\"(item, index) in tabsList\" :key=\"index\" :name=\"item.slot\" :label=\"item.title\">\n              <Form class=\"form-sty\" ref=\"formData\" :model=\"formData\" :rules=\"ruleValidate\" :label-width=\"80\">\n                <div v-if=\"item.slot === 'is_system' && !loading\">\n                  <FormItem label=\"通知标题\">\n                    <Input v-model=\"formData.system_title\" placeholder=\"请输入通知标题\" style=\"width: 500px\"></Input>\n                  </FormItem>\n                  <FormItem label=\"通知内容\">\n                    <div class=\"content\">\n                      <Input\n                        v-model=\"formData.system_text\"\n                        type=\"textarea\"\n                        :autosize=\"{ minRows: 5, maxRows: 8 }\"\n                        placeholder=\"请输入通知内容\"\n                        style=\"width: 500px\"\n                      ></Input>\n                      <div class=\"trip\">\n                        <div>请输入模板消息详细内容对应的变量。关键字个数需与已添加的模板一致。 可以使用如下变量：</div>\n                        <div v-for=\"(item, index) in formData.variable.split(',')\" :key=\"index\">\n                          {{ item }}\n                        </div>\n                      </div>\n                    </div>\n                  </FormItem>\n                  <FormItem label=\"状态\" prop=\"is_system\">\n                    <RadioGroup v-model=\"formData.is_system\">\n                      <Radio :label=\"1\">开启</Radio>\n                      <Radio :label=\"2\">关闭</Radio>\n                    </RadioGroup>\n                  </FormItem>\n                </div>\n                <div v-if=\"item.slot === 'is_sms' && !loading\">\n                  <FormItem label=\"短信模版ID\">\n                    <Input v-model=\"formData.sms_id\" placeholder=\"短信模版ID\" style=\"width: 500px\"></Input>\n                  </FormItem>\n                  <FormItem label=\"通知内容\">\n                    <div class=\"content\">\n                      <Input\n                        v-model=\"formData.content\"\n                        type=\"textarea\"\n                        disabled\n                        :autosize=\"{ minRows: 5, maxRows: 8 }\"\n                        placeholder=\"请输入通知内容\"\n                        style=\"width: 500px\"\n                      ></Input>\n                    </div>\n                  </FormItem>\n                  <FormItem label=\"状态\" prop=\"is_sms\">\n                    <RadioGroup v-model=\"formData.is_sms\">\n                      <Radio :label=\"1\">开启</Radio>\n                      <Radio :label=\"2\">关闭</Radio>\n                    </RadioGroup>\n                  </FormItem>\n                </div>\n                <div v-else-if=\"item.slot === 'is_wechat' && !loading\">\n                  <FormItem label=\"ID\">\n                    <Input\n                      v-model=\"formData.templage_message_id\"\n                      disabled\n                      placeholder=\"请输入通模板编号\"\n                      style=\"width: 500px\"\n                    ></Input>\n                  </FormItem>\n                  <FormItem label=\"模板编号\">\n                    <Input\n                      v-model=\"formData.tempkey\"\n                      disabled\n                      placeholder=\"请输入通模板编号\"\n                      style=\"width: 500px\"\n                    ></Input>\n                  </FormItem>\n                  <FormItem label=\"模板\">\n                    <Input\n                      disabled\n                      v-model=\"formData.content\"\n                      type=\"textarea\"\n                      :autosize=\"{ minRows: 5, maxRows: 8 }\"\n                      placeholder=\"请输入模板\"\n                      style=\"width: 500px\"\n                    ></Input>\n                  </FormItem>\n                  <FormItem label=\"模板ID\">\n                    <Input v-model=\"formData.tempid\" placeholder=\"请输入模板ID\" style=\"width: 500px\"></Input>\n                  </FormItem>\n                  <FormItem label=\"状态\" prop=\"is_wechat\">\n                    <RadioGroup v-model=\"formData.is_wechat\">\n                      <Radio :label=\"1\">开启</Radio>\n                      <Radio :label=\"2\">关闭</Radio>\n                    </RadioGroup>\n                  </FormItem>\n                </div>\n                <div v-else-if=\"item.slot === 'is_routine' && !loading\">\n                  <FormItem label=\"ID\">\n                    <Input\n                      v-model=\"formData.templage_message_id\"\n                      disabled\n                      placeholder=\"请输入通模板编号\"\n                      style=\"width: 500px\"\n                    ></Input>\n                  </FormItem>\n                  <FormItem label=\"模板编号\">\n                    <Input\n                      v-model=\"formData.tempkey\"\n                      disabled\n                      placeholder=\"请输入通模板编号\"\n                      style=\"width: 500px\"\n                    ></Input>\n                  </FormItem>\n                  <FormItem label=\"模板\">\n                    <Input\n                      disabled\n                      v-model=\"formData.content\"\n                      type=\"textarea\"\n                      :autosize=\"{ minRows: 5, maxRows: 8 }\"\n                      placeholder=\"请输入模板\"\n                      style=\"width: 500px\"\n                    ></Input>\n                  </FormItem>\n                  <FormItem label=\"模板ID\">\n                    <Input v-model=\"formData.tempid\" placeholder=\"请输入模板ID\" style=\"width: 500px\"></Input>\n                  </FormItem>\n                  <FormItem label=\"状态\" prop=\"is_routine\">\n                    <RadioGroup v-model=\"formData.is_routine\">\n                      <Radio :label=\"1\">开启</Radio>\n                      <Radio :label=\"2\">关闭</Radio>\n                    </RadioGroup>\n                  </FormItem>\n                </div>\n\n                <div v-else-if=\"item.slot === 'is_ent_wechat' && !loading\">\n                  <FormItem label=\"通知内容\">\n                    <div class=\"content\">\n                      <Input\n                        v-model=\"formData.ent_wechat_text\"\n                        type=\"textarea\"\n                        :autosize=\"{ minRows: 5, maxRows: 8 }\"\n                        placeholder=\"请输入通知内容\"\n                        style=\"width: 500px\"\n                      ></Input>\n                      <div class=\"trip\">\n                        <div>请输入模板消息详细内容对应的变量。关键字个数需与已添加的模板一致。 可以使用如下变量：</div>\n                        <div v-for=\"(item, index) in formData.variable.split(',')\" :key=\"index\">\n                          {{ item }}\n                        </div>\n                      </div>\n                    </div>\n                  </FormItem>\n                  <FormItem label=\"机器人链接\">\n                    <div class=\"content\">\n                      <Input v-model=\"formData.url\" placeholder=\"请输入机器人链接\" style=\"width: 500px\"></Input>\n                      <div class=\"trip\">企业微信群机器人链接</div>\n                    </div>\n                  </FormItem>\n                  <FormItem label=\"状态\" prop=\"is_ent_wechat\">\n                    <RadioGroup v-model=\"formData.is_ent_wechat\">\n                      <Radio :label=\"1\">开启</Radio>\n                      <Radio :label=\"2\">关闭</Radio>\n                    </RadioGroup>\n                  </FormItem>\n                </div>\n                <FormItem>\n                  <Button type=\"primary\" @click=\"handleSubmit('formData')\">提交</Button>\n                </FormItem>\n              </Form>\n            </TabPane>\n          </Tabs>\n        </Col>\n      </Row>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getNotificationInfo, getNotificationSave } from '@/api/notification.js';\nexport default {\n  data() {\n    return {\n      tabs: [\n        {\n          title: '系统通知',\n          slot: 'is_system',\n        },\n        {\n          title: '短信通知',\n          slot: 'is_sms',\n        },\n        {\n          title: '微信模板消息',\n          slot: 'is_wechat',\n        },\n        {\n          title: '微信小程序提醒',\n          slot: 'is_routine',\n        },\n        {\n          title: '企业微信',\n          slot: 'is_ent_wechat',\n        },\n      ],\n      tabsList: [],\n      formData: {},\n      id: 0,\n      loading: true,\n      ruleValidate: {\n        name: [\n          {\n            required: true,\n            message: '请输入通知场景',\n            trigger: 'blur',\n          },\n        ],\n        title: [\n          {\n            required: true,\n            message: '请输入通知场景',\n            trigger: 'blur',\n          },\n        ],\n        content: [\n          {\n            required: true,\n            message: '请输入通知内容',\n            trigger: 'blur',\n          },\n        ],\n      },\n    };\n  },\n  created() {\n    this.id = this.$route.query.id;\n    this.changeTabs('is_system');\n  },\n  methods: {\n    changeTabs(name) {\n      this.getData(this.id, name);\n    },\n    getData(id, name) {\n      this.loading = true;\n      this.formData = {};\n      getNotificationInfo(id, name)\n        .then((res) => {\n          if (!this.tabsList.length) {\n            this.tabs.map((v) => {\n              if (res.data[v.slot]) {\n                this.tabsList.push(v);\n              }\n            });\n          }\n          this.formData = res.data;\n          this.formData.type = name;\n          this.formData.id = id;\n          this.loading = false;\n        })\n        .catch((err) => {\n          this.$Message.error(err.msg);\n        });\n    },\n    handleSubmit(name) {\n      getNotificationSave(this.formData)\n        .then((res) => {\n          this.$Message.success('设置成功');\n        })\n        .catch((err) => {\n          this.$Message.error(err);\n        });\n    },\n    handleReset(name) {\n      this.$emit('close');\n    },\n  },\n};\n</script>\n\n<style scoped>\n.edit {\n}\n.header_top {\n  margin-bottom: 10px;\n}\n.demo-tabs-style1 > .ivu-tabs-card > .ivu-tabs-content {\n  height: 120px;\n  margin-top: -16px;\n}\n\n.demo-tabs-style1 > .ivu-tabs-card > .ivu-tabs-content > .ivu-tabs-tabpane {\n  background: #fff;\n  padding: 16px;\n}\n\n.demo-tabs-style1 > .ivu-tabs.ivu-tabs-card > .ivu-tabs-bar .ivu-tabs-tab {\n  border-color: transparent;\n}\n\n.demo-tabs-style1 > .ivu-tabs-card > .ivu-tabs-bar .ivu-tabs-tab-active {\n  border-color: #fff;\n}\n\n.tabs {\n  padding: 0 30px;\n  background-color: #fff;\n}\n\n.trip {\n  color: rgb(146, 139, 139);\n  background-color: #f2f2f2;\n  margin-left: 80px;\n  border-radius: 4px;\n  padding: 15px;\n}\n\n.content {\n  display: flex;\n}\n\n.form-sty {\n  margin-top: 20px;\n}\n</style>\n"]}]}