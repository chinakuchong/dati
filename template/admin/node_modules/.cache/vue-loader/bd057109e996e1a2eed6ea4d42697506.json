{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/cms/article/index.vue?vue&type=style&index=0&id=316a1642&scoped=true&lang=stylus&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/cms/article/index.vue","mtime":1689324015200},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/@vue/cli-service/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi50cmVlU2VsID4+Pi5pdnUtc2VsZWN0LWRyb3Bkb3duLWxpc3QgewogIHBhZGRpbmc6IDAgMTBweCAhaW1wb3J0YW50OwogIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0KCi50YWJCb3hfaW1nIHsKICB3aWR0aDogMzZweDsKICBoZWlnaHQ6IDM2cHg7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIGN1cnNvcjogcG9pbnRlcjsKCiAgaW1nIHsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAxMDAlOwogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiVA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/cms/article","sourcesContent":["<template>\n  <div>\n    <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n      <Form\n        ref=\"artFrom\"\n        :model=\"artFrom\"\n        :label-width=\"labelWidth\"\n        :label-position=\"labelPosition\"\n        @submit.native.prevent\n      >\n        <Row type=\"flex\" :gutter=\"24\">\n          <Col v-bind=\"grid\">\n            <FormItem label=\"文章分类：\" label-for=\"pid\">\n              <i-select :value=\"artFrom.pid\" placeholder=\"请选择\" style=\"width: 80%\" class=\"treeSel\">\n                <i-option v-for=\"(item, index) of list\" :value=\"item.value\" :key=\"index\" style=\"display: none\">\n                  {{ item.title }}\n                </i-option>\n                <Tree :data=\"treeData\" @on-select-change=\"handleCheckChange\"></Tree>\n              </i-select>\n            </FormItem>\n          </Col>\n          <Col v-bind=\"grid\">\n            <FormItem label=\"文章搜索：\" label-for=\"title\">\n              <Input\n                search\n                enter-button\n                placeholder=\"请输入\"\n                v-model=\"artFrom.title\"\n                style=\"width: 80%\"\n                @on-search=\"userSearchs\"\n              />\n            </FormItem>\n          </Col>\n        </Row>\n        <Row type=\"flex\">\n          <Col v-bind=\"grid\">\n            <router-link :to=\"$routeProStr + '/cms/article/add_article'\" v-auth=\"['cms-article-creat']\"\n              ><Button type=\"primary\" class=\"bnt\" icon=\"md-add\">添加文章</Button></router-link\n            >\n          </Col>\n        </Row>\n      </Form>\n      <Table\n        :columns=\"columns1\"\n        :data=\"cmsList\"\n        ref=\"table\"\n        class=\"mt25\"\n        :loading=\"loading\"\n        highlight-row\n        no-userFrom-text=\"暂无数据\"\n        no-filtered-userFrom-text=\"暂无筛选结果\"\n      >\n        <template slot-scope=\"{ row, index }\" slot=\"titles\">\n          <span>{{ ' [ ' + row.catename + ' ] ' + row.title }}</span>\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"image_inputs\">\n          <div v-if=\"row.image_input.length !== 0\" v-viewer>\n            <div class=\"tabBox_img\" v-for=\"(item, index) in row.image_input\" :key=\"index\">\n              <img v-lazy=\"item\" />\n            </div>\n          </div>\n        </template>\n        <template slot-scope=\"{ row, index }\" slot=\"action\">\n          <a @click=\"edit(row)\">编辑</a>\n          <Divider type=\"vertical\" />\n          <a @click=\"artRelation(row, '取消关联', index)\">{{ row.product_id === 0 ? '关联' : '取消关联' }}</a>\n          <Divider type=\"vertical\" />\n          <a @click=\"del(row, '删除文章', index)\">删除</a>\n        </template>\n      </Table>\n      <div class=\"acea-row row-right page\">\n        <Page\n          :total=\"total\"\n          :current=\"artFrom.page\"\n          show-elevator\n          show-total\n          @on-change=\"pageChange\"\n          :page-size=\"artFrom.limit\"\n        />\n      </div>\n    </Card>\n    <!--关联-->\n    <Modal\n      v-model=\"modals\"\n      title=\"商品列表\"\n      footerHide\n      class=\"paymentFooter\"\n      scrollable\n      width=\"900\"\n      @on-cancel=\"cancel\"\n    >\n      <goods-list ref=\"goodslist\" @getProductId=\"getProductId\" v-if=\"modals\"></goods-list>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { cmsListApi, categoryListApi, relationApi } from '@/api/cms';\nimport relationList from './relation';\nimport { formatDate } from '@/utils/validate';\nimport goodsList from '@/components/goodsList/index';\nexport default {\n  name: 'cms_article',\n  data() {\n    return {\n      modalTitleSs: '',\n      currentTab: '',\n      grid: {\n        xl: 8,\n        lg: 8,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      loading: false,\n      artFrom: {\n        pid: 0,\n        title: '',\n        page: 1,\n        limit: 20,\n      },\n      total: 0,\n      columns1: [\n        {\n          title: 'ID',\n          key: 'id',\n          width: 80,\n        },\n        {\n          title: '文章图片',\n          slot: 'image_inputs',\n          minWidth: 90,\n        },\n        {\n          title: '文章名称',\n          slot: 'titles',\n          minWidth: 130,\n        },\n        {\n          title: '关联商品',\n          key: 'store_name',\n          minWidth: 130,\n        },\n        // {\n        //     title: '排序',\n        //     key: 'sort',\n        //     minWidth: 60\n        // },\n        {\n          title: '浏览量',\n          key: 'visit',\n          minWidth: 80,\n        },\n        {\n          title: '时间',\n          key: 'add_time',\n          sortable: true,\n          render: (h, params) => {\n            return h('div', formatDate(new Date(Number(params.row.add_time) * 1000), 'yyyy-MM-dd hh:mm'));\n          },\n          minWidth: 120,\n        },\n        {\n          title: '操作',\n          slot: 'action',\n          fixed: 'right',\n          minWidth: 150,\n        },\n      ],\n      cmsList: [],\n      treeData: [],\n      list: [],\n      cid: 0, // 移动分类id\n      cmsId: 0,\n      formValidate: {\n        type: 1,\n      },\n      rows: {},\n      modal_loading: false,\n      modals: false,\n    };\n  },\n  components: {\n    relationList,\n    goodsList,\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : 75;\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  created() {},\n  activated() {\n    this.artFrom.pid = this.$route.query.id ? this.$route.query.id : 0;\n    this.getList();\n    this.getClass();\n  },\n  methods: {\n    // 关联成功\n    getProductId(row) {\n      let data = {\n        product_id: row.id,\n      };\n      relationApi(data, this.rows.id)\n        .then(async (res) => {\n          this.$Message.success(res.msg);\n          row.id = 0;\n          this.modal_loading = false;\n          this.modals = false;\n          setTimeout(() => {\n            this.getList();\n          }, 500);\n        })\n        .catch((res) => {\n          this.modal_loading = false;\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    cancel() {\n      this.modals = false;\n    },\n    // 等级列表\n    getList() {\n      this.loading = true;\n      cmsListApi(this.artFrom)\n        .then(async (res) => {\n          let data = res.data;\n          this.cmsList = data.list;\n          this.total = data.count;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    // 分类\n    getClass() {\n      categoryListApi(this.formValidate)\n        .then(async (res) => {\n          let data = res.data;\n          this.treeData = data;\n          let obj = {\n            id: 0,\n            title: '全部',\n          };\n          this.treeData.unshift(obj);\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    pageChange(index) {\n      this.artFrom.page = index;\n      this.getList();\n    },\n    // 下拉树\n    handleCheckChange(data) {\n      let value = '';\n      let title = '';\n      this.list = [];\n      this.artFrom.pid = 0;\n      data.forEach((item, index) => {\n        value += `${item.id},`;\n        title += `${item.title},`;\n      });\n      value = value.substring(0, value.length - 1);\n      title = title.substring(0, title.length - 1);\n      this.list.push({\n        value,\n        title,\n      });\n      this.artFrom.pid = value;\n      this.artFrom.page = 1;\n      this.getList();\n    },\n    // 编辑\n    edit(row) {\n      this.$router.push({ path: this.$routeProStr + '/cms/article/add_article/' + row.id });\n    },\n    // 关联\n    artRelation(row, tit, num) {\n      this.rows = row;\n      if (row.product_id === 0) {\n        this.modals = true;\n      } else {\n        let delfromData = {\n          title: tit,\n          num: num,\n          url: `/cms/cms/unrelation/${row.id}`,\n          method: 'PUT',\n          ids: '',\n        };\n        this.$modalSure(delfromData)\n          .then((res) => {\n            this.$Message.success(res.msg);\n            this.getList();\n          })\n          .catch((res) => {\n            this.$Message.error(res.msg);\n          });\n      }\n    },\n    // 删除\n    del(row, tit, num) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `cms/cms/${row.id}`,\n        method: 'DELETE',\n        ids: '',\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$Message.success(res.msg);\n          this.cmsList.splice(num, 1);\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    // 表格搜索\n    userSearchs() {\n      this.artFrom.page = 1;\n      this.getList();\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"stylus\">\n.treeSel >>>.ivu-select-dropdown-list {\n  padding: 0 10px !important;\n  box-sizing: border-box;\n}\n\n.tabBox_img {\n  width: 36px;\n  height: 36px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  img {\n    width: 100%;\n    height: 100%;\n  }\n}\n</style>\n"]}]}