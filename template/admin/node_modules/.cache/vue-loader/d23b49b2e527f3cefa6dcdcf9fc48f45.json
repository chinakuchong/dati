{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/app/wechat/user/user.vue?vue&type=style&index=0&id=2ddb52d0&scoped=true&lang=stylus&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/app/wechat/user/user.vue","mtime":1689324015199},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/@vue/cli-service/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouUmVmcmVzaAogICAgZm9udC1zaXplIDEycHgKICAgIGNvbG9yICMxODkwRkYKICAgIGN1cnNvciBwb2ludGVyCi51c2VyRnJvbQogICAgPj4+IC5pdnUtZm9ybS1pdGVtLWNvbnRlbnQKICAgICAgICBtYXJnaW4tbGVmdDogMHB4ICFpbXBvcnRhbnQKLnRhYkJveF9pbWcKICAgIHdpZHRoIDM2cHgKICAgIGhlaWdodCAzNnB4CiAgICBib3JkZXItcmFkaXVzOjRweAogICAgY3Vyc29yIHBvaW50ZXIKICAgIGltZwogICAgICAgIHdpZHRoIDEwMCUKICAgICAgICBoZWlnaHQgMTAwJQouc3Vic2NyaWJlX2JveAogICA+Pj4gLml2dS1mb3JtLWl0ZW0tbGFiZWwKICAgICAgd2lkdGggMTEwcHggIWltcG9ydGFudAogICA+Pj4gLml2dS1mb3JtLWl0ZW0tY29udGVudAogICAgICBtYXJnaW4tbGVmdCAgMTEwcHggIWltcG9ydGFudAouc2V4X2JveAogICAgPj4+IC5pdnUtZm9ybS1pdGVtLWxhYmVsCiAgICAgIHdpZHRoIDYwcHggIWltcG9ydGFudAogICAgPj4+IC5pdnUtZm9ybS1pdGVtLWNvbnRlbnQKICAgICAgbWFyZ2luLWxlZnQgIDYwcHggIWltcG9ydGFudAouYnRuX2JveAogICAgPj4+IC5pdnUtZm9ybS1pdGVtLWNvbnRlbnQKICAgICAgbWFyZ2luLWxlZnQgMCAhaW1wb3J0YW50Ci5tb2RlbEJveAogICAgPj4+IC5pdnUtbW9kYWwtYm9keQogICAgICAgIHBhZGRpbmcgMCAxNnB4IDE2cHggMTZweCAhaW1wb3J0YW50Cg=="},{"version":3,"sources":["user.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+aA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user.vue","sourceRoot":"src/pages/app/wechat/user","sourcesContent":["<template>\n  <div>\n    <div class=\"i-layout-page-header header-title\">\n      <span class=\"ivu-page-header-title\">{{ $route.meta.title }}</span>\n    </div>\n    <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n      <div class=\"table_box\">\n        <Form\n          ref=\"formValidate\"\n          :model=\"formValidate\"\n          :label-width=\"labelWidth\"\n          :label-position=\"labelPosition\"\n          class=\"tabform\"\n          @submit.native.prevent\n        >\n          <Row :gutter=\"24\" type=\"flex\" justify=\"end\">\n            <Col span=\"24\" class=\"ivu-text-left\">\n              <FormItem :label=\"fromList.title + '：'\">\n                <RadioGroup\n                  type=\"button\"\n                  v-model=\"formValidate.data\"\n                  class=\"mr15\"\n                  @on-change=\"selectChange(formValidate.data)\"\n                >\n                  <Radio :label=\"itemn.val\" v-for=\"(itemn, indexn) in fromList.fromTxt\" :key=\"indexn\">\n                    {{ itemn.text }}\n                  </Radio>\n                </RadioGroup>\n                <DatePicker\n                  :editable=\"false\"\n                  @on-change=\"onchangeTime\"\n                  :value=\"timeVal\"\n                  format=\"yyyy/MM/dd\"\n                  type=\"daterange\"\n                  placement=\"bottom-end\"\n                  placeholder=\"请选择时间\"\n                  style=\"width: 200px\"\n                ></DatePicker>\n              </FormItem>\n            </Col>\n            <Col span=\"24\" class=\"ivu-text-left\">\n              <FormItem label=\"用户分组：\">\n                <RadioGroup type=\"button\" v-model=\"formValidate.groupid\">\n                  <Radio :label=\"item.id\" v-for=\"(item, index) in groupList\" :key=\"index\">{{ item.name }}</Radio>\n                </RadioGroup>\n              </FormItem>\n            </Col>\n            <Col span=\"24\" class=\"ivu-text-left\">\n              <FormItem label=\"用户标签：\">\n                <TagSelect v-model=\"tagidList\">\n                  <TagSelectOption :name=\"item.id\" v-for=\"(item, index) in tagList\" :key=\"index\">{{\n                    item.name\n                  }}</TagSelectOption>\n                </TagSelect>\n              </FormItem>\n            </Col>\n            <Col span=\"24\" class=\"ivu-text-left\">\n              <Col :xl=\"7\" :lg=\"12\" :md=\"12\" :sm=\"24\" :xs=\"24\">\n                <FormItem label=\"用户名称：\">\n                  <Input placeholder=\"请输入用户名称\" v-model=\"formValidate.nickname\" class=\"perW90\"></Input>\n                </FormItem>\n              </Col>\n              <Col :xl=\"7\" :lg=\"12\" :md=\"12\" :sm=\"24\" :xs=\"24\" class=\"sex_box\">\n                <FormItem label=\"性别：\">\n                  <Select v-model=\"formValidate.sex\" style=\"width: 90%\" clearable>\n                    <Option value=\"1\">男</Option>\n                    <Option value=\"2\">女</Option>\n                    <Option value=\"0\">保密</Option>\n                  </Select>\n                </FormItem>\n              </Col>\n              <Col :xl=\"7\" :lg=\"12\" :md=\"12\" :sm=\"24\" :xs=\"24\" class=\"subscribe_box\">\n                <FormItem label=\"是否关注公众号：\">\n                  <Select v-model=\"formValidate.subscribe\" style=\"width: 90%\" clearable>\n                    <Option value=\"1\">是</Option>\n                    <Option value=\"0\">否</Option>\n                  </Select>\n                </FormItem>\n              </Col>\n              <Col :xl=\"3\" :lg=\"3\" :md=\"3\" :sm=\"24\" :xs=\"24\" class=\"btn_box\">\n                <FormItem>\n                  <Button type=\"primary\" icon=\"ios-search\" label=\"default\" class=\"userSearch\" @click=\"userSearchs\"\n                    >搜索</Button\n                  >\n                </FormItem>\n              </Col>\n            </Col>\n            <Divider dashed />\n            <Col span=\"24\">\n              <Button type=\"primary\" class=\"mr20\" @click=\"onSend\">发送优惠券</Button>\n              <Button class=\"greens mr20\" size=\"default\" @click=\"onSendPic\">\n                <Icon type=\"md-list\"></Icon>\n                发送图文消息\n              </Button>\n            </Col>\n          </Row>\n        </Form>\n      </div>\n      <Table\n        ref=\"selection\"\n        :columns=\"columns4\"\n        :data=\"tabList\"\n        :loading=\"loading\"\n        no-data-text=\"暂无数据\"\n        highlight-row\n        class=\"mt25\"\n        no-filtered-data-text=\"暂无筛选结果\"\n        @on-selection-change=\"onSelectTab\"\n      >\n        <template slot-scope=\"{ row, index }\" slot=\"headimgurl\">\n          <div class=\"tabBox_img\" v-viewer>\n            <img v-lazy=\"row.headimgurl\" />\n          </div>\n        </template>\n        <template slot-scope=\"{ row }\" slot=\"sex\">\n          <span v-show=\"row.sex === 1\">男</span>\n          <span v-show=\"row.sex === 2\">女</span>\n          <span v-show=\"row.sex === 0\">保密</span>\n        </template>\n        <template slot-scope=\"{ row }\" slot=\"country\">\n          <span>{{ row.country + row.province + row.city }}</span>\n        </template>\n        <template slot-scope=\"{ row }\" slot=\"subscribe\">\n          <span v-show=\"row.subscribe === 1\">关注</span>\n          <span v-show=\"row.subscribe === 0\">未关注</span>\n        </template>\n        <template slot-scope=\"{ row }\" slot=\"createModalFrame\">\n          <template>\n            <Dropdown @on-click=\"changeMenu(row, $event)\">\n              <a href=\"javascript:void(0)\"\n                >操作\n                <Icon type=\"ios-arrow-down\"></Icon>\n              </a>\n              <DropdownMenu slot=\"list\">\n                <DropdownItem name=\"1\" v-show=\"row.subscribe\">修改分组</DropdownItem>\n                <DropdownItem name=\"2\" v-show=\"row.subscribe\">修改标签</DropdownItem>\n                <DropdownItem name=\"3\" v-show=\"row.subscribe\">同步标签</DropdownItem>\n                <DropdownItem v-show=\"!row.subscribe\">无法操作</DropdownItem>\n              </DropdownMenu>\n            </Dropdown>\n          </template>\n        </template>\n      </Table>\n      <div class=\"acea-row row-right page\">\n        <Page :total=\"total\" show-elevator show-total @on-change=\"pageChange\" :page-size=\"formValidate.limit\" />\n      </div>\n    </Card>\n    <!-- 用户分组和标签编辑-->\n    <edit-from ref=\"edits\" :FromData=\"FromData\" @submitFail=\"submitFail\"></edit-from>\n    <!-- 发送优惠券-->\n    <send-from ref=\"sends\" :userIds=\"user_ids\"></send-from>\n    <!--发送图文消息 -->\n    <Modal\n      v-model=\"modal13\"\n      scrollable\n      title=\"发送消息\"\n      :z-index=\"100\"\n      width=\"1200\"\n      height=\"800\"\n      footer-hide\n      class=\"modelBox\"\n    >\n      <news-category\n        v-if=\"modal13\"\n        :isShowSend=\"isShowSend\"\n        :userIds=\"user_ids\"\n        :scrollerHeight=\"scrollerHeight\"\n        :contentTop=\"contentTop\"\n        :contentWidth=\"contentWidth\"\n        :maxCols=\"maxCols\"\n      ></news-category>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { wechatUserListtApi, tagListtApi, groupsEditApi } from '@/api/app';\nimport newsCategory from '@/components/newsCategory/index';\nimport editFrom from '@/components/from/from';\nimport sendFrom from '@/components/sendCoupons/index';\nexport default {\n  name: 'user',\n  components: {\n    newsCategory,\n    editFrom,\n    sendFrom,\n  },\n  data() {\n    return {\n      tagidList: [],\n      isShowSend: true,\n      maxCols: 4,\n      scrollerHeight: '600',\n      contentTop: '130',\n      contentWidth: '98%',\n      modal13: false,\n      timeVal: [],\n      fromList: {\n        title: '选择时间',\n        custom: true,\n        fromTxt: [\n          { text: '全部', val: '' },\n          { text: '今天', val: 'today' },\n          { text: '昨天', val: 'yesterday' },\n          { text: '最近7天', val: 'lately7' },\n          { text: '最近30天', val: 'lately30' },\n          { text: '本月', val: 'month' },\n          { text: '本年', val: 'year' },\n        ],\n      },\n      formValidate: {\n        limit: 15,\n        page: 1,\n        nickname: '',\n        data: '',\n        tagid_list: '',\n        sex: '',\n        groupid: 0,\n        subscribe: '',\n        export: 2,\n      },\n      loading: false,\n      tabList: [],\n      total: 0,\n      value2: '',\n      grid: {\n        xl: 8,\n        lg: 8,\n        md: 8,\n        sm: 24,\n        xs: 24,\n      },\n      columns4: [\n        {\n          type: 'selection',\n          min: 60,\n          align: 'center',\n        },\n        {\n          title: 'ID',\n          key: 'uid',\n        },\n        {\n          title: '微信用户名称',\n          key: 'nickname',\n        },\n        {\n          title: '头像',\n          slot: 'headimgurl',\n        },\n        {\n          title: '性别',\n          slot: 'sex',\n        },\n        {\n          title: '地区',\n          slot: 'country',\n        },\n        {\n          title: '是否关注公众号',\n          slot: 'subscribe',\n        },\n        {\n          title: '用户分组',\n          key: 'groupid',\n        },\n        {\n          title: '用户标签',\n          key: 'tagid_list',\n        },\n        {\n          title: '操作',\n          slot: 'createModalFrame',\n          fixed: 'right',\n          width: 100,\n        },\n      ],\n      tagList: [],\n      groupList: [],\n      FromData: null,\n      selectionList: [],\n      user_ids: '',\n    };\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : 80;\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  created() {\n    this.getListTag();\n    this.getList();\n  },\n  methods: {\n    // 操作\n    changeMenu(row, name) {\n      switch (name) {\n        case '1':\n          this.editGroup(`app/wechat/user_group/${row.openid}/edit`);\n          break;\n        case '2':\n          this.editGroup(`app/wechat/user_tag/${row.openid}/edit`);\n          break;\n        default:\n          let delfromData = {\n            title: '同步该用户标签',\n            url: `app/wechat/syn_tag/${row.openid}`,\n            method: 'PUT',\n            ids: '',\n          };\n          this.$modalSure(delfromData)\n            .then((res) => {\n              this.$Message.success(res.msg);\n              this.getList();\n            })\n            .catch((res) => {\n              this.$Message.error(res.msg);\n            });\n      }\n    },\n    // 修改用户分组 标签\n    editGroup(url) {\n      groupsEditApi(url)\n        .then(async (res) => {\n          this.FromData = res.data;\n          this.$refs.edits.modals = true;\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    // 修改成功\n    submitFail() {\n      this.getList();\n    },\n    // 同步标签\n    submitModel() {\n      this.getList();\n    },\n    // 点击发送优惠券\n    onSend() {\n      if (this.selectionList.length === 0) {\n        this.$Message.warning('请选择要发送优惠券的用户');\n      } else {\n        this.$refs.sends.modals = true;\n        this.$refs.sends.getList();\n      }\n    },\n    // 发送图文消息\n    onSendPic() {\n      if (this.selectionList.length === 0) {\n        this.$Message.warning('请选择要发送图文消息的用户');\n      } else {\n        this.modal13 = true;\n      }\n    },\n    // 全选\n    onSelectTab(selection) {\n      this.selectionList = selection;\n      let data = [];\n      this.selectionList.map((item) => {\n        data.push(item.uid);\n      });\n      this.user_ids = data.join(',');\n    },\n    // 具体日期\n    onchangeTime(e) {\n      this.timeVal = e;\n      this.formValidate.data = this.timeVal.join('-');\n      this.getList();\n    },\n    // 选择时间\n    selectChange(tab) {\n      this.formValidate.data = tab;\n      this.timeVal = [];\n      this.getList();\n    },\n    // 标签 分组\n    getListTag() {\n      let obj = {\n        id: '',\n        name: '全部',\n      };\n      tagListtApi()\n        .then(async (res) => {\n          let data = res.data;\n          this.tagList = data.tagList;\n          this.groupList = data.groupList;\n          this.groupList.unshift(obj);\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    // 列表\n    getList() {\n      this.loading = true;\n      this.formValidate.sex = this.formValidate.sex || '';\n      this.formValidate.subscribe = this.formValidate.subscribe || '';\n      this.formValidate.tagid_list = this.tagidList.join(',');\n      wechatUserListtApi(this.formValidate)\n        .then(async (res) => {\n          let data = res.data;\n          this.tabList = data.list;\n          this.total = data.count;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    pageChange(index) {\n      this.formValidate.page = index;\n      this.getList();\n    },\n    // 搜索\n    userSearchs() {\n      this.getList();\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"stylus\">\n.Refresh\n    font-size 12px\n    color #1890FF\n    cursor pointer\n.userFrom\n    >>> .ivu-form-item-content\n        margin-left: 0px !important\n.tabBox_img\n    width 36px\n    height 36px\n    border-radius:4px\n    cursor pointer\n    img\n        width 100%\n        height 100%\n.subscribe_box\n   >>> .ivu-form-item-label\n      width 110px !important\n   >>> .ivu-form-item-content\n      margin-left  110px !important\n.sex_box\n    >>> .ivu-form-item-label\n      width 60px !important\n    >>> .ivu-form-item-content\n      margin-left  60px !important\n.btn_box\n    >>> .ivu-form-item-content\n      margin-left 0 !important\n.modelBox\n    >>> .ivu-modal-body\n        padding 0 16px 16px 16px !important\n</style>\n"]}]}