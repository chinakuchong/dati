{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/crud/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/crud/index.vue","mtime":1689324015201},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IGNydWRBcGksIGdldExpc3QsIGdldENyZWF0ZUFwaSwgZ2V0RWRpdEFwaSB9IGZyb20gJ0AvYXBpL2NydWQuanMnOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICd1c2VyX3JlY2hhcmdlJywKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZ3JpZDogewogICAgICAgIHhsOiA3LAogICAgICAgIGxnOiA3LAogICAgICAgIG1kOiAxMiwKICAgICAgICBzbTogMjQsCiAgICAgICAgeHM6IDI0LAogICAgICB9LAogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgY29sdW1uczogW10sCiAgICAgIGZyb206IHsKICAgICAgICBwYWdlOiAxLAogICAgICAgIGxpbWl0OiAxNSwKICAgICAgfSwKICAgICAgZGF0YUxpc3Q6IFtdLAogICAgICB0b3RhbDogMCwKICAgICAgbWV0aG9kQXBpOiB7fSwKICAgICAgY3VyZEtleTogJycsCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKCdtZWRpYScsIFsnaXNNb2JpbGUnXSksCiAgICBsYWJlbFdpZHRoKCkgewogICAgICByZXR1cm4gdGhpcy5pc01vYmlsZSA/IHVuZGVmaW5lZCA6IDc1OwogICAgfSwKICAgIGxhYmVsUG9zaXRpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gJ3RvcCcgOiAnbGVmdCc7CiAgICB9LAogIH0sCiAgYmVmb3JlUm91dGVVcGRhdGUodG8sIGZyb20sIG5leHQpIHsKICAgIHRoaXMuZnJvbS5wYWdlID0gMTsKICAgIHRoaXMuZ2V0Q3J1ZEFwaSh0by5wYXJhbXMudGFibGVfbmFtZSk7CiAgICBuZXh0KCk7CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRDcnVkQXBpKHRoaXMuJHJvdXRlLnBhcmFtcy50YWJsZV9uYW1lKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldENydWRBcGkodGFibGVOYW1lKSB7CiAgICAgIGNydWRBcGkodGFibGVOYW1lKS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLm1ldGhvZEFwaSA9IHJlcy5kYXRhLnJvdXRlOwogICAgICAgIHRoaXMuY3VyZEtleSA9IHJlcy5kYXRhLmtleTsKICAgICAgICByZXMuZGF0YS5jb2x1bW5zLnB1c2goewogICAgICAgICAgdGl0bGU6ICfmk43kvZwnLAogICAgICAgICAgc2xvdDogJ2FjdGlvbicsCiAgICAgICAgICBmaXhlZDogJ3JpZ2h0JywKICAgICAgICAgIHdpZHRoOiAxMDAsCiAgICAgICAgICBhbGlnbjogJ2NlbnRlcicsCiAgICAgICAgfSk7CiAgICAgICAgcmVzLmRhdGEuY29sdW1ucy5tYXAoKGl0ZW0pID0+IHsKICAgICAgICAgIGlmIChpdGVtLmZyb21fdHlwZSA9PT0gJ2ZyYW1lSW1hZ2VPbmUnKSB7CiAgICAgICAgICAgIGl0ZW0ucmVuZGVyID0gKGgsIHBhcmFtcykgPT4gewogICAgICAgICAgICAgIHJldHVybiBoKAogICAgICAgICAgICAgICAgJ2RpdicsCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGNsYXNzOiAndGFiQm94X2ltZycsCiAgICAgICAgICAgICAgICAgIGRpcmVjdGl2ZXM6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAndmlld2VyJywKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgaCgnaW1nJywgewogICAgICAgICAgICAgICAgICAgIGRpcmVjdGl2ZXM6IFsKICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2xhenknLAogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcGFyYW1zLnJvd1tpdGVtLnNsb3RdLAogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS5mcm9tX3R5cGUgPT09ICdmcmFtZUltYWdlcycpIHsKICAgICAgICAgICAgaXRlbS5yZW5kZXIgPSAoaCwgcGFyYW1zKSA9PiB7CiAgICAgICAgICAgICAgbGV0IGltYWdlID0gcGFyYW1zLnJvd1tpdGVtLnNsb3RdIHx8IFtdOwogICAgICAgICAgICAgIGxldCBpbWFnZUggPSBbXTsKICAgICAgICAgICAgICBpbWFnZS5tYXAoKGl0ZW0pID0+IHsKICAgICAgICAgICAgICAgIGltYWdlSC5wdXNoKAogICAgICAgICAgICAgICAgICBoKCdpbWcnLCB7CiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aXZlczogWwogICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAnbGF6eScsCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLAogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgcmV0dXJuIGgoCiAgICAgICAgICAgICAgICAnZGl2JywKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgY2xhc3M6ICd0YWJCb3hfaW1nJywKICAgICAgICAgICAgICAgICAgZGlyZWN0aXZlczogWwogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICd2aWV3ZXInLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgaW1hZ2VILAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5jb2x1bW5zID0gcmVzLmRhdGEuY29sdW1uczsKICAgICAgICB0aGlzLmdldExpc3QoKTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5re75YqgCiAgICBhZGQoKSB7CiAgICAgIGxldCB1cmwgPSB0aGlzLm1ldGhvZEFwaS5jcmVhdGU7CiAgICAgIHRoaXMuJG1vZGFsRm9ybShnZXRDcmVhdGVBcGkodXJsKSkudGhlbigoKSA9PiB0aGlzLmdldExpc3QoKSk7CiAgICB9LAogICAgLy/liJfooagKICAgIGdldExpc3QoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGxldCB1cmwgPSB0aGlzLm1ldGhvZEFwaS5pbmRleDsKICAgICAgZ2V0TGlzdCh1cmwsIHRoaXMuZnJvbSkKICAgICAgICAudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICBsZXQgZGF0YSA9IHJlcy5kYXRhOwogICAgICAgICAgdGhpcy5kYXRhTGlzdCA9IGRhdGEubGlzdDsKICAgICAgICAgIHRoaXMudG90YWwgPSBkYXRhLmNvdW50OwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIC8v5YiG6aG1CiAgICBwYWdlQ2hhbmdlKGluZGV4KSB7CiAgICAgIHRoaXMuZnJvbS5wYWdlID0gaW5kZXg7CiAgICAgIHRoaXMuZ2V0TGlzdCgpOwogICAgfSwKICAgIC8vIOS/ruaUuQogICAgZWRpdChyb3cpIHsKICAgICAgbGV0IHVybCA9IHRoaXMubWV0aG9kQXBpLmVkaXQucmVwbGFjZSgnPGlkPicsIHJvd1t0aGlzLmN1cmRLZXldKTsKICAgICAgdGhpcy4kbW9kYWxGb3JtKGdldEVkaXRBcGkodXJsKSkudGhlbigoKSA9PiB0aGlzLmdldExpc3QoKSk7CiAgICB9LAogICAgLy8g5Yig6ZmkCiAgICBkZWwocm93LCB0aXQsIG51bSkgewogICAgICBsZXQgdXJsID0gdGhpcy5tZXRob2RBcGkuZGVsZXRlLnJlcGxhY2UoJzxpZD4nLCByb3dbdGhpcy5jdXJkS2V5XSk7CiAgICAgIGxldCBkZWxmcm9tRGF0YSA9IHsKICAgICAgICB0aXRsZTogdGl0LAogICAgICAgIG51bTogbnVtLAogICAgICAgIHVybDogdXJsLAogICAgICAgIG1ldGhvZDogJ0RFTEVURScsCiAgICAgICAgaWRzOiAnJywKICAgICAgfTsKICAgICAgdGhpcy4kbW9kYWxTdXJlKGRlbGZyb21EYXRhKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJE1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICAgIHRoaXMuZ2V0TGlzdCgpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/crud","sourcesContent":["<template>\n  <div>\n    <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n      <Row type=\"flex\">\n        <Col v-bind=\"grid\">\n          <Button type=\"primary\" icon=\"md-add\" @click=\"add\">添加</Button>\n        </Col>\n      </Row>\n      <Table\n        :columns=\"columns\"\n        :data=\"dataList\"\n        ref=\"table\"\n        class=\"mt25\"\n        :loading=\"loading\"\n        highlight-row\n        no-userFrom-text=\"暂无数据\"\n        no-filtered-userFrom-text=\"暂无筛选结果\"\n      >\n        <template slot-scope=\"{ row, index }\" slot=\"action\">\n          <a @click=\"edit(row)\">修改</a>\n          <Divider type=\"vertical\" />\n          <a @click=\"del(row, '删除', index)\">删除</a>\n        </template>\n      </Table>\n      <div class=\"acea-row row-right page\">\n        <Page :total=\"total\" show-elevator show-total @on-change=\"pageChange\" :page-size=\"from.limit\" />\n      </div>\n    </Card>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport { crudApi, getList, getCreateApi, getEditApi } from '@/api/crud.js';\n\nexport default {\n  name: 'user_recharge',\n  data() {\n    return {\n      grid: {\n        xl: 7,\n        lg: 7,\n        md: 12,\n        sm: 24,\n        xs: 24,\n      },\n      loading: false,\n      columns: [],\n      from: {\n        page: 1,\n        limit: 15,\n      },\n      dataList: [],\n      total: 0,\n      methodApi: {},\n      curdKey: '',\n    };\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : 75;\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'left';\n    },\n  },\n  beforeRouteUpdate(to, from, next) {\n    this.from.page = 1;\n    this.getCrudApi(to.params.table_name);\n    next();\n  },\n  created() {\n    this.getCrudApi(this.$route.params.table_name);\n  },\n  methods: {\n    getCrudApi(tableName) {\n      crudApi(tableName).then((res) => {\n        this.methodApi = res.data.route;\n        this.curdKey = res.data.key;\n        res.data.columns.push({\n          title: '操作',\n          slot: 'action',\n          fixed: 'right',\n          width: 100,\n          align: 'center',\n        });\n        res.data.columns.map((item) => {\n          if (item.from_type === 'frameImageOne') {\n            item.render = (h, params) => {\n              return h(\n                'div',\n                {\n                  class: 'tabBox_img',\n                  directives: [\n                    {\n                      name: 'viewer',\n                    },\n                  ],\n                },\n                [\n                  h('img', {\n                    directives: [\n                      {\n                        name: 'lazy',\n                        value: params.row[item.slot],\n                      },\n                    ],\n                  }),\n                ],\n              );\n            };\n          } else if (item.from_type === 'frameImages') {\n            item.render = (h, params) => {\n              let image = params.row[item.slot] || [];\n              let imageH = [];\n              image.map((item) => {\n                imageH.push(\n                  h('img', {\n                    directives: [\n                      {\n                        name: 'lazy',\n                        value: item,\n                      },\n                    ],\n                  }),\n                );\n              });\n              return h(\n                'div',\n                {\n                  class: 'tabBox_img',\n                  directives: [\n                    {\n                      name: 'viewer',\n                    },\n                  ],\n                },\n                imageH,\n              );\n            };\n          }\n        });\n        this.columns = res.data.columns;\n        this.getList();\n      });\n    },\n    // 添加\n    add() {\n      let url = this.methodApi.create;\n      this.$modalForm(getCreateApi(url)).then(() => this.getList());\n    },\n    //列表\n    getList() {\n      this.loading = true;\n      let url = this.methodApi.index;\n      getList(url, this.from)\n        .then(async (res) => {\n          let data = res.data;\n          this.dataList = data.list;\n          this.total = data.count;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    //分页\n    pageChange(index) {\n      this.from.page = index;\n      this.getList();\n    },\n    // 修改\n    edit(row) {\n      let url = this.methodApi.edit.replace('<id>', row[this.curdKey]);\n      this.$modalForm(getEditApi(url)).then(() => this.getList());\n    },\n    // 删除\n    del(row, tit, num) {\n      let url = this.methodApi.delete.replace('<id>', row[this.curdKey]);\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: url,\n        method: 'DELETE',\n        ids: '',\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$Message.success(res.msg);\n          this.getList();\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"stylus\"></style>\n"]}]}