{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/product/productAttr/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/product/productAttr/index.vue","mtime":1689324015247},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CmltcG9ydCBhZGRBdHRyIGZyb20gJy4vYWRkQXR0cic7CmltcG9ydCB7IHJ1bGVMaXN0QXBpIH0gZnJvbSAnQC9hcGkvcHJvZHVjdCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAncHJvZHVjdEF0dHInLAogIGNvbXBvbmVudHM6IHsgYWRkQXR0ciB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgYXJ0RnJvbTogewogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgbGltaXQ6IDE1LAogICAgICAgIHJ1bGVfbmFtZTogJycsCiAgICAgIH0sCiAgICAgIGNvbHVtbnM0OiBbCiAgICAgICAgewogICAgICAgICAgdHlwZTogJ3NlbGVjdGlvbicsCiAgICAgICAgICB3aWR0aDogNjAsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJ0lEJywKICAgICAgICAgIGtleTogJ2lkJywKICAgICAgICAgIHdpZHRoOiA4MCwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAn6KeE5qC85ZCN56ewJywKICAgICAgICAgIGtleTogJ3J1bGVfbmFtZScsCiAgICAgICAgICBtaW5XaWR0aDogMTUwLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICfllYblk4Hop4TmoLwnLAogICAgICAgICAga2V5OiAnYXR0cl9uYW1lJywKICAgICAgICAgIG1pbldpZHRoOiAyNTAsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogJ+WVhuWTgeWxnuaApycsCiAgICAgICAgICBzbG90OiAnYXR0cl92YWx1ZScsCiAgICAgICAgICBtaW5XaWR0aDogMzAwLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICfmk43kvZwnLAogICAgICAgICAgc2xvdDogJ2FjdGlvbicsCiAgICAgICAgICBmaXhlZDogJ3JpZ2h0JywKICAgICAgICAgIG1pbldpZHRoOiAxMjAsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgdGFibGVMaXN0OiBbXSwKICAgICAgdG90YWw6IDAsCiAgICAgIHNlbGVjdGVkSWRzOiBuZXcgU2V0KCksIC8v6YCJ5Lit5ZCI5bm26aG555qEaWQKICAgICAgaWRzOiAnJywKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoJ2FkbWluL29yZGVyJywgWydvcmRlckNoYXJ0VHlwZSddKSwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldERhdGFMaXN0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAvL+WFqOmAieWSjOWPlua2iOWFqOmAieaXtuinpuWPkQogICAgaGFuZGxlU2VsZWN0QWxsKHNlbGVjdGlvbikgewogICAgICBpZiAoc2VsZWN0aW9uLmxlbmd0aCA9PT0gMCkgewogICAgICAgIC8v6I635Y+WdGFibGXnmoTmlbDmja7vvJsKICAgICAgICBsZXQgZGF0YSA9IHRoaXMuJHJlZnMudGFibGUuZGF0YTsKICAgICAgICBkYXRhLmZvckVhY2goKGl0ZW0pID0+IHsKICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkSWRzLmhhcyhpdGVtLmlkKSkgewogICAgICAgICAgICB0aGlzLnNlbGVjdGVkSWRzLmRlbGV0ZShpdGVtLmlkKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZWxlY3Rpb24uZm9yRWFjaCgoaXRlbSkgPT4gewogICAgICAgICAgdGhpcy5zZWxlY3RlZElkcy5hZGQoaXRlbS5pZCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIC8v56Gu5L+dZG9t5Yqg6L295a6M5q+VCiAgICAgICAgdGhpcy5zZXRDaGVja2VkKCk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vICDpgInkuK3mn5DkuIDooYwKICAgIGhhbmRsZVNlbGVjdFJvdyhzZWxlY3Rpb24sIHJvdykgewogICAgICB0aGlzLnNlbGVjdGVkSWRzLmFkZChyb3cuaWQpOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgLy/noa7kv51kb23liqDovb3lrozmr5UKICAgICAgICB0aGlzLnNldENoZWNrZWQoKTsKICAgICAgfSk7CiAgICB9LAogICAgLy8gIOWPlua2iOafkOS4gOihjAogICAgaGFuZGxlQ2FuY2VsUm93KHNlbGVjdGlvbiwgcm93KSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRJZHMuZGVsZXRlKHJvdy5pZCk7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAvL+ehruS/nWRvbeWKoOi9veWujOavlQogICAgICAgIHRoaXMuc2V0Q2hlY2tlZCgpOwogICAgICB9KTsKICAgIH0sCiAgICBzZXRDaGVja2VkKCkgewogICAgICAvL+Wwhm5ldyBTZXQoKei9rOWMluS4uuaVsOe7hAogICAgICB0aGlzLmlkcyA9IFsuLi50aGlzLnNlbGVjdGVkSWRzXS5qb2luKCcsJyk7CiAgICAgIC8vIOaJvuWIsOe7keWumueahHRhYmxl55qEcmVm5a+55bqU55qEZG9t77yM5om+5YiwdGFibGXnmoRvYmpEYXRh5a+56LGh77yMb2JqRGF0YeS/neWtmOeahOaYr+W9k+WJjemhteeahOaVsOaNrgogICAgICBsZXQgb2JqRGF0YSA9IHRoaXMuJHJlZnMudGFibGUub2JqRGF0YTsKICAgICAgZm9yIChsZXQgaW5kZXggaW4gb2JqRGF0YSkgewogICAgICAgIGlmICh0aGlzLnNlbGVjdGVkSWRzLmhhcyhvYmpEYXRhW2luZGV4XS5pZCkpIHsKICAgICAgICAgIG9iakRhdGFbaW5kZXhdLl9pc0NoZWNrZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOWIoOmZpAogICAgZGVsKHJvdywgdGl0KSB7CiAgICAgIGxldCBkYXRhID0ge307CiAgICAgIGlmICh0aXQgPT09ICfmibnph4/liKDpmaTop4TmoLwnKSB7CiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJZHMuc2l6ZSA9PT0gMCkgcmV0dXJuIHRoaXMuJE1lc3NhZ2Uud2FybmluZygn6K+36YCJ5oup6KaB5Yig6Zmk55qE6KeE5qC877yBJyk7CiAgICAgICAgZGF0YSA9IHsKICAgICAgICAgIGlkczogdGhpcy5pZHMsCiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkYXRhID0gewogICAgICAgICAgaWRzOiByb3cuaWQsCiAgICAgICAgfTsKICAgICAgfQogICAgICBsZXQgZGVsZnJvbURhdGEgPSB7CiAgICAgICAgdGl0bGU6IHRpdCwKICAgICAgICBudW06IDAsCiAgICAgICAgdXJsOiBgcHJvZHVjdC9wcm9kdWN0L3J1bGUvZGVsZXRlYCwKICAgICAgICBtZXRob2Q6ICdERUxFVEUnLAogICAgICAgIGlkczogZGF0YSwKICAgICAgfTsKICAgICAgdGhpcy4kbW9kYWxTdXJlKGRlbGZyb21EYXRhKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJE1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIGFkZEF0dHIoKSB7CiAgICAgIHRoaXMuJHJlZnMuYWRkYXR0ci5tb2RhbCA9IHRydWU7CiAgICB9LAogICAgLy8g57yW6L6RCiAgICBlZGl0KHJvdykgewogICAgICB0aGlzLiRyZWZzLmFkZGF0dHIubW9kYWwgPSB0cnVlOwogICAgICB0aGlzLiRyZWZzLmFkZGF0dHIuZ2V0SW9mbyhyb3cpOwogICAgfSwKICAgIC8vIOWIl+ihqO+8mwogICAgZ2V0RGF0YUxpc3QoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIHJ1bGVMaXN0QXBpKHRoaXMuYXJ0RnJvbSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBsZXQgZGF0YSA9IHJlcy5kYXRhOwogICAgICAgICAgdGhpcy50YWJsZUxpc3QgPSBkYXRhLmxpc3Q7CiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgIC8v56Gu5L+dZG9t5Yqg6L295a6M5q+VCiAgICAgICAgICAgIHRoaXMuc2V0Q2hlY2tlZCgpOwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLnRvdGFsID0gcmVzLmRhdGEuY291bnQ7CiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgICAgfSk7CiAgICB9LAogICAgcGFnZUNoYW5nZShzdGF0dXMpIHsKICAgICAgdGhpcy5hcnRGcm9tLnBhZ2UgPSBzdGF0dXM7CiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsKICAgIH0sCiAgICAvLyDooajmoLzmkJzntKIKICAgIHVzZXJTZWFyY2hzKCkgewogICAgICB0aGlzLmFydEZyb20ucGFnZSA9IDE7CiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/product/productAttr","sourcesContent":["<template>\n  <div>\n    <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n      <Form\n        ref=\"artFrom\"\n        :model=\"artFrom\"\n        :label-width=\"80\"\n        label-position=\"right\"\n        class=\"tabform\"\n        @submit.native.prevent\n      >\n        <Row :gutter=\"24\" type=\"flex\" justify=\"end\">\n          <Col span=\"24\" class=\"ivu-text-left\">\n            <FormItem label=\"规格搜索：\">\n              <Input\n                search\n                enter-button\n                v-model=\"artFrom.rule_name\"\n                placeholder=\"请输入规格名称\"\n                style=\"width: 30%\"\n                @on-search=\"userSearchs\"\n              ></Input>\n            </FormItem>\n          </Col>\n          <Col span=\"24\">\n            <Button v-auth=\"['product-rule-save']\" class=\"mr20\" type=\"primary\" icon=\"md-add\" @click=\"addAttr\"\n              >添加商品规格</Button\n            >\n            <Button v-auth=\"['product-product-rule-delete']\" @click=\"del(null, '批量删除规格')\">批量删除</Button>\n          </Col>\n        </Row>\n      </Form>\n      <Table\n        class=\"mt25\"\n        ref=\"table\"\n        :columns=\"columns4\"\n        :data=\"tableList\"\n        :loading=\"loading\"\n        highlight-row\n        @on-select=\"handleSelectRow\"\n        @on-select-cancel=\"handleCancelRow\"\n        @on-select-all=\"handleSelectAll\"\n        @on-select-all-cancel=\"handleSelectAll\"\n        no-data-text=\"暂无数据\"\n        no-filtered-data-text=\"暂无筛选结果\"\n      >\n        <template slot-scope=\"{ row }\" slot=\"attr_value\">\n          <span v-for=\"(item, index) in row.attr_value\" :key=\"index\" v-text=\"item\" style=\"display: block\"></span>\n        </template>\n        <template slot-scope=\"{ row }\" slot=\"action\">\n          <a @click=\"edit(row)\">编辑</a>\n          <Divider type=\"vertical\" />\n          <a @click=\"del(row, '删除规格')\">删除</a>\n        </template>\n      </Table>\n      <div class=\"acea-row row-right page\">\n        <Page\n          :total=\"total\"\n          :current=\"artFrom.page\"\n          show-elevator\n          show-total\n          @on-change=\"pageChange\"\n          :page-size=\"artFrom.limit\"\n        />\n      </div>\n    </Card>\n    <add-attr ref=\"addattr\" @getList=\"userSearchs\"></add-attr>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport addAttr from './addAttr';\nimport { ruleListApi } from '@/api/product';\nexport default {\n  name: 'productAttr',\n  components: { addAttr },\n  data() {\n    return {\n      loading: false,\n      artFrom: {\n        page: 1,\n        limit: 15,\n        rule_name: '',\n      },\n      columns4: [\n        {\n          type: 'selection',\n          width: 60,\n        },\n        {\n          title: 'ID',\n          key: 'id',\n          width: 80,\n        },\n        {\n          title: '规格名称',\n          key: 'rule_name',\n          minWidth: 150,\n        },\n        {\n          title: '商品规格',\n          key: 'attr_name',\n          minWidth: 250,\n        },\n        {\n          title: '商品属性',\n          slot: 'attr_value',\n          minWidth: 300,\n        },\n        {\n          title: '操作',\n          slot: 'action',\n          fixed: 'right',\n          minWidth: 120,\n        },\n      ],\n      tableList: [],\n      total: 0,\n      selectedIds: new Set(), //选中合并项的id\n      ids: '',\n    };\n  },\n  computed: {\n    ...mapState('admin/order', ['orderChartType']),\n  },\n  created() {\n    this.getDataList();\n  },\n  methods: {\n    //全选和取消全选时触发\n    handleSelectAll(selection) {\n      if (selection.length === 0) {\n        //获取table的数据；\n        let data = this.$refs.table.data;\n        data.forEach((item) => {\n          if (this.selectedIds.has(item.id)) {\n            this.selectedIds.delete(item.id);\n          }\n        });\n      } else {\n        selection.forEach((item) => {\n          this.selectedIds.add(item.id);\n        });\n      }\n      this.$nextTick(() => {\n        //确保dom加载完毕\n        this.setChecked();\n      });\n    },\n    //  选中某一行\n    handleSelectRow(selection, row) {\n      this.selectedIds.add(row.id);\n      this.$nextTick(() => {\n        //确保dom加载完毕\n        this.setChecked();\n      });\n    },\n    //  取消某一行\n    handleCancelRow(selection, row) {\n      this.selectedIds.delete(row.id);\n      this.$nextTick(() => {\n        //确保dom加载完毕\n        this.setChecked();\n      });\n    },\n    setChecked() {\n      //将new Set()转化为数组\n      this.ids = [...this.selectedIds].join(',');\n      // 找到绑定的table的ref对应的dom，找到table的objData对象，objData保存的是当前页的数据\n      let objData = this.$refs.table.objData;\n      for (let index in objData) {\n        if (this.selectedIds.has(objData[index].id)) {\n          objData[index]._isChecked = true;\n        }\n      }\n    },\n    // 删除\n    del(row, tit) {\n      let data = {};\n      if (tit === '批量删除规格') {\n        if (this.selectedIds.size === 0) return this.$Message.warning('请选择要删除的规格！');\n        data = {\n          ids: this.ids,\n        };\n      } else {\n        data = {\n          ids: row.id,\n        };\n      }\n      let delfromData = {\n        title: tit,\n        num: 0,\n        url: `product/product/rule/delete`,\n        method: 'DELETE',\n        ids: data,\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$Message.success(res.msg);\n          this.getDataList();\n        })\n        .catch((res) => {\n          this.$Message.error(res.msg);\n        });\n    },\n    addAttr() {\n      this.$refs.addattr.modal = true;\n    },\n    // 编辑\n    edit(row) {\n      this.$refs.addattr.modal = true;\n      this.$refs.addattr.getIofo(row);\n    },\n    // 列表；\n    getDataList() {\n      this.loading = true;\n      ruleListApi(this.artFrom)\n        .then((res) => {\n          let data = res.data;\n          this.tableList = data.list;\n          this.$nextTick(() => {\n            //确保dom加载完毕\n            this.setChecked();\n          });\n          this.total = res.data.count;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$Message.error(res.msg);\n        });\n    },\n    pageChange(status) {\n      this.artFrom.page = status;\n      this.getDataList();\n    },\n    // 表格搜索\n    userSearchs() {\n      this.artFrom.page = 1;\n      this.getDataList();\n    },\n  },\n};\n</script>\n\n<style scoped></style>\n"]}]}