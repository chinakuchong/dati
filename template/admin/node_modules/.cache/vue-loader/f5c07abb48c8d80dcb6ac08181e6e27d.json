{"remainingRequest":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js??ref--0-2!/Volumes/mac/webwork/2023/dati/template/admin/src/pages/marketing/live/add_goods.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/mac/webwork/2023/dati/template/admin/src/pages/marketing/live/add_goods.vue","mtime":1689324015221},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/mac/webwork/2023/dati/template/admin/node_modules/iview-loader/index.js","mtime":1570440814000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CmltcG9ydCBnb29kc0xpc3QgZnJvbSAnQC9jb21wb25lbnRzL2dvb2RzTGlzdCc7CmltcG9ydCB7IGxpdmVHb29kc0NyZWF0LCBsaXZlR29vZHNBZGQgfSBmcm9tICdAL2FwaS9saXZlJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdhZGRfZ29vZHMnLAogIGNvbXBvbmVudHM6IHsKICAgIGdvb2RzTGlzdCwKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgnbWVkaWEnLCBbJ2lzTW9iaWxlJ10pLAogICAgbGFiZWxXaWR0aCgpIHsKICAgICAgcmV0dXJuIHRoaXMuaXNNb2JpbGUgPyB1bmRlZmluZWQgOiAxMDA7CiAgICB9LAogICAgbGFiZWxQb3NpdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaXNNb2JpbGUgPyAndG9wJyA6ICdyaWdodCc7CiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzU2hvd0JveDogZmFsc2UsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBtb2RhbHM6IGZhbHNlLAogICAgICBnb29kc0xpc3Q6IFtdLAogICAgICB0ZW1wR29vZHM6IHt9LAogICAgICBmb3JtVmFsaWRhdGU6IHt9LAogICAgICBjb2x1bW5zMTogWwogICAgICAgIHsga2V5OiAnaWQnLCB0aXRsZTogJ+WVhuWTgUlEJyB9LAogICAgICAgIHsgc2xvdDogJ2ltZycsIHRpdGxlOiAn5ZWG5ZOB5L+h5oGvJyB9LAogICAgICAgIHsga2V5OiAncHJpY2UnLCB0aXRsZTogJ+ebtOaSreWUruS7tycgfSwKICAgICAgICAvLyB7CiAgICAgICAgLy8gICBrZXk6ICdwcmljZScsCiAgICAgICAgLy8gICB0aXRsZTogJ+ebtOaSreWUruS7tycsCiAgICAgICAgLy8gICByZW5kZXI6IChoLCBwYXJhbXMpID0+IHsKICAgICAgICAvLyAgICAgcmV0dXJuIGgoJ0lucHV0JywgewogICAgICAgIC8vICAgICAgIHByb3BzOiB7CiAgICAgICAgLy8gICAgICAgICB0eXBlOiAnbnVtYmVyJywKICAgICAgICAvLyAgICAgICAgIHZhbHVlOiBwYXJhbXMucm93LnByaWNlLAogICAgICAgIC8vICAgICAgIH0sCiAgICAgICAgLy8gICAgICAgb246IHsKICAgICAgICAvLyAgICAgICAgIGlucHV0OiAodmFsKSA9PiB7CiAgICAgICAgLy8gICAgICAgICAgIHRoaXMudGFiTGlzdFtwYXJhbXMuaW5kZXhdLnByaWNlID0gdmFsOwogICAgICAgIC8vICAgICAgICAgfSwKICAgICAgICAvLyAgICAgICB9LAogICAgICAgIC8vICAgICB9KTsKICAgICAgICAvLyAgIH0sCiAgICAgICAgLy8gfSwKICAgICAgICAvLyB7CiAgICAgICAgLy8gICBrZXk6ICdjb3N0X3ByaWNlJywKICAgICAgICAvLyAgIHRpdGxlOiAn55u05pKt5Y6f5Lu3JywKICAgICAgICAvLyAgIHJlbmRlcjogKGgsIHBhcmFtcykgPT4gewogICAgICAgIC8vICAgICByZXR1cm4gaCgnSW5wdXQnLCB7CiAgICAgICAgLy8gICAgICAgcHJvcHM6IHsKICAgICAgICAvLyAgICAgICAgIHR5cGU6ICdudW1iZXInLAogICAgICAgIC8vICAgICAgICAgdmFsdWU6IHBhcmFtcy5yb3cuY29zdF9wcmljZSwKICAgICAgICAvLyAgICAgICB9LAogICAgICAgIC8vICAgICAgIG9uOiB7CiAgICAgICAgLy8gICAgICAgICBpbnB1dDogKHZhbCkgPT4gewogICAgICAgIC8vICAgICAgICAgICB0aGlzLnRhYkxpc3RbcGFyYW1zLmluZGV4XS5jb3N0X3ByaWNlID0gdmFsOwogICAgICAgIC8vICAgICAgICAgfSwKICAgICAgICAvLyAgICAgICB9LAogICAgICAgIC8vICAgICB9KTsKICAgICAgICAvLyAgIH0sCiAgICAgICAgLy8gfSwKICAgICAgICB7IGtleTogJ3N0b2NrJywgdGl0bGU6ICflupPlrZgnIH0sCiAgICAgICAgeyBzbG90OiAnYWN0aW9uJywgZml4ZWQ6ICdyaWdodCcsIHRpdGxlOiAn5pON5L2cJyB9LAogICAgICBdLAogICAgICB0YWJMaXN0OiBbXSwKICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICBsb2FkaW5nczogZmFsc2UsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgc2VsZWN0R29vZHMoKSB7CiAgICAgIHRoaXMubW9kYWxzID0gdHJ1ZTsKICAgICAgdGhpcy5zZWxlY3RJZHMgPSB0aGlzLmdvb2RzTGlzdC5tYXAoKGkpID0+IHsKICAgICAgICByZXR1cm4gaS5wcm9kdWN0X2lkOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDnlJ/miJDnm7Tmkq3llYblk4EKICAgIGxpdmVHb29kcygpIHsKICAgICAgbGV0IGFycmF5ID0gW107CiAgICAgIHRoaXMuZ29vZHNMaXN0Lm1hcCgoZWwpID0+IHsKICAgICAgICBhcnJheS5wdXNoKGVsLnByb2R1Y3RfaWQpOwogICAgICB9KTsKICAgICAgbGl2ZUdvb2RzQ3JlYXQoewogICAgICAgIHByb2R1Y3RfaWQ6IGFycmF5LAogICAgICB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMudGFiTGlzdCA9IHJlcy5kYXRhOwogICAgICAgICAgdGhpcy5pc1Nob3dCb3ggPSB0cnVlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcihlcnJvci5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIGdldFByb2R1Y3RJZChkYXRhKSB7CiAgICAgIHRoaXMuZ29vZHNMaXN0ID0gZGF0YTsKICAgICAgdGhpcy4kbmV4dFRpY2soKHJlcykgPT4gewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgdGhpcy5tb2RhbHMgPSBmYWxzZTsKICAgICAgICB9LCAzMDApOwogICAgICB9KTsKICAgIH0sCiAgICBiaW5kRGVsZXRlKGluZGV4LCBpdGVtKSB7CiAgICAgIHRoaXMuZ29vZHNMaXN0LnNwbGljZShpbmRleCwgMSk7CiAgICAgIGxldCBpID0gdGhpcy50YWJMaXN0LmZpbmRJbmRleCgoZSkgPT4gZS5pZCA9PSBpdGVtLnByb2R1Y3RfaWQpOwogICAgICB0aGlzLnRhYkxpc3Quc3BsaWNlKGksIDEpOwogICAgICBpZiAoIXRoaXMuZ29vZHNMaXN0Lmxlbmd0aCkgewogICAgICAgIHRoaXMuaXNTaG93Qm94ID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBkZWwocm93LCBpbmRleCkgewogICAgICB0aGlzLnRhYkxpc3Quc3BsaWNlKGluZGV4LCAxKTsKICAgICAgbGV0IGkgPSB0aGlzLmdvb2RzTGlzdC5maW5kSW5kZXgoKGUpID0+IGUucHJvZHVjdF9pZCA9PSByb3cuaWQpOwogICAgICB0aGlzLmdvb2RzTGlzdC5zcGxpY2UoaSwgMSk7CiAgICAgIGlmICghdGhpcy50YWJMaXN0Lmxlbmd0aCkgewogICAgICAgIHRoaXMuaXNTaG93Qm94ID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICAvLyDmj5DkuqQKICAgIGJpbmRTdWIoKSB7CiAgICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLmxvYWRpbmdzID0gdHJ1ZTsKICAgICAgbGl2ZUdvb2RzQWRkKHsKICAgICAgICBnb29kc19pbmZvOiB0aGlzLnRhYkxpc3QsCiAgICAgIH0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kTWVzc2FnZS5zdWNjZXNzKCfmt7vliqDmiJDlip8nKTsKICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6IHRoaXMuJHJvdXRlUHJvU3RyICsgJy9tYXJrZXRpbmcvbGl2ZS9saXZlX2dvb2RzJyB9KTsKICAgICAgICAgIH0sIDUwMCk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICB0aGlzLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKGVycm9yLm1zZyk7CiAgICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["add_goods.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"add_goods.vue","sourceRoot":"src/pages/marketing/live","sourcesContent":["<template>\n  <div>\n    <div class=\"i-layout-page-header header-title\">\n      <div class=\"fl_header\">\n        <span>\n          <Button icon=\"ios-arrow-back\" size=\"small\" type=\"text\" @click=\"$router.go(-1)\">返回</Button>\n        </span>\n        <Divider type=\"vertical\" />\n        <span class=\"ivu-page-header-title\">{{ $route.meta.title }}</span>\n      </div>\n    </div>\n    <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n      <Form\n        ref=\"formValidate\"\n        :model=\"formValidate\"\n        :label-width=\"labelWidth\"\n        :label-position=\"labelPosition\"\n        class=\"tabform\"\n        @submit.native.prevent\n      >\n        <Row :gutter=\"24\" type=\"flex\">\n          <Col span=\"24\">\n            <FormItem label=\"选择商品：\">\n              <div class=\"box\">\n                <div class=\"box-item\" v-for=\"(item, index) in goodsList\" :key=\"index\">\n                  <img :src=\"item.image\" alt=\"\" />\n                  <Icon type=\"ios-close-circle\" size=\"20\" @click=\"bindDelete(index, item)\" />\n                </div>\n                <div class=\"upload-box\" @click=\"selectGoods\">\n                  <Icon type=\"ios-camera-outline\" size=\"36\" />\n                </div>\n              </div>\n            </FormItem>\n          </Col>\n        </Row>\n      </Form>\n      <div class=\"active-btn\" v-if=\"goodsList.length > 0\">\n        <Button type=\"success\" @click=\"liveGoods\">生成直播商品</Button>\n      </div>\n      <div class=\"table-box\" v-if=\"isShowBox\">\n        <Table\n          :columns=\"columns1\"\n          :data=\"tabList\"\n          ref=\"table\"\n          class=\"mt25\"\n          :loading=\"loading\"\n          no-userFrom-text=\"暂无数据\"\n          no-filtered-userFrom-text=\"暂无筛选结果\"\n        >\n          <template slot-scope=\"{ row, index }\" slot=\"img\">\n            <div class=\"product_box\">\n              <img :src=\"row.image\" alt=\"\" />\n              <span>{{ row.store_name }}</span>\n            </div>\n          </template>\n          <template slot-scope=\"{ row, index }\" slot=\"action\">\n            <a @click=\"del(row, index)\">删除</a>\n          </template>\n        </Table>\n\n        <div class=\"sub_btn\">\n          <Button type=\"primary\" style=\"width: 8%\" @click=\"bindSub\" :disabled=\"disabled\" :loading=\"loadings\"\n            >提交</Button\n          >\n        </div>\n      </div>\n    </Card>\n    <Modal v-model=\"modals\" title=\"商品列表\" class=\"paymentFooter\" scrollable width=\"900\" :footer-hide=\"true\">\n      <goods-list\n        ref=\"goodslist\"\n        :selectIds=\"selectIds\"\n        @getProductId=\"getProductId\"\n        v-if=\"modals\"\n        :ischeckbox=\"true\"\n      ></goods-list>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport goodsList from '@/components/goodsList';\nimport { liveGoodsCreat, liveGoodsAdd } from '@/api/live';\nexport default {\n  name: 'add_goods',\n  components: {\n    goodsList,\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : 100;\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  data() {\n    return {\n      isShowBox: false,\n      loading: false,\n      modals: false,\n      goodsList: [],\n      tempGoods: {},\n      formValidate: {},\n      columns1: [\n        { key: 'id', title: '商品ID' },\n        { slot: 'img', title: '商品信息' },\n        { key: 'price', title: '直播售价' },\n        // {\n        //   key: 'price',\n        //   title: '直播售价',\n        //   render: (h, params) => {\n        //     return h('Input', {\n        //       props: {\n        //         type: 'number',\n        //         value: params.row.price,\n        //       },\n        //       on: {\n        //         input: (val) => {\n        //           this.tabList[params.index].price = val;\n        //         },\n        //       },\n        //     });\n        //   },\n        // },\n        // {\n        //   key: 'cost_price',\n        //   title: '直播原价',\n        //   render: (h, params) => {\n        //     return h('Input', {\n        //       props: {\n        //         type: 'number',\n        //         value: params.row.cost_price,\n        //       },\n        //       on: {\n        //         input: (val) => {\n        //           this.tabList[params.index].cost_price = val;\n        //         },\n        //       },\n        //     });\n        //   },\n        // },\n        { key: 'stock', title: '库存' },\n        { slot: 'action', fixed: 'right', title: '操作' },\n      ],\n      tabList: [],\n      disabled: false,\n      loadings: false,\n    };\n  },\n  methods: {\n    selectGoods() {\n      this.modals = true;\n      this.selectIds = this.goodsList.map((i) => {\n        return i.product_id;\n      });\n    },\n    // 生成直播商品\n    liveGoods() {\n      let array = [];\n      this.goodsList.map((el) => {\n        array.push(el.product_id);\n      });\n      liveGoodsCreat({\n        product_id: array,\n      })\n        .then((res) => {\n          this.tabList = res.data;\n          this.isShowBox = true;\n        })\n        .catch((error) => {\n          this.$Message.error(error.msg);\n        });\n    },\n    getProductId(data) {\n      this.goodsList = data;\n      this.$nextTick((res) => {\n        setTimeout(() => {\n          this.modals = false;\n        }, 300);\n      });\n    },\n    bindDelete(index, item) {\n      this.goodsList.splice(index, 1);\n      let i = this.tabList.findIndex((e) => e.id == item.product_id);\n      this.tabList.splice(i, 1);\n      if (!this.goodsList.length) {\n        this.isShowBox = false;\n      }\n    },\n    del(row, index) {\n      this.tabList.splice(index, 1);\n      let i = this.goodsList.findIndex((e) => e.product_id == row.id);\n      this.goodsList.splice(i, 1);\n      if (!this.tabList.length) {\n        this.isShowBox = false;\n      }\n    },\n    // 提交\n    bindSub() {\n      this.disabled = true;\n      this.loadings = true;\n      liveGoodsAdd({\n        goods_info: this.tabList,\n      })\n        .then((res) => {\n          this.$Message.success('添加成功');\n          this.disabled = false;\n          setTimeout(() => {\n            this.$router.push({ path: this.$routeProStr + '/marketing/live/live_goods' });\n          }, 500);\n        })\n        .catch((error) => {\n          this.disabled = false;\n          this.$Message.error(error.msg);\n        });\n    },\n  },\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.upload-box {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 60px;\n  height: 60px;\n  background: #ccc;\n}\n\n.box {\n  display: flex;\n  flex-wrap: wrap;\n\n  .box-item {\n    position: relative;\n    margin-right: 20px;\n\n    .ivu-icon {\n      position: absolute;\n      right: -10px;\n      top: -8px;\n      color: #999;\n      cursor: pointer;\n    }\n  }\n\n  .upload-box, .box-item {\n    width: 60px;\n    height: 60px;\n    margin-bottom: 10px;\n\n    img {\n      width: 100%;\n      height: 100%;\n    }\n  }\n}\n\n.active-btn {\n  padding-left: 96px;\n}\n\n.table-box {\n  margin: 0 107px;\n}\n\n.sub_btn {\n  margin-top: 10px;\n}\n\n.product_box {\n  display: flex;\n\n  img {\n    width: 36px;\n    height: 36px;\n    margin-right: 10px;\n  }\n}\n</style>\n"]}]}